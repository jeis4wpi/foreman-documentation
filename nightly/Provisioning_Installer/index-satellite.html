<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<title>Provisioning hosts by using Anaconda</title>
<style>
﻿*,::before,::after{box-sizing:border-box}html{font-size:100%;-webkit-text-size-adjust:100%}body{background:#fff;color:rgba(0,0,0,0.8);padding:0;margin:0;font-family:"Noto Serif", "DejaVu Serif", serif;font-size:inherit;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,p,blockquote,th,td{margin:0;padding:0}a{background:none;color:#2156a5;text-decoration:underline;line-height:inherit}a:active,a:hover{cursor:pointer;outline:0}a:focus{outline:thin dotted}a:hover,a:focus{color:#1d4b8f}abbr{font-size:0.9em}abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}b,strong{font-weight:bold;line-height:inherit}strong strong{font-weight:400}code,kbd,pre{font-family:"Droid Sans Mono", "DejaVu Sans Mono", monospace;font-size:1em}code{font-weight:400;color:rgba(0,0,0,0.9)}pre{color:rgba(0,0,0,0.9);line-height:1.45;text-rendering:optimizeSpeed;white-space:pre-wrap}dfn{font-style:italic}em,i{font-style:italic;line-height:inherit}em em{font-style:normal}hr{border:solid #dddddf;border-width:1px 0 0;clear:both;height:0;margin:1.25em 0 1.1875em}mark{background:#ff0;color:#000}p{line-height:1.6;margin-bottom:1.25rem;text-rendering:optimizeLegibility}q{quotes:"“" "”" "‘" "’"}small{font-size:60%;line-height:inherit}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-0.5em}sub{bottom:-0.25em}img,object[type^="image/"],svg{display:inline-block;height:auto;max-width:100%;vertical-align:middle}img{border:0;-ms-interpolation-mode:bicubic}object{max-width:100%}svg:not(:root){overflow:hidden}figure{margin:0}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}.left{float:left !important}.right{float:right !important}.text-left{text-align:left !important}.text-right{text-align:right !important}.text-center{text-align:center !important}.text-justify{text-align:justify !important}.hide{display:none}.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:0.25em}p aside{font-size:.875em;line-height:1.35;font-style:italic}h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans", "DejaVu Sans", sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.2;word-spacing:-0.05em}h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{color:#e99b8f;line-height:0}h1{font-size:2.125em}h2{font-size:1.6875em}h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}h4,h5{font-size:1.125em}h6{font-size:1em}ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}ul,ol{margin-left:1.5em}ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}ul.square{list-style-type:square}ul.circle{list-style-type:circle}ul.disc{list-style-type:disc}ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}dl dt{margin-bottom:.3125em;font-weight:bold}dl dd{margin-bottom:1.25em;margin-left:1.125em}blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,0.85)}@media screen and (min-width: 768px){h1{font-size:2.75em}h2{font-size:2.3125em}h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}h4{font-size:1.4375em}}table{background:#fff;border:1px solid #dedede;border-collapse:collapse;border-spacing:0;margin-bottom:1.25em;word-wrap:normal}table thead,table tfoot{background:#f7f8f7}table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,0.8);text-align:left}table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,0.8)}table tr.even,table tr.alt{background:#f8f8f7}table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}.center{margin-left:auto;margin-right:auto}.stretch{width:100%}.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:"";display:table}.clearfix::after,.float-group::after{clear:both}:not(pre).nobreak{word-wrap:normal}:not(pre).nowrap{white-space:nowrap}:not(pre).pre-wrap{white-space:pre-wrap}:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal !important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}pre>code{display:block}pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}.keyseq{color:rgba(51,51,51,0.8)}kbd{display:inline-block;color:rgba(0,0,0,0.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,0.2),inset 0 0 0 0.1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}.keyseq kbd:first-child{margin-left:0}.keyseq kbd:last-child{margin-right:0}.menuseq,.menuref{color:#000}.menuseq b:not(.caret),.menuref{font-weight:inherit}.menuseq{word-spacing:-0.02em}.menuseq b.caret{font-size:1.25em;line-height:0.8}.menuseq i.caret{font-weight:bold;text-align:center;width:0.45em}b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}b.button::before{content:"[";padding:0 3px 0 2px}b.button::after{content:"]";padding:0 2px 0 3px}p a>code:hover{color:rgba(0,0,0,0.9)}body>div[id]{margin:0 auto;max-width:62.5em;position:relative;padding-left:.9375em;padding-right:0.9375em}body>div[id]::before,body>div[id]::after,#content #footnotes::before{content:"";display:table;clear:both}#content{margin-top:1.25em;margin-bottom:0.625em}#content::before{content:none}#header>h1:first-child{color:rgba(0,0,0,0.85);margin-top:2.25rem;margin-bottom:0}#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,0.6);display:flex;flex-flow:row wrap}#header .details span:first-child{margin-left:-0.125em}#header .details span.email a{color:rgba(0,0,0,0.85)}#header .details br{display:none}#header .details br+span::before{content:" – "}#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,0.85)}#header .details br+span#revremark::before{content:" | "}#header #revnumber{text-transform:capitalize}#header #revnumber::after{content:" "}#content>h1:first-child:not([class]){color:rgba(0,0,0,0.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}#toc{border-bottom:1px solid #e7e7e9;padding-bottom:0.5em}#toc>ul{margin-left:0.125em}#toc ul.sectlevel0>li>a{font-style:italic}#toc ul.sectlevel0 ul.sectlevel1{margin:0.5em 0}#toc ul{font-family:"Open Sans", "DejaVu Sans", sans-serif;list-style-type:none}#toc li{line-height:1.3334;margin-top:0.3334em}#toc a{text-decoration:none}#toc a:active{text-decoration:underline}#toctitle{color:#7a2518;font-size:1.2em}@media screen and (min-width: 768px){#toctitle{font-size:1.375em}body.toc2{padding-left:15em;padding-right:0}#toc.toc2{margin-top:0 !important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0 !important;border-bottom-width:0 !important;z-index:1000;padding:1.25em 1em;height:calc(100% - (70px + 2.5em));overflow:auto}#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}#toc.toc2>ul{font-size:.9em;margin-bottom:0}#toc.toc2 ul ul{margin-left:0;padding-left:1em}#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:0.5em}body.toc2.toc-right{padding-left:0;padding-right:15em}body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}@media screen and (min-width: 1280px){body.toc2{padding-left:20em;padding-right:0}#toc.toc2{width:20em}#toc.toc2 #toctitle{font-size:1.375em}#toc.toc2>ul{font-size:0.95em}#toc.toc2 ul ul{padding-left:1.25em}body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}#content #toc>:first-child{margin-top:0}#content #toc>:last-child{margin-bottom:0}#footer{max-width:none;background:#025d8c;padding:1.25em;margin-left:2em}#footer-text{color:rgba(255,255,255,0.8);line-height:1.44}h1:before,h2:before,h3:before,h4:before,h5:before,h6:before,div.title:before{display:block;content:" ";height:90px;margin-top:-90px;visibility:hidden}.sect1{padding-bottom:0.625em}@media screen and (min-width: 768px){#content{margin-bottom:1.25em}.sect1{padding-bottom:1.25em}}.sect1:last-child{padding-bottom:0}.sect1+.sect1{border-top:1px solid #e7e7e9}#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none !important;visibility:hidden;text-align:center;font-weight:400}#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:0.1em}#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}details{margin-left:1.25rem}details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}details>summary::-webkit-details-marker{display:none}details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif", "DejaVu Serif", serif;font-size:1rem;font-style:italic}table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,0.85)}.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}.admonitionblock>table td.icon{text-align:center;width:80px}.admonitionblock>table td.icon img{max-width:none}.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans", "DejaVu Sans", sans-serif;text-transform:uppercase}.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,0.6);word-wrap:anywhere}.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}.exampleblock>.content{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#fffef7;border-radius:4px;box-shadow:0 1px 4px #e0e0dc}.exampleblock>.content>:first-child{margin-top:0}.exampleblock>.content>:last-child{margin-bottom:0}.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}.sidebarblock>:first-child{margin-top:0}.sidebarblock>:last-child{margin-bottom:0}.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:0.8125em}@media screen and (min-width: 768px){.literalblock pre,.listingblock>.content>pre{font-size:0.90625em}}@media screen and (min-width: 1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,0.9)}.listingblock>.content{position:relative}.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:0.5}.listingblock:hover code[data-lang]::before{display:block}.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:0.5}.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}.listingblock pre.highlightjs{padding:0}.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}.listingblock pre.prettyprint{border-width:0}.prettyprint{background:#f7f7f8}pre.prettyprint .linenums{line-height:1.45;margin-left:2em}pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}pre.prettyprint li code[data-lang]::before{opacity:1}pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}table.linenotable td.code{padding-left:0.75em}table.linenotable td.linenos{width:0.01%}table.linenotable td.linenos,pre.pygments .linenos,pre.rouge .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}pre.pygments span.linenos,pre.rouge span.linenos{display:inline-block;margin-right:0.75em}.quoteblock{margin:0 1em 1.25em 1.5em;display:table}.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:0.75em}.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,0.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}.quoteblock blockquote{margin:0;padding:0;border:0}.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,0.1)}.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}.verseblock{margin:0 1em 1.25em}.verseblock pre{font-family:"Open Sans", "DejaVu Sans", sans-serif;font-size:1.15rem;color:rgba(0,0,0,0.85);font-weight:300;text-rendering:optimizeLegibility}.verseblock pre strong{font-weight:400}.verseblock .attribution{margin-top:1.25rem;margin-left:0.5ex}.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}.quoteblock .attribution br,.verseblock .attribution br{display:none}.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,0.6)}.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}.quoteblock.abstract{margin:0 1em 1.25em;display:block}.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:0.25em solid #dddddf}.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}p.tableblock:last-child{margin-bottom:0}td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}td.tableblock>.content>:last-child{margin-bottom:-1.25em}table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}table.grid-all>*>tr>*{border-width:1px}table.grid-cols>*>tr>*{border-width:0 1px}table.grid-rows>*>tr>*{border-width:1px 0}table.frame-all{border-width:1px}table.frame-ends{border-width:1px 0}table.frame-sides{border-width:0 1px}table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}th.halign-left,td.halign-left{text-align:left}th.halign-right,td.halign-right{text-align:right}th.halign-center,td.halign-center{text-align:center}th.valign-top,td.valign-top{vertical-align:top}th.valign-bottom,td.valign-bottom{vertical-align:bottom}th.valign-middle,td.valign-middle{vertical-align:middle}table thead th,table tfoot th{font-weight:bold}tbody tr th{background:#f7f8f7}tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,0.8);font-weight:bold}p.tableblock>code:only-child{background:none;padding:0}p.tableblock{font-size:1em}ol{margin-left:1.75em}ul li ol{margin-left:1.5em}dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:0.625em}ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:0.625em}ul.unstyled,ol.unstyled{margin-left:0}li>p:empty:only-child::before{content:"";display:inline-block}ul.checklist>li>p:first-child{margin-left:-1em}ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:0.125em}ul.checklist>li>p:first-child>input[type=checkbox]:first-child{font:inherit;margin:0 .25em 0 0;padding:0}ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 0.625em -1.25em}ul.inline>li{margin-left:1.25em}.unstyled dl dt{font-weight:400;font-style:normal}ol.arabic{list-style-type:decimal}ol.decimal{list-style-type:decimal-leading-zero}ol.loweralpha{list-style-type:lower-alpha}ol.upperalpha{list-style-type:upper-alpha}ol.lowerroman{list-style-type:lower-roman}ol.upperroman{list-style-type:upper-roman}ol.lowergreek{list-style-type:lower-greek}.hdlist>table,.colist>table{border:0;background:none}.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}td.hdlist1,td.hdlist2{vertical-align:top;padding:0 0.625em}td.hdlist1{font-weight:bold;padding-bottom:1.25em}td.hdlist2{word-wrap:anywhere}.literalblock+.colist,.listingblock+.colist{margin-top:-0.5em}.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}.colist td:not([class]):first-child img{max-width:none}.colist td:not([class]):last-child{padding:0.25em 0}.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}.imageblock.left{margin:0.25em 0.625em 1.25em 0}.imageblock.right{margin:0.25em 0 1.25em 0.625em}.imageblock>.title{margin-bottom:0}.imageblock.thumb,.imageblock.th{border-width:6px}.imageblock.thumb>.title,.imageblock.th>.title{padding:0 0.125em}.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}.image.left{margin-right:0.625em}.image.right{margin-left:0.625em}a.image{text-decoration:none;display:inline-block}a.image object{pointer-events:none}sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}sup.footnote a,sup.footnoteref a{text-decoration:none}sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:0.625em}#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:0.2em}#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}#footnotes .footnote:last-of-type{margin-bottom:0}#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:0.75em 0}div.page-break{display:none}div.unbreakable{page-break-inside:avoid}.big{font-size:larger}.small{font-size:smaller}.underline{text-decoration:underline}.overline{text-decoration:overline}.line-through{text-decoration:line-through}.aqua{color:#00bfbf}.aqua-background{background:#00fafa}.black{color:#000}.black-background{background:#000}.blue{color:#0000bf}.blue-background{background:#0000fa}.fuchsia{color:#bf00bf}.fuchsia-background{background:#fa00fa}.gray{color:#606060}.gray-background{background:#7d7d7d}.green{color:#006000}.green-background{background:#007d00}.lime{color:#00bf00}.lime-background{background:#00fa00}.maroon{color:#600000}.maroon-background{background:#7d0000}.navy{color:#000060}.navy-background{background:#00007d}.olive{color:#606000}.olive-background{background:#7d7d00}.purple{color:#600060}.purple-background{background:#7d007d}.red{color:#bf0000}.red-background{background:#fa0000}.silver{color:#909090}.silver-background{background:#bcbcbc}.teal{color:#006060}.teal-background{background:#007d7d}.white{color:#bfbfbf}.white-background{background:#fafafa}.yellow{color:#bfbf00}.yellow-background{background:#fafa00}span.icon>.fa{cursor:default}a span.icon>.fa{cursor:inherit}.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,0.5);cursor:default}.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,0.8);color:#111}.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}.conum[data-value]{display:inline-block;color:#fff !important;background:rgba(0,0,0,0.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans", "DejaVu Sans", sans-serif;font-style:normal;font-weight:bold}.conum[data-value] *{color:#fff !important}.conum[data-value]+b{display:none}.conum[data-value]::after{content:attr(data-value)}pre .conum[data-value]{position:relative;top:-0.125em}b.conum *{color:inherit !important}.conum:not([data-value]):empty{display:none}dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}h1,h2,p,td.content,span.alt,summary{letter-spacing:-0.01em}p strong,td.content strong,div.footnote strong{letter-spacing:-0.005em}p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}.print-only{display:none !important}@page{margin:1.25cm 0.75cm}@media print{*{box-shadow:none !important;text-shadow:none !important}html{font-size:80%}a{color:inherit !important;text-decoration:underline !important}a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none !important}a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:0.25em}abbr[title]{border-bottom:1px dotted}abbr[title]::after{content:" (" attr(title) ")"}pre,blockquote,tr,img,object,svg{page-break-inside:avoid}thead{display:table-header-group}p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}body>div[id]{max-width:none}#toc,.sidebarblock,.exampleblock>.content{background:none !important}#toc{border-bottom:1px solid #dddddf !important;padding-bottom:0 !important}body.book #header{text-align:center}body.book #header>h1:first-child{border:0 !important;margin:2.5em 0 1em}body.book #header .details{border:0 !important;display:block;padding:0 !important}body.book #header .details span:first-child{margin-left:0 !important}body.book #header .details br{display:block}body.book #header .details br+span::before{content:none !important}body.book #toc{border:0 !important;text-align:left !important;padding:0 !important;margin:0 !important}body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}.listingblock code[data-lang]::before{display:block}div.page-break{display:block;page-break-after:always}#footer{padding:0 0.9375em}.hide-on-print{display:none !important}.print-only{display:block !important}.hide-for-print{display:none !important}.show-for-print{display:inherit !important}}@media amzn-kf8, print{#header>h1:first-child{margin-top:1.25rem}.sect1{padding:0 !important}.sect1+.sect1{border:0}#footer{background:none}#footer-text{color:rgba(0,0,0,0.6);font-size:0.9em}}@media amzn-kf8{body>div[id]{padding:0}}body{padding:0;margin:0;margin-top:70px !important}.container{position:relative;z-index:1;padding-top:50px;min-height:100%}.container p{font-family:sans-serif;font-size:1.2em}nav{position:fixed;z-index:9999;left:0;right:0;top:0;height:70px;padding:0 1.5em;background-color:#025d8c;font-family:sans-serif;line-height:70px}nav .logo{width:50px;vertical-align:middle}nav .nav-menu{position:absolute;right:0.3em;top:0;padding:0;margin:0;list-style:none}nav .nav-item{display:inline-block}nav .nav-item>a{display:inline-block;padding:0 2.5em;line-height:70px;color:#fff;text-decoration:none}nav .dropdown{position:relative}nav .dropdown a::after{content:"";display:inline-block;margin-left:0.5em;vertical-align:middle;border-top:0.3em solid #fff;border-right:0.3em solid transparent;border-left:0.3em solid transparent}nav .dropdown.show a::after{transform:rotate(180deg)}nav .dropdown-menu{display:none;position:absolute;left:0;right:0;top:100%;padding:0.5em 0;margin-top:-0.5em;border:1px solid rgba(0,0,0,0.3);border-radius:0.5em;background-color:#fff;width:max-content;max-height:80vh;overflow:scroll}nav .dropdown-menu-left{left:auto;right:0}nav .dropdown.show .dropdown-menu{display:block}nav .dropdown-div{display:block;padding:0.4em 0;line-height:4em}nav .dropdown-div a::after{content:none;margin-left:0;border-top:0;border-right:0;border-left:0}nav .dropdown-item{display:block;padding:0 1.5em;font-size:0.875em;color:#000;line-height:1.6em;text-decoration:none}nav .btn-hamburger{display:none;position:absolute;right:1.5em;top:50%;background-color:transparent;border:0;cursor:pointer;outline:none;transform:translateY(-50%)}nav .btn-hamburger span{display:block;width:30px;height:4px;background-color:#fff;margin:6px;border-radius:2px;transition:0.3s ease-in-out}nav .btn-hamburger span:nth-child(4),nav .btn-hamburger span:nth-child(5){position:absolute;top:10px;opacity:0.5}nav .btn-hamburger span:nth-child(4){transform:rotate(45deg) scale(0)}nav .btn-hamburger span:nth-child(5){transform:rotate(-45deg) scale(0)}nav.opened .btn-hamburger span:nth-child(4){opacity:1;transform:rotate(45deg) scale(1)}nav.opened .btn-hamburger span:nth-child(5){opacity:1;transform:rotate(-45deg) scale(1)}nav.opened .btn-hamburger span:nth-child(1),nav.opened .btn-hamburger span:nth-child(2),nav.opened .btn-hamburger span:nth-child(3){opacity:0}@media screen and (max-width: 768px){nav .nav-menu{position:fixed;left:0;right:0;top:70px;bottom:100%;display:flex;flex-direction:column;justify-content:start;background-color:#363d4e;transition:bottom 0.5s ease-in-out;overflow:hidden}nav.opened .nav-menu{bottom:0}nav .nav-item>a{display:block}nav .dropdown-menu{position:relative;top:0;margin:0 1.5em}nav .btn-hamburger{display:block}}@media screen{div.narrow{max-width:1080px;margin:0 auto !important;margin-top:70px auto !important;float:none !important}#toc.toc2{margin-top:70px !important}}

</style>
<!-- Generate a nice TOC -->
<script src="/js/jquery-1.11.3.min.js"></script>
<script src="/js/jquery-ui.min.js"></script>
<script src="/js/jquery.tocify.min.js"></script>
<!-- We do not need the tocify CSS because the asciidoc CSS already provides most of what we neeed -->

<style>
.tocify-header {
    /* font-style: italic; */
}

.tocify-subheader {
    font-style: normal;
    font-size: 95%;
}

.tocify ul {
    margin: 0;
 }

.tocify-focus {
    /* background-color: rgba(0, 0, 0, 0.05);*/
}

.tocify-focus > a {
    color: #ba3925;
}
</style>

<script type="text/javascript">
    $(function () {
        // Add a new container for the tocify toc into the existing toc so we can re-use its
        // styling
        $("#toc").append("<div id='generated-toc'></div>");
        $("#generated-toc").tocify({
            extendPage: true,
            context: "#content",
            highlightOnScroll: true,
            hideEffect: "slideUp",
            // Use the IDs that asciidoc already provides so that TOC links and intra-document
            // links are the same. Anything else might confuse users when they create bookmarks.
            hashGenerator: function(text, element) {
                return $(element).attr("id");
            },
            // Smooth scrolling doesn't work properly if we use the asciidoc IDs
            smoothScroll: false,
            // Set to 'none' to use the tocify classes
            theme: "none",
            // Handle book (may contain h1) and article (only h2 deeper)
            selectors: $( "#content" ).has( "h1" ).size() > 0 ? "h1,h2,h3,h4,h5" : "h2,h3,h4,h5",
            ignoreSelector: ".discrete"
        });

        // Switch between static asciidoc toc and dynamic tocify toc based on browser size
        // This is set to match the media selectors in the asciidoc CSS
        // Without this, we keep the dynamic toc even if it is moved from the side to preamble
        // position which will cause odd scrolling behavior
        var handleTocOnResize = function() {
            if ($(document).width() < 768) {
                $("#generated-toc").hide();
                $(".sectlevel0").show();
                $(".sectlevel1").show();
            }
            else {
                $("#generated-toc").show();
                $(".sectlevel0").hide();
                $(".sectlevel1").hide();
            }
        }

        $(window).resize(handleTocOnResize);
        handleTocOnResize();
    });
</script>
<style>
/*! Asciidoctor Tabs | Copyright (c) 2018-present Dan Allen | MIT License */
.tabs {
  margin-bottom: 1.25em;
}

.tablist > ul {
  display: flex;
  flex-wrap: wrap;
  list-style: none;
  margin: 0;
  padding: 0;
}

.tablist > ul li {
  align-items: center;
  background-color: #fff;
  cursor: pointer;
  display: flex;
  font-weight: bold;
  line-height: 1.5;
  padding: 0.25em 1em;
  position: relative;
}

.tablist > ul li:focus-visible {
  outline: none;
}

.tablist.ulist,
.tablist.ulist > ul li {
  margin: 0;
}

.tablist.ulist > ul li + li {
  margin-left: 0.25em;
}

.tabs .tablist li::after {
  content: "";
  display: block;
  height: 1px;
  position: absolute;
  bottom: -1px;
  left: 0;
  right: 0;
}

.tabs.is-loading .tablist li:not(:first-child),
.tabs:not(.is-loading) .tablist li:not(.is-selected) {
  background-color: #f5f5f5;
}

.tabs.is-loading .tablist li:first-child::after,
.tabs:not(.is-loading) .tablist li.is-selected::after {
  background-color: #fff;
}

/*
.tabs:not(.is-loading) .tablist li,
.tabs:not(.is-loading) .tablist li::after {
  transition: background-color 200ms ease-in-out;
}
*/

.tablist > ul p {
  line-height: inherit;
  margin: 0;
}

.tabpanel {
  background-color: #fff;
  padding: 1.25em;
}

.tablist > ul li,
.tabpanel {
  border: 1px solid #dcdcdc;
}

.tablist > ul li {
  border-bottom: 0;
}

.tabs.is-loading .tabpanel + .tabpanel,
.tabs:not(.is-loading) .tabpanel.is-hidden {
  display: none;
}

.tabpanel > :first-child {
  margin-top: 0;
}

/* #content is a signature of the Asciidoctor standalone HTML output */
#content .tabpanel > :last-child,
#content .tabpanel > :last-child > :last-child,
#content .tabpanel > :last-child > :last-child > li:last-child > :last-child {
  margin-bottom: 0;
}

.tablecontainer {
  overflow-x: auto;
}

#content .tablecontainer {
  margin-bottom: 1.25em;
}

#content .tablecontainer > table.tableblock {
  margin-bottom: 0;
}
</style>
</head>
<body class="book toc2 toc-left">
    <div id="wrap">
      <script src="/js/versions.js"></script>
      <script src="/js/nav.js"></script>
      <script>
        document.open();
        document.write(buildNavigation());
        addNavbarListeners();
        document.close();
      </script>
    </div>
<div id="header">
<h1>Provisioning hosts by using Anaconda</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#providing-feedback-on-red-hat-documentation_provisioning-installer">Providing feedback on Red Hat documentation</a></li>
<li><a href="#Introduction_to_Provisioning_provisioning-installer">1. Introduction to provisioning</a>
<ul class="sectlevel2">
<li><a href="#Provisioning-Methods-in-Satellite_provisioning-installer">1.1. Provisioning methods in Red&#160;Hat Satellite</a></li>
<li><a href="#supported-host-platforms-in-provisioning">1.2. Supported host platforms in provisioning</a></li>
</ul>
</li>
<li><a href="#preparing-provisioning-content">2. Preparing provisioning content</a>
<ul class="sectlevel2">
<li><a href="#preparing-a-synchronized-kickstart-repository">2.1. Preparing a synchronized Kickstart repository</a></li>
<li><a href="#configuring-satellite-to-provision-from-a-builder-image">2.2. Configuring Satellite to provision from a Red&#160;Hat Image Builder image</a></li>
<li><a href="#adding-installation-media_provisioning-installer">2.3. Adding installation media to Satellite</a></li>
</ul>
</li>
<li><a href="#preparing-client-platforms">3. Preparing client platforms</a>
<ul class="sectlevel2">
<li><a href="#creating-operating-systems_provisioning-installer">3.1. Creating operating systems</a></li>
<li><a href="#updating-the-details-of-multiple-operating-systems_provisioning-installer">3.2. Updating the details of multiple operating systems</a></li>
<li><a href="#creating-architectures_provisioning-installer">3.3. Creating architectures</a></li>
<li><a href="#creating-hardware-models_provisioning-installer">3.4. Creating hardware models</a></li>
</ul>
</li>
<li><a href="#preparing-templates-for-provisioning">4. Preparing templates for provisioning</a>
<ul class="sectlevel2">
<li><a href="#provisioning-templates">4.1. Provisioning templates</a></li>
<li><a href="#kinds-of-provisioning-templates">4.2. Kinds of provisioning templates</a></li>
<li><a href="#creating-provisioning-templates">4.3. Creating provisioning templates</a></li>
<li><a href="#cloning-provisioning-templates">4.4. Cloning provisioning templates</a></li>
<li><a href="#Creating_Custom_Provisioning_Snippets_provisioning-installer">4.5. Creating custom provisioning snippets</a></li>
<li><a href="#Custom_Provisioning_Snippet_Example_for_Enterprise_Linux_provisioning-installer">4.6. Custom provisioning snippet example for Red&#160;Hat Enterprise Linux</a></li>
<li><a href="#Associating_Templates_with_Operating_Systems_provisioning-installer">4.7. Associating templates with operating systems</a></li>
<li><a href="#creating-partition-tables_provisioning-installer">4.8. Creating partition tables</a></li>
<li><a href="#associating-partition-tables-with-disk-encryption_provisioning-installer">4.9. Associating partition tables with disk encryption</a></li>
<li><a href="#dynamic-partition-example_provisioning-installer">4.10. Dynamic partition example</a></li>
</ul>
</li>
<li><a href="#preparing-networking">5. Preparing networking</a>
<ul class="sectlevel2">
<li><a href="#facts-and-nic-filtering_provisioning-installer">5.1. Facts and NIC filtering</a></li>
<li><a href="#optimizing-performance-by-removing-nics-from-database_provisioning-installer">5.2. Optimizing performance by removing NICs from database</a></li>
<li><a href="#Network_Resources_provisioning-installer">5.3. Network resources</a></li>
<li><a href="#satellite-and-dhcp-configuration">5.4. Satellite and DHCP configuration</a>
<ul class="sectlevel3">
<li><a href="#options-in-managed-dhcpv4">5.4.1. Options in managed DHCPv4</a></li>
<li><a href="#options-in-unmanaged-dhcpv6">5.4.2. Options in unmanaged DHCPv6</a></li>
</ul>
</li>
<li><a href="#Troubleshooting_DHCP_Problems_provisioning-installer">5.5. Troubleshooting DHCP problems in Satellite</a></li>
<li><a href="#Configuring_Network_Services_provisioning-installer">5.6. Configuring network services</a>
<ul class="sectlevel3">
<li><a href="#Multiple_Subnets_or_Domains_Using_Installer_provisioning-installer">5.6.1. Multiple subnets or domains using installer</a></li>
<li><a href="#DHCP_Options_For_Network_Configuration_provisioning-installer">5.6.2. DHCP options for network configuration</a></li>
<li><a href="#DNS_Options_For_Network_Configuration_provisioning-installer">5.6.3. DNS options for network configuration</a></li>
<li><a href="#TFTP_Options_For_Network_Configuration_provisioning-installer">5.6.4. TFTP options for network configuration</a></li>
<li><a href="#Using_TFTP_Services_Through_NAT_provisioning-installer">5.6.5. Using TFTP services through NAT</a></li>
</ul>
</li>
<li><a href="#Adding_a_Domain_to_Server_provisioning-installer">5.7. Adding a domain to Satellite&#160;Server</a></li>
<li><a href="#Adding_a_Subnet_to_Server_provisioning-installer">5.8. Adding a subnet to Satellite&#160;Server</a></li>
</ul>
</li>
<li><a href="#security-settings">6. Security settings</a>
<ul class="sectlevel2">
<li><a href="#configuring-the-security-token-validity-duration">6.1. Configuring the security token validity duration</a></li>
<li><a href="#setting-a-default-encrypted-root-password_provisioning-installer">6.2. Setting a default encrypted root password for hosts</a></li>
<li><a href="#Provisioning_FIPS_Compliant_Hosts_provisioning-installer">6.3. Provisioning FIPS-compliant hosts</a>
<ul class="sectlevel3">
<li><a href="#Changing_the_Provisioning_Password_Hashing_Algorithm_provisioning-installer">6.3.1. Changing the provisioning password hashing algorithm</a></li>
<li><a href="#Setting_the_FIPS_Enabled_Parameter_provisioning-installer">6.3.2. Setting the FIPS-enabled parameter</a></li>
<li><a href="#Verifying_FIPS_Mode_Is_Enabled_provisioning-installer">6.3.3. Verifying FIPS mode is enabled</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#provisioning-contexts_provisioning-installer">7. Provisioning contexts</a>
<ul class="sectlevel2">
<li><a href="#setting-the-provisioning-context_provisioning-installer">7.1. Setting the provisioning context</a></li>
</ul>
</li>
<li><a href="#using-network-boot-to-provision-hosts">8. Using network boot to provision hosts</a>
<ul class="sectlevel2">
<li><a href="#Network_Boot_Provisioning_Workflow_using-netboot">8.1. Network boot provisioning workflow</a></li>
<li><a href="#prerequisites-for-network-boot-provisioning">8.2. Prerequisites for network-boot provisioning</a></li>
<li><a href="#required-boot-order-for-network-boot_using-netboot">8.3. Required boot order for network boot</a></li>
<li><a href="#configuring-capsule-for-secure-boot">8.4. Configuring Capsule for Secure Boot</a></li>
<li><a href="#configuring-capsule-to-provision-rhel-on-Secure-Boot-enabled-hosts">8.5. Configuring Capsule to provision Red&#160;Hat Enterprise Linux on Secure Boot enabled hosts</a></li>
<li><a href="#creating-hosts-with-pxe-boot-provisioning">8.6. Creating hosts with PXE boot provisioning</a></li>
<li><a href="#creating-hosts-with-uefi-http-boot-provisioning">8.7. Creating hosts with UEFI HTTP boot provisioning</a></li>
<li><a href="#Deploying_SSH_Keys_During_Provisioning_using-netboot">8.8. Deploying SSH keys during provisioning</a></li>
<li><a href="#using-ipxe-to-reduce-provisioning-times_using-netboot">8.9. Using iPXE to reduce provisioning times</a>
<ul class="sectlevel3">
<li><a href="#prerequisites-for-using-ipxe_using-netboot">8.9.1. Prerequisites for using iPXE</a></li>
<li><a href="#Configuring_iPXE_Environment_using-netboot">8.9.2. Configuring iPXE environment</a></li>
<li><a href="#Booting_Virtual_Machines_using-netboot">8.9.3. Booting virtual machines</a></li>
<li><a href="#Chainbooting_iPXE_from_PXELinux_using-netboot">8.9.4. Chainbooting iPXE from PXELinux</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#using-boot-disks-to-provision-hosts">9. Using boot disks to provision hosts</a>
<ul class="sectlevel2">
<li><a href="#Creating_Hosts_with_PXE_less_Provisioning_using-bootdisks">9.1. Creating hosts with PXE-less provisioning</a></li>
<li><a href="#Deploying_SSH_Keys_During_Provisioning_using-bootdisks">9.2. Deploying SSH keys during provisioning</a></li>
</ul>
</li>
<li><a href="#discovering-hosts-on-a-network">10. Discovering hosts on a network</a>
<ul class="sectlevel2">
<li><a href="#prerequisites-for-using-discovery_provisioning-installer">10.1. Prerequisites for using Discovery</a></li>
<li><a href="#Installing_the_Discovery_Service_provisioning-installer">10.2. Installing the Discovery service</a></li>
<li><a href="#discovery-in-pxe-mode">10.3. Discovery in PXE mode</a>
<ul class="sectlevel3">
<li><a href="#setting-discovery-as-the-default-PXE-boot-option_provisioning-installer">10.3.1. Setting Discovery as the default PXE boot option</a></li>
<li><a href="#performing-discovery-in-pxe-mode_provisioning-installer">10.3.2. Performing Discovery in PXE mode</a></li>
<li><a href="#Customizing_the_Discovery_PXE_Boot_provisioning-installer">10.3.3. Customizing the Discovery PXE boot</a></li>
<li><a href="#discovering-hosts-from-multiple-capsule-servers_provisioning-installer">10.3.4. Discovering hosts from multiple Capsule&#160;Servers</a></li>
</ul>
</li>
<li><a href="#discovery-in-pxeless-mode">10.4. Discovery in PXE-less mode</a>
<ul class="sectlevel3">
<li><a href="#performing-discovery-in-pxeless-mode_provisioning-installer">10.4.1. Performing Discovery in PXE-less mode</a></li>
<li><a href="#customizing-the-discovery-iso_provisioning-installer">10.4.2. Customizing the Discovery ISO</a></li>
</ul>
</li>
<li><a href="#Automatic_Contexts_for_Discovered_Hosts_provisioning-installer">10.5. Automatic contexts for discovered hosts</a></li>
<li><a href="#Creating_Hosts_from_Discovered_Hosts_provisioning-installer">10.6. Creating hosts from discovered hosts</a></li>
<li><a href="#Creating_Discovery_Rules_provisioning-installer">10.7. Creating Discovery rules</a></li>
<li><a href="#Extending_the_Discovery_Image_provisioning-installer">10.8. Extending the Discovery image</a></li>
<li><a href="#kernel-parameters-for-discovery-customization_provisioning-installer">10.9. Kernel parameters for Discovery customization</a></li>
<li><a href="#Troubleshooting_Discovery_provisioning-installer">10.10. Troubleshooting Discovery</a></li>
</ul>
</li>
<li><a href="#Host_Parameter_Hierarchy_provisioning-installer">Appendix A: Host parameter hierarchy</a></li>
<li><a href="#permissions-required-to-provision-hosts_provisioning-installer">Appendix B: Permissions required to provision hosts</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="providing-feedback-on-red-hat-documentation_provisioning-installer"><a class="anchor" href="#providing-feedback-on-red-hat-documentation_provisioning-installer"></a>Providing feedback on Red Hat documentation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We appreciate your feedback on our documentation.
Let us know how we can improve it.</p>
</div>
<div class="paragraph">
<p>Use the <strong>Create Issue</strong> form in Red Hat Jira to provide your feedback.
The Jira issue is created in the Red Hat Satellite Jira project, where you can track its progress.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Ensure you have registered a <a href="https://access.redhat.com/">Red Hat account</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Click the following link: <a href="https://issues.redhat.com/secure/CreateIssueDetails!init.jspa?pid=12324223&amp;summary=Documentation%20feedback:%20%3CAdd%20summary%20here%3E&amp;issuetype=1&amp;components=12347630&amp;priority=10300"><strong>Create Issue</strong></a>.
If Jira displays a login error, log in and proceed after you are redirected to the form.</p>
</li>
<li>
<p>Complete the <strong>Summary</strong> and <strong>Description</strong> fields.
In the <strong>Description</strong> field, include the documentation URL, chapter or section number, and a detailed description of the issue.
Do not modify any other fields in the form.</p>
</li>
<li>
<p>Click <strong>Create</strong>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Introduction_to_Provisioning_provisioning-installer"><a class="anchor" href="#Introduction_to_Provisioning_provisioning-installer"></a>1. Introduction to provisioning</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Provisioning is a process that starts with a bare physical or virtual machine and ends with a fully configured, ready-to-use operating system.
Using Red&#160;Hat Satellite, you can define and automate fine-grained provisioning for a large number of hosts.</p>
</div>
<div class="sect2">
<h3 id="Provisioning-Methods-in-Satellite_provisioning-installer"><a class="anchor" href="#Provisioning-Methods-in-Satellite_provisioning-installer"></a>1.1. Provisioning methods in Red&#160;Hat Satellite</h3>
<div class="paragraph">
<p>With Red&#160;Hat Satellite, you can provision hosts by using the following methods.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Bare-metal hosts</dt>
<dd>
<p>Satellite provisions bare-metal hosts primarily by using PXE boot and MAC address identification.
When provisioning bare-metal hosts with Satellite, you can do the following:</p>
<div class="ulist">
<ul>
<li>
<p>Create host entries and specify the MAC address of the physical host to provision.</p>
</li>
<li>
<p>Boot blank hosts to use the Satellite Discovery service, which creates a pool of hosts that are ready for provisioning.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Cloud providers</dt>
<dd>
<p>Satellite connects to private and public cloud providers to provision instances of hosts from images stored in the cloud environment.
When provisioning from cloud with Satellite, you can do the following:</p>
<div class="ulist">
<ul>
<li>
<p>Select which hardware profile to use.</p>
</li>
<li>
<p>Provision cloud instances from specific providers by using their APIs.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Virtualization infrastructure</dt>
<dd>
<p>Satellite connects to virtualization infrastructure services, such as Red&#160;Hat&#160;Virtualization and VMware.
When provisioning virtual machines with Satellite, you can do the following:</p>
<div class="ulist">
<ul>
<li>
<p>Provision virtual machines from virtual image templates.</p>
</li>
<li>
<p>Use the same PXE-based boot methods that you use to provision bare-metal hosts.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="supported-host-platforms-in-provisioning"><a class="anchor" href="#supported-host-platforms-in-provisioning"></a>1.2. Supported host platforms in provisioning</h3>
<div class="paragraph">
<p>Satellite supports the following operating systems and architectures for host provisioning.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Supported host operating systems</dt>
<dd>
<p>The hosts can use the following operating systems:</p>
<div class="ulist">
<ul>
<li>
<p>Red&#160;Hat Enterprise Linux 9 and 8</p>
</li>
<li>
<p>Red&#160;Hat Enterprise Linux 7 and 6 with the <a href="https://www.redhat.com/en/resources/els-datasheet">ELS Add-On</a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Supported host architectures</dt>
<dd>
<p>The hosts can use the following architectures:</p>
<div class="ulist">
<ul>
<li>
<p>AMD and Intel 64-bit architectures</p>
</li>
<li>
<p>The 64-bit ARM architecture</p>
</li>
<li>
<p>IBM Power Systems, Little Endian</p>
</li>
<li>
<p>64-bit IBM Z architectures</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="preparing-provisioning-content"><a class="anchor" href="#preparing-provisioning-content"></a>2. Preparing provisioning content</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You have to configure provisioning content that will be used for installation of the operating system on the provisioned host.</p>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/managing_content/index#"><em>Managing content</em></a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="preparing-a-synchronized-kickstart-repository"><a class="anchor" href="#preparing-a-synchronized-kickstart-repository"></a>2.1. Preparing a synchronized Kickstart repository</h3>
<div class="paragraph">
<p>Satellite contains a set of synchronized Kickstart repositories that you use to install the provisioned host&#8217;s operating system.
For more information about adding repositories, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/managing_content/index#Synchronizing_Repositories_content-management">Syncing Repositories</a> in <em>Managing content</em>.</p>
</div>
<div class="paragraph">
<p>Use this procedure to set up a Kickstart repository.</p>
</div>
<div class="paragraph">
<div class="title">Prerequisites</div>
<p>You must enable both <strong>BaseOS</strong> and <strong>Appstream Kickstart</strong> before provisioning.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add the synchronized Kickstart repository that you want to use to the existing content view, or create a new content view and add the Kickstart repository.</p>
<div class="paragraph">
<p>For Red&#160;Hat Enterprise Linux 8, ensure that you add both <strong>Red&#160;Hat Enterprise Linux 8 for x86_64 - AppStream Kickstart x86_64 8</strong> and <strong>Red&#160;Hat Enterprise Linux 8 for x86_64 - BaseOS Kickstart x86_64 8</strong> repositories.</p>
</div>
<div class="paragraph">
<p>If you use a disconnected environment, you must import the Kickstart repositories from a Red&#160;Hat Enterprise Linux binary DVD.
For more information, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/managing_content/index#Importing_Kickstart_Repositories_content-management">Importing Kickstart Repositories</a> in <em>Managing content</em>.</p>
</div>
</li>
<li>
<p>Publish a new version of the content view where the Kickstart repository is added and promote it to a required lifecycle environment.
For more information, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/managing_content/index#Managing_Content_Views_content-management">Managing content views</a> in <em>Managing content</em>.</p>
</li>
<li>
<p>When you create a host, in the <strong>Operating System</strong> tab, for <strong>Media Selection</strong>, select the <strong>Synced Content</strong> checkbox.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To view the Kickstart tree, enter the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ hammer medium list --organization "<em>My_Organization</em>"</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configuring-satellite-to-provision-from-a-builder-image"><a class="anchor" href="#configuring-satellite-to-provision-from-a-builder-image"></a>2.2. Configuring Satellite to provision from a Red&#160;Hat Image Builder image</h3>
<div class="paragraph">
<p>In Satellite, you can enable integration with the RHEL web console to perform actions and monitor your hosts.
Using the RHEL web console, you can access Red&#160;Hat Image Builder and build images that you can then upload to an HTTP server and use this image to provision hosts.
When you configure Satellite for image provisioning, Anaconda installer partitions disks, downloads and mounts the image and copies files over to a host.
The preferred image type is TAR.</p>
</div>
<div class="paragraph">
<p>Ensure that your blueprint to build the TAR image includes a kernel package.</p>
</div>
<div class="paragraph">
<p>For more information about integrating the RHEL web console with Satellite, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/managing_hosts/index#Host_Management_and_Monitoring_Using_Cockpit_managing-hosts">Host management and monitoring using the RHEL web console</a> in <em>Managing hosts</em>.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>An existing TAR image created using Red&#160;Hat Image Builder.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On Satellite, create a custom product, add a custom file repository to this product, and upload the image to the repository.
For more information, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/managing_content/index#Importing_Individual_ISO_Images_and_Files_content-management">Importing Individual ISO Images and Files</a> in <em>Managing content</em>.</p>
</li>
<li>
<p>In the Satellite web UI, navigate to <strong>Configure</strong> &gt; <strong>Host Groups</strong>, and select the host group that you want to use.</p>
</li>
<li>
<p>Click the <strong>Parameters</strong> tab, and then click <strong>Add Parameter</strong>.</p>
</li>
<li>
<p>In the <strong>Name</strong> field, enter <code>kickstart_liveimg</code>.</p>
</li>
<li>
<p>From the <strong>Type</strong> list, select <strong>string</strong>.</p>
</li>
<li>
<p>In the <strong>Value</strong> field, enter the absolute path or a relative path in the following format <code>custom/<em>product</em>/<em>repository</em>/<em>image_name</em></code> that points to the exact location where you store the image.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save your changes.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can use this image for network-boot provisioning.
For more information, see <a href="#using-network-boot-to-provision-hosts">Using network boot to provision hosts</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="adding-installation-media_provisioning-installer"><a class="anchor" href="#adding-installation-media_provisioning-installer"></a>2.3. Adding installation media to Satellite</h3>
<div class="paragraph">
<p>Installation media are sources of packages that Satellite&#160;Server uses to install a base operating system on a machine from an external repository.
You can use this parameter to install third-party content.
Red Hat content is delivered through repository syncing instead.</p>
</div>
<div class="paragraph">
<p>You can view installation media by navigating to <strong>Hosts</strong> &gt; <strong>Provisioning Setup</strong> &gt; <strong>Installation Media</strong>.</p>
</div>
<div class="paragraph">
<p>Installation media must be in the format of an operating system installation tree and must be accessible from the machine hosting the installer through an HTTP URL.</p>
</div>
<div class="paragraph">
<p>By default, Satellite includes installation media for some official Linux distributions.
Note that some of those installation media are targeted for a specific version of an operating system.
For example <strong>CentOS mirror (7.x)</strong> must be used for CentOS 7 or earlier, and <strong>CentOS mirror (8.x)</strong> must be used for CentOS 8 or later.</p>
</div>
<div class="paragraph">
<p>If you want to improve download performance when using installation media to install operating systems on multiple hosts, you must modify the <strong>Path</strong> of the installation medium to point to the closest mirror or a local copy.</p>
</div>
<div class="paragraph">
<p>To use the CLI instead of the Satellite web UI, see the <a href="#cli-adding-installation-media_provisioning-installer">CLI procedure</a>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Provisioning Setup</strong> &gt; <strong>Installation Media</strong>.</p>
</li>
<li>
<p>Click <strong>Create Medium</strong>.</p>
</li>
<li>
<p>In the <strong>Name</strong> field, enter a name to represent the installation media entry.</p>
</li>
<li>
<p>In the <strong>Path</strong> enter the URL that contains the installation tree.
You can use following variables in the path to represent multiple different system architectures and versions:</p>
<div class="ulist">
<ul>
<li>
<p><code>$arch</code> &#8211; The system architecture.</p>
</li>
<li>
<p><code>$version</code> &#8211; The operating system version.</p>
</li>
<li>
<p><code>$major</code> &#8211; The operating system major version.</p>
</li>
<li>
<p><code>$minor</code> &#8211; The operating system minor version.</p>
<div class="paragraph">
<p>Example HTTP path:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">http://download.example.com/centos/$version/Server/$arch/os/</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>From the <strong>Operating system family</strong> list, select the distribution or family of the installation medium.
For example, CentOS and Fedora are in the <code>Red Hat</code> family.</p>
</li>
<li>
<p>Click the <strong>Organizations</strong> and <strong>Locations</strong> tabs, to change the provisioning context.
Satellite&#160;Server adds the installation medium to the set provisioning context.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save your installation medium.</p>
</li>
</ol>
</div>
<div id="cli-adding-installation-media_provisioning-installer" class="ulist">
<div class="title">CLI procedure</div>
<ul>
<li>
<p>Create the installation medium using the <code>hammer medium create</code> command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer medium create \
--locations "<em>My_Location</em>" \
--name "<em>My_Operating_System</em>" \
--organizations "<em>My_Organization</em>" \
--os-family "Redhat" \
--path "http://download.example.com/centos/$version/Server/$arch/os/"</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="preparing-client-platforms"><a class="anchor" href="#preparing-client-platforms"></a>3. Preparing client platforms</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You have to configure the platforms that you will provision.
That entails creating a hardware model, CPU architecture, and operating system.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The records for Red&#160;Hat supported platforms are created automatically when you enable a Red&#160;Hat repository.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="creating-operating-systems_provisioning-installer"><a class="anchor" href="#creating-operating-systems_provisioning-installer"></a>3.1. Creating operating systems</h3>
<div class="paragraph">
<p>An operating system is a collection of resources that define how Satellite&#160;Server installs a base operating system on a host.
Operating system entries combine previously defined resources, such as installation media, partition tables, provisioning templates, and others.</p>
</div>
<div class="paragraph">
<p>Importing operating systems from Red Hat&#8217;s CDN creates new entries on the <strong>Hosts</strong> &gt; <strong>Provisioning Setup</strong> &gt; <strong>Operating Systems</strong> page.
To import operating systems from Red Hat&#8217;s CDN, enable the Red Hat repositories of the operating systems and synchronize the repositories to Satellite.
For more information, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/managing_content/index#Enabling_Red_Hat_Repositories_content-management">Enabling Red Hat Repositories</a> and <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/managing_content/index#">Synchronizing Repositories</a> in <em>Managing content</em>.</p>
</div>
<div class="paragraph">
<p>You can also add custom operating systems using the following procedure.
To use the CLI instead of the Satellite web UI, see the <a href="#cli-creating-operating-systems_provisioning-installer">CLI procedure</a>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Operating systems</strong> and click <strong>New Operating</strong> system.</p>
</li>
<li>
<p>In the <strong>Name</strong> field, enter a name to represent the operating system entry.</p>
</li>
<li>
<p>In the <strong>Major</strong> field, enter the number that corresponds to the major version of the operating system.</p>
</li>
<li>
<p>In the <strong>Minor</strong> field, enter the number that corresponds to the minor version of the operating system.</p>
</li>
<li>
<p>In the <strong>Description</strong> field, enter a description of the operating system.</p>
</li>
<li>
<p>From the <strong>Family</strong> list, select the operating system&#8217;s family.</p>
</li>
<li>
<p>From the <strong>Root Password Hash</strong> list, select the encoding method for the root password.</p>
</li>
<li>
<p>From the <strong>Architectures</strong> list, select the architectures that the operating system uses.</p>
</li>
<li>
<p>Click the <strong>Partition table</strong> tab and select the possible partition tables that apply to this operating system.</p>
</li>
<li>
<p>Optional: If you use non-Red&#160;Hat content, click the Installation Media tab and select the installation media that apply to this operating system.
For more information, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/provisioning_hosts/index#adding-installation-media_provisioning">Adding Installation Media to Satellite</a>.</p>
</li>
<li>
<p>Click the <strong>Templates</strong> tab and select a <strong>PXELinux template</strong>, a <strong>Provisioning template</strong>, and a <strong>Finish template</strong> for your operating system to use.
You can select other templates, for example an <strong>iPXE template</strong>, if you plan to use iPXE for provisioning.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save your provisioning template.</p>
</li>
</ol>
</div>
<div id="cli-creating-operating-systems_provisioning-installer" class="ulist">
<div class="title">CLI procedure</div>
<ul>
<li>
<p>Create the operating system using the <code>hammer os create</code> command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer os create \
--architectures "x86_64" \
--description "<em>My_Operating_System</em>" \
--family "Redhat" \
--major 8 \
--media "Red Hat" \
--minor 8 \
--name "Red&#160;Hat Enterprise Linux" \
--partition-tables "<em>My_Partition_Table</em>" \
--provisioning-templates "<em>My_Provisioning_Template</em>"</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="updating-the-details-of-multiple-operating-systems_provisioning-installer"><a class="anchor" href="#updating-the-details-of-multiple-operating-systems_provisioning-installer"></a>3.2. Updating the details of multiple operating systems</h3>
<div class="paragraph">
<p>Use this procedure to update the details of multiple operating systems.
This example shows you how to assign each operating system a partition table called <code>Kickstart default</code>, a configuration template called <code>Kickstart default PXELinux</code>, and a provisioning template called <code>Kickstart Default</code>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>On Satellite&#160;Server, run the following Bash script:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-bash" data-lang="bash">PARTID=$(hammer --csv partition-table list | grep "Kickstart default," | cut -d, -f1)
PXEID=$(hammer --csv template list --per-page=1000 | grep "Kickstart default PXELinux" | cut -d, -f1)
SATELLITE_ID=$(hammer --csv template list --per-page=1000 | grep "provision" | grep ",Kickstart default" | cut -d, -f1)

for i in $(hammer --no-headers --csv os list | awk -F, {'print $1'})
do
   hammer partition-table add-operatingsystem --id="${PARTID}" --operatingsystem-id="${i}"
   hammer template add-operatingsystem --id="${PXEID}" --operatingsystem-id="${i}"
   hammer os set-default-template --id="${i}" --config-template-id=${PXEID}
   hammer os add-config-template --id="${i}" --config-template-id=${SATELLITE_ID}
   hammer os set-default-template --id="${i}" --config-template-id=${SATELLITE_ID}
done</code></pre>
</div>
</div>
</li>
<li>
<p>Display information about the updated operating system to verify that the operating system is updated correctly:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer os info --id <em>1</em></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="creating-architectures_provisioning-installer"><a class="anchor" href="#creating-architectures_provisioning-installer"></a>3.3. Creating architectures</h3>
<div class="paragraph">
<p>An architecture in Satellite represents a logical grouping of hosts and operating systems.
Architectures are created by Satellite automatically when hosts check in with Puppet.
The x86_64 architecture is already preset in Satellite.</p>
</div>
<div class="paragraph">
<p>Use this procedure to create an architecture in Satellite.</p>
</div>
<div class="paragraph">
<div class="title">Supported architectures</div>
<p>Only Intel x86_64 architecture is supported for provisioning using PXE, Discovery, and boot disk.
For more information, see the Red Hat Knowledgebase solution <a href="https://access.redhat.com/solutions/2674001">Supported architectures and provisioning scenarios in Satellite 6</a>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Provisioning Setup</strong> &gt; <strong>Architectures</strong>.</p>
</li>
<li>
<p>Click <strong>Create Architecture</strong>.</p>
</li>
<li>
<p>In the <strong>Name</strong> field, enter a name for the architecture.</p>
</li>
<li>
<p>From the <strong>Operating Systems</strong> list, select an operating system.
If none are available, you can create and assign them under <strong>Hosts</strong> &gt; <strong>Provisioning Setup</strong> &gt; <strong>Operating Systems</strong>.</p>
</li>
<li>
<p>Click <strong>Submit</strong>.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">CLI procedure</div>
<ul>
<li>
<p>Enter the <code>hammer architecture create</code> command to create an architecture.
Specify its name and operating systems that include this architecture:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer architecture create \
--name "<em>My_Architecture</em>" \
--operatingsystems "<em>My_Operating_System</em>"</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="creating-hardware-models_provisioning-installer"><a class="anchor" href="#creating-hardware-models_provisioning-installer"></a>3.4. Creating hardware models</h3>
<div class="paragraph">
<p>Use this procedure to create a hardware model in Satellite so that you can specify which hardware model a host uses.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Provisioning Setup</strong> &gt; <strong>Hardware Models</strong>.</p>
</li>
<li>
<p>Click <strong>Create Model</strong>.</p>
</li>
<li>
<p>In the <strong>Name</strong> field, enter a name for the hardware model.</p>
</li>
<li>
<p>Optionally, in the <strong>Hardware Model</strong> and <strong>Vendor Class</strong> fields, you can enter corresponding information for your system.</p>
</li>
<li>
<p>In the <strong>Info</strong> field, enter a description of the hardware model.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save your hardware model.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">CLI procedure</div>
<ul>
<li>
<p>Create a hardware model using the <code>hammer model create</code> command.
The only required parameter is <code>--name</code>.
Optionally, enter the hardware model with the <code>--hardware-model</code> option, a vendor class with the <code>--vendor-class</code> option, and a description with the <code>--info</code> option:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer model create \
--hardware-model "<em>My_Hardware_Model</em>" \
--info "<em>My_Description</em>" \
--name "<em>My_Hardware_Model_Name</em>" \
--vendor-class "<em>My_Vendor_Class</em>"</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="preparing-templates-for-provisioning"><a class="anchor" href="#preparing-templates-for-provisioning"></a>4. Preparing templates for provisioning</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Satellite provides the following default template types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Provisioning templates</p>
</li>
<li>
<p>Partition tables</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can use the default templates or create custom templates.</p>
</div>
<div class="paragraph">
<p>Provisioning templates are implemented with parameters that you can configure as host parameters to affect the provisioning process.
You can also add custom steps to certain templates by creating custom <code>pre</code> or <code>post</code> snippets and thus customize the provisioning process further without editing the default templates.</p>
</div>
<div class="paragraph">
<p>Thanks to partition tables implemented as templates, you can create custom, even dynamic, partition tables.</p>
</div>
<div class="paragraph">
<p>When you do not edit the default templates, maintenance is easier and you get the benefit of updates to the templates from Red&#160;Hat.</p>
</div>
<div class="sect2">
<h3 id="provisioning-templates"><a class="anchor" href="#provisioning-templates"></a>4.1. Provisioning templates</h3>
<div class="paragraph">
<p>A provisioning template defines the way Satellite&#160;Server installs an operating system on a host.</p>
</div>
<div class="paragraph">
<p>Red&#160;Hat Satellite includes many template examples.
In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Provisioning Templates</strong> to view them.
You can create a template or clone a template and edit the clone.
For help with templates, navigate to <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Provisioning Templates</strong> &gt; <strong>Create Template</strong> &gt; <strong>Help</strong>.</p>
</div>
<div class="paragraph">
<p>Templates supported by Red&#160;Hat are indicated by a Red&#160;Hat icon.</p>
</div>
<div class="paragraph">
<p>To hide unsupported templates, in the Satellite web UI navigate to <strong>Administer &gt; Settings</strong>.
On the <strong>Provisioning</strong> tab, set the value of <strong>Show unsupported provisioning templates</strong> to <code>false</code> and click <strong>Submit</strong>.
You can also filter out the supported templates by making the following query "supported = true".</p>
</div>
<div class="paragraph">
<p>If you clone a supported template, the cloned template will be unsupported.</p>
</div>
<div class="paragraph">
<p>Templates accept the Embedded Ruby (ERB) syntax.
For more information, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/managing_hosts/index#Template_Writing_Reference_managing-hosts">Template Writing Reference</a> in <em>Managing hosts</em>.</p>
</div>
<div class="paragraph">
<p>You can download provisioning templates.
Before you can download the template, you must create a debug certificate.
For more information, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/administering_red_hat_satellite/index#Creating_an_Organization_Debug_Certificate_admin">Creating an Organization Debug Certificate</a> in <em>Administering Red&#160;Hat Satellite</em>.</p>
</div>
<div class="paragraph">
<p>You can synchronize templates between Satellite&#160;Server and a Git repository or a local directory.
For more information, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/managing_hosts/index#Synchronizing_Templates_Repositories_managing-hosts">Synchronizing Templates Repositories</a> in <em>Managing hosts</em>.</p>
</div>
<div class="paragraph">
<p>To view the history of changes applied to a template, navigate to <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Provisioning Templates</strong>, select one of the templates, and click <strong>History</strong>.
Click <strong>Revert</strong> to override the content with the previous version.
You can also revert to an earlier change.
Click <strong>Show Diff</strong> to see information about a specific change:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <strong>Template Diff</strong> tab displays changes in the body of a provisioning template.</p>
</li>
<li>
<p>The <strong>Details</strong> tab displays changes in the template description.</p>
</li>
<li>
<p>The <strong>History</strong> tab displays the user who made a change to the template and date of the change.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="kinds-of-provisioning-templates"><a class="anchor" href="#kinds-of-provisioning-templates"></a>4.2. Kinds of provisioning templates</h3>
<div class="paragraph">
<p>There are various kinds of provisioning templates:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Provision</dt>
<dd>
<p>The main template for the provisioning process.
For example, a Kickstart template.
For more information about Kickstart syntax and commands, see the following resources:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/automatically_installing_rhel/automated-installation-workflow_rhel-installer">Automated installation workflow</a> in <em>Automatically installing RHEL&#160;9</em></p>
</li>
<li>
<p><a href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/automatically_installing_rhel/automated-installation-workflow_rhel-installer">Automated installation workflow</a> in <em>Automatically installing RHEL&#160;8</em></p>
</li>
<li>
<p><a href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/7/html/installation_guide/sect-kickstart-syntax">Kickstart Syntax Reference</a> in the <em>Red&#160;Hat Enterprise Linux&#160;7 Installation Guide</em></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">PXELinux, PXEGrub, PXEGrub2</dt>
<dd>
<p>PXE-based templates that deploy to the template Capsule associated with a subnet to ensure that the host uses the installer with the correct kernel options.
For BIOS provisioning, select <strong>PXELinux</strong> template.
For UEFI provisioning, select <strong>PXEGrub2</strong>.</p>
</dd>
<dt class="hdlist1">Finish</dt>
<dd>
<p>Post-configuration scripts to execute using an SSH connection when the main provisioning process completes.
You can use Finish templates only for image-based provisioning in virtual or cloud environments that do not support user_data.
Do not confuse an image with a foreman discovery ISO, which is sometimes called a Foreman discovery image.
An image in this context is an install image in a virtualized environment for easy deployment.</p>
<div class="paragraph">
<p>When a finish script successfully exits with the return code <code>0</code>, Red&#160;Hat Satellite treats the code as a success and the host exits the build mode.</p>
</div>
<div class="paragraph">
<p>Note that there are a few finish scripts with a build mode that uses a <em>call back</em> HTTP call.
These scripts are not used for image-based provisioning, but for post configuration of operating-system installations such as Debian, Ubuntu, and BSD.
Red&#160;Hat does not support provisioning of operating systems other than Red&#160;Hat Enterprise Linux.</p>
</div>
</dd>
<dt class="hdlist1">user_data</dt>
<dd>
<p>Post-configuration scripts for providers that accept custom data, also known as seed data.
You can use the user_data template to provision virtual machines in cloud or virtualised environments only.
This template does not require Satellite to be able to reach the host; the cloud or virtualization platform is responsible for delivering the data to the image.</p>
<div class="paragraph">
<p>Ensure that the image that you want to provision has the software to read the data installed and set to start during boot.
For example, <code>cloud-init</code>, which expects YAML input, or <code>ignition</code>, which expects JSON input.</p>
</div>
</dd>
<dt class="hdlist1">cloud_init</dt>
<dd>
<p>Some environments, such as VMWare, either do not support custom data or have their own data format that limits what can be done during customization.
In this case, you can configure a cloud-init client with the <code>foreman</code> plugin, which attempts to download the template directly from Satellite over HTTP or HTTPS.
This technique can be used in any environment, preferably virtualized.</p>
<div class="paragraph">
<p>Ensure that you meet the following requirements to use the <code>cloud_init</code> template:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ensure that the image that you want to provision has the software to read the data installed and set to start during boot.</p>
</li>
<li>
<p>A provisioned host is able to reach Satellite from the IP address that matches the host&#8217;s provisioning interface IP.</p>
<div class="paragraph">
<p>Note that cloud-init does not work behind NAT.</p>
</div>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Bootdisk</dt>
<dd>
<p>Templates for PXE-less boot methods.</p>
</dd>
<dt class="hdlist1">Kernel Execution (kexec)</dt>
<dd>
<p>Kernel execution templates for PXE-less boot methods.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Kernel Execution is a Technology Preview feature.
Technology Preview features are not fully supported under Red Hat Subscription Service Level Agreements (SLAs), may not be functionally complete, and are not intended for production use.
However, these features provide early access to upcoming product innovations, enabling customers to test functionality and provide feedback during the development process.</p>
</div>
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1">Script</dt>
<dd>
<p>An arbitrary script not used by default but useful for custom tasks.</p>
</dd>
<dt class="hdlist1">ZTP</dt>
<dd>
<p>Zero Touch Provisioning templates.</p>
</dd>
<dt class="hdlist1">POAP</dt>
<dd>
<p>PowerOn Auto Provisioning templates.</p>
</dd>
<dt class="hdlist1">iPXE</dt>
<dd>
<p>Templates for <code>iPXE</code> or <code>gPXE</code> environments to use instead of PXELinux.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="creating-provisioning-templates"><a class="anchor" href="#creating-provisioning-templates"></a>4.3. Creating provisioning templates</h3>
<div class="paragraph">
<p>A provisioning template defines the way Satellite&#160;Server installs an operating system on a host.
Use this procedure to create a new provisioning template.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Provisioning Templates</strong> and click <strong>Create Template</strong>.</p>
</li>
<li>
<p>In the <strong>Name</strong> field, enter a name for the provisioning template.</p>
</li>
<li>
<p>Fill in the rest of the fields as required.
The <strong>Help</strong> tab provides information about the template syntax and details the available functions, variables, and methods that can be called on different types of objects within the template.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">CLI procedure</div>
<ol class="arabic">
<li>
<p>Before you create a template with the CLI, create a plain text file that contains the template.
This example uses the <code>~/my-template</code> file.</p>
</li>
<li>
<p>Create the template using the <code>hammer template create</code> command and specify the type with the <code>--type</code> option:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer template create \
--file ~/my-template \
--locations "<em>My_Location</em>" \
--name "<em>My_Provisioning_Template</em>" \
--organizations "<em>My_Organization</em>" \
--type provision</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="cloning-provisioning-templates"><a class="anchor" href="#cloning-provisioning-templates"></a>4.4. Cloning provisioning templates</h3>
<div class="paragraph">
<p>A provisioning template defines the way Satellite&#160;Server installs an operating system on a host.
Use this procedure to clone a template and add your updates to the clone.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Provisioning Templates</strong>.</p>
</li>
<li>
<p>Find the template that you want to use.</p>
</li>
<li>
<p>Click <strong>Clone</strong> to duplicate the template.</p>
</li>
<li>
<p>In the <strong>Name</strong> field, enter a name for the provisioning template.</p>
</li>
<li>
<p>Select the <strong>Default</strong> checkbox to set the template to associate automatically with new organizations or locations.</p>
</li>
<li>
<p>In the <strong>Template editor</strong> field, enter the body of the provisioning template.
You can also use the <strong>Template</strong> file browser to upload a template file.</p>
</li>
<li>
<p>In the <strong>Audit Comment</strong> field, enter a summary of changes to the provisioning template for auditing purposes.</p>
</li>
<li>
<p>Click the <strong>Type</strong> tab and if your template is a snippet, select the <strong>Snippet</strong> checkbox.
A snippet is not a standalone provisioning template, but a part of a provisioning template that can be inserted into other provisioning templates.</p>
</li>
<li>
<p>From the <strong>Type</strong> list, select the type of the template.
For example, <strong>Provisioning template</strong>.</p>
</li>
<li>
<p>Click the <strong>Association</strong> tab and from the <strong>Applicable Operating Systems</strong> list, select the names of the operating systems that you want to associate with the provisioning template.</p>
</li>
<li>
<p>Optionally, click <strong>Add combination</strong> and select a host group from the <strong>Host Group</strong> list or an environment from the <strong>Environment</strong> list to associate provisioning template with the host groups and environments.</p>
</li>
<li>
<p>Click the <strong>Organizations</strong> and <strong>Locations</strong> tabs to add any additional contexts to the template.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save your provisioning template.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Creating_Custom_Provisioning_Snippets_provisioning-installer"><a class="anchor" href="#Creating_Custom_Provisioning_Snippets_provisioning-installer"></a>4.5. Creating custom provisioning snippets</h3>
<div class="paragraph">
<p>You can execute custom code before and/or after the host provisioning process.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Check your provisioning template to ensure that it supports the custom snippets you want to use.</p>
<div class="paragraph">
<p>You can view all provisioning templates under <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Provisioning Templates</strong>.</p>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Provisioning Templates</strong> and click <strong>Create Template</strong>.</p>
</li>
<li>
<p>In the <strong>Name</strong> field, enter a name for your custom provisioning snippet.
The name must start with the name of a provisioning template that supports including custom provisioning snippets:</p>
<div class="ulist">
<ul>
<li>
<p>Append <code>custom pre</code> to the name of a provisioning template to run code before provisioning a host.</p>
</li>
<li>
<p>Append <code>custom post</code> to the name of a provisioning template to run code after provisioning a host.</p>
</li>
</ul>
</div>
</li>
<li>
<p>On the <strong>Type</strong> tab, select <strong>Snippet</strong>.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to create your custom provisioning snippet.</p>
</li>
</ol>
</div>
<div id="cli-Creating_Custom_Provisioning_Snippets_provisioning-installer" class="olist arabic">
<div class="title">CLI procedure</div>
<ol class="arabic">
<li>
<p>Create a plain text file that contains your custom snippet.</p>
</li>
<li>
<p>Create the template using <code>hammer</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer template create \
--file "<em>/path/to/My_Snippet</em>" \
--locations "<em>My_Location</em>" \
--name "<em>My_Template_Name_custom_pre" \
--organizations "_My_Organization</em>" \
--type snippet</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Custom_Provisioning_Snippet_Example_for_Enterprise_Linux_provisioning-installer"><a class="anchor" href="#Custom_Provisioning_Snippet_Example_for_Enterprise_Linux_provisioning-installer"></a>4.6. Custom provisioning snippet example for Red&#160;Hat Enterprise Linux</h3>
<div class="paragraph">
<p>You can use <code>Custom Post</code> snippets to call external APIs from within the provisioning template directly after provisioning a host.</p>
</div>
<div class="listingblock">
<div class="title"><code>Kickstart default finish custom post</code> Example for Red&#160;Hat Enterprise Linux</div>
<div class="content">
<pre class="nowrap">echo "Calling API to report successful host deployment"

yum install -y curl ca-certificates

curl -X POST \
-H "Content-Type: application/json" \
-d '{"name": "&lt;%= @host.name %&gt;", "operating_system": "&lt;%= @host.operatingsystem.name %&gt;", "status": "provisioned",}' \
"https://api.example.com/"</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Associating_Templates_with_Operating_Systems_provisioning-installer"><a class="anchor" href="#Associating_Templates_with_Operating_Systems_provisioning-installer"></a>4.7. Associating templates with operating systems</h3>
<div class="paragraph">
<p>You can associate templates with operating systems in Satellite.
The following example adds a provisioning template to an operating system entry.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Provisioning Templates</strong>.</p>
</li>
<li>
<p>Select a provisioning template.</p>
</li>
<li>
<p>On the <strong>Association</strong> tab, select all applicable operating systems.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save your changes.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">CLI procedure</div>
<ol class="arabic">
<li>
<p>Optional: View all templates:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer template list</pre>
</div>
</div>
</li>
<li>
<p>Optional: View all operating systems:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer os list</pre>
</div>
</div>
</li>
<li>
<p>Associate a template with an operating system:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer template add-operatingsystem \
--id <em>My_Template_ID</em> \
--operatingsystem-id <em>My_Operating_System_ID</em></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="creating-partition-tables_provisioning-installer"><a class="anchor" href="#creating-partition-tables_provisioning-installer"></a>4.8. Creating partition tables</h3>
<div class="paragraph">
<p>A partition table is a type of template that defines the way Satellite&#160;Server configures the disks available on a new host.
A Partition table uses the same ERB syntax as provisioning templates.
Red&#160;Hat Satellite contains a set of default partition tables to use, including a <code>Kickstart default</code>.
You can also edit partition table entries to configure the preferred partitioning scheme, or create a partition table entry and add it to the operating system entry.</p>
</div>
<div class="paragraph">
<p>To use the CLI instead of the Satellite web UI, see the <a href="#cli-creating-partition-tables_provisioning-installer">CLI procedure</a>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Partition Tables</strong>.</p>
</li>
<li>
<p>Click <strong>Create Partition Table</strong>.</p>
</li>
<li>
<p>In the <strong>Name</strong> field, enter a name for the partition table.</p>
</li>
<li>
<p>Select the <strong>Default</strong> checkbox if you want to set the template to automatically associate with new organizations or locations.</p>
</li>
<li>
<p>Select the <strong>Snippet</strong> checkbox if you want to identify the template as a reusable snippet for other partition tables.</p>
</li>
<li>
<p>From the <strong>Operating System Family</strong> list, select the distribution or family of the partitioning layout.
For example, Red&#160;Hat Enterprise Linux, CentOS, and Fedora are in the Red Hat family.</p>
</li>
<li>
<p>In the <strong>Template editor</strong> field, enter the layout for the disk partition.</p>
<div class="paragraph">
<p>The format of the layout must match that for the intended operating system.
For example, Red&#160;Hat Enterprise Linux requires a layout that matches a Kickstart file, such as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>zerombr
clearpart --all --initlabel
autopart</pre>
</div>
</div>
<div class="paragraph">
<p>For more information, see <a href="#dynamic-partition-example_provisioning-installer">Dynamic partition example</a>.</p>
</div>
<div class="paragraph">
<p>You can also use the file browser in the template editor to import the layout from a file.</p>
</div>
</li>
<li>
<p>In the <strong>Audit Comment</strong> field, add a summary of changes to the partition layout.</p>
</li>
<li>
<p>Click the <strong>Organizations</strong> and <strong>Locations</strong> tabs to add any other provisioning contexts that you want to associate with the partition table.
Satellite adds the partition table to the current provisioning context.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save your partition table.</p>
</li>
</ol>
</div>
<div id="cli-creating-partition-tables_provisioning-installer" class="olist arabic">
<div class="title">CLI procedure</div>
<ol class="arabic">
<li>
<p>Create a plain text file, such as <code><em>~/My_Partition_Table</em></code>, that contains the partition layout.</p>
<div class="paragraph">
<p>The format of the layout must match that for the intended operating system.
For example, Red&#160;Hat Enterprise Linux requires a layout that matches a Kickstart file, such as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>zerombr
clearpart --all --initlabel
autopart</pre>
</div>
</div>
<div class="paragraph">
<p>For more information, see <a href="#dynamic-partition-example_provisioning-installer">Dynamic partition example</a>.</p>
</div>
</li>
<li>
<p>Create the installation medium using the <code>hammer partition-table create</code> command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer partition-table create \
--file "<em>~/My_Partition_Table</em>" \
--locations "<em>My_Location</em>" \
--name "<em>My_Partition_Table</em>" \
--organizations "<em>My_Organization</em>" \
--os-family "Redhat" \
--snippet false</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="associating-partition-tables-with-disk-encryption_provisioning-installer"><a class="anchor" href="#associating-partition-tables-with-disk-encryption_provisioning-installer"></a>4.9. Associating partition tables with disk encryption</h3>
<div class="paragraph">
<p>Satellite contains partition tables that encrypt the disk of your host by using Linux Unified Key Setup (LUKS) during host provisioning.
Encrypted disks on hosts protect data at rest.
Optionally, you can also bind the disk to a Tang server through Clevis for decryption during boot.</p>
</div>
<div class="paragraph">
<p>Associate the partition table with your operating system entry.
Then, you assign the partition table to your host group or select it manually during provisioning.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Your host has access to the <code>AppStream</code> repository to install <code>clevis</code> during provisioning.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Provisioning Setup</strong> &gt; <strong>Operating Systems</strong>.</p>
</li>
<li>
<p>Select your Red&#160;Hat Enterprise Linux entry.</p>
</li>
<li>
<p>On the <strong>Partition Table</strong> tab, associate <code>Kickstart default encrypted</code> with your operating system entry.</p>
</li>
<li>
<p>Create a host group that uses the <code>Kickstart default encrypted</code> partition table.
For more information, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/managing_hosts/index#Creating_a_Host_Group_managing-hosts">Creating a host group</a> in <em>Managing hosts</em>.</p>
</li>
<li>
<p>Decrypt the disk of your host during boot time by using one of the following options:</p>
<div class="ulist">
<ul>
<li>
<p>LUKS encryption: Add the host parameter <code>disk_enc_passphrase</code> as type <strong>string</strong> and your cleartext passphrase of the LUKS container as the value.</p>
</li>
<li>
<p>Clevis and Tang: Add the host parameter <code>disk_enc_tang_servers</code> as type <strong>array</strong> and your list of Tang servers (example: <code>["1.2.3.4"]</code> or <code>["server.example.com", "5.6.7.8"]</code>).</p>
<div class="paragraph">
<p>If you set <code>disk_enc_tang_servers</code>, do not set <code>disk_enc_passphrase</code> because the passphrase slot is removed from the LUKS container after provisioning.</p>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="dynamic-partition-example_provisioning-installer"><a class="anchor" href="#dynamic-partition-example_provisioning-installer"></a>4.10. Dynamic partition example</h3>
<div class="paragraph">
<p>Using an Anaconda Kickstart template, the following section instructs Anaconda to erase the whole disk, automatically partition, enlarge one partition to maximum size, and then proceed to the next sequence of events in the provisioning process:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-none" data-lang="none">zerombr
clearpart --all --initlabel
autopart &lt;%= host_param('autopart_options') %&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Dynamic partitioning is executed by the installation program.
Therefore, you can write your own rules to specify how you want to partition disks according to runtime information from the node, for example, disk sizes, number of drives, vendor, or manufacturer.</p>
</div>
<div class="paragraph">
<p>If you want to provision servers and use dynamic partitioning, add the following example as a template.
When the <code>#Dynamic</code> entry is included, the content of the template loads into a <code>%pre</code> shell scriplet and creates a <code>/tmp/diskpart.cfg</code> that is then included into the Kickstart partitioning section.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-none" data-lang="none">#Dynamic (do not remove this line)

MEMORY=$((`grep MemTotal: /proc/meminfo | sed 's/^MemTotal: *//'|sed 's/ .*//'` / 1024))
if [ "$MEMORY" -lt 2048 ]; then
    SWAP_MEMORY=$(($MEMORY * 2))
elif [ "$MEMORY" -lt 8192 ]; then
    SWAP_MEMORY=$MEMORY
elif [ "$MEMORY" -lt 65536 ]; then
    SWAP_MEMORY=$(($MEMORY / 2))
else
    SWAP_MEMORY=32768
fi

cat &lt;&lt;EOF &gt; /tmp/diskpart.cfg
zerombr
clearpart --all --initlabel
part /boot --fstype ext4 --size 200 --asprimary
part swap --size "$SWAP_MEMORY"
part / --fstype ext4 --size 1024 --grow
EOF</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="preparing-networking"><a class="anchor" href="#preparing-networking"></a>5. Preparing networking</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Each provisioning type requires some network configuration.
Use this chapter to configure network services in your integrated Capsule on Satellite&#160;Server.</p>
</div>
<div class="paragraph">
<p>New hosts must have access to your Capsule&#160;Server.
Capsule&#160;Server can be either your integrated Capsule on Satellite&#160;Server or an external Capsule&#160;Server.
You might want to provision hosts from an external Capsule&#160;Server when the hosts are on isolated networks and cannot connect to Satellite&#160;Server directly, or when the content is synchronized with Capsule&#160;Server.
Provisioning by using Capsule&#160;Servers can save on network bandwidth.</p>
</div>
<div class="paragraph">
<p>Configuring Capsule&#160;Server has two basic requirements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Configuring network services.
This includes:</p>
<div class="ulist">
<ul>
<li>
<p>Content delivery services</p>
</li>
<li>
<p>Network services (DHCP, DNS, and TFTP)</p>
</li>
<li>
<p>Puppet configuration</p>
</li>
</ul>
</div>
</li>
<li>
<p>Defining network resource data in Satellite&#160;Server to help configure network interfaces on new hosts.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following instructions have similar applications to configuring standalone Capsules managing a specific network.
To configure Satellite to use external DHCP, DNS, and TFTP services, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/installing_satellite_server_in_a_connected_network_environment/index#configuring-external-services">Configuring External Services</a> in <em>Installing Satellite&#160;Server in a connected network environment</em>.</p>
</div>
<div class="sect2">
<h3 id="facts-and-nic-filtering_provisioning-installer"><a class="anchor" href="#facts-and-nic-filtering_provisioning-installer"></a>5.1. Facts and NIC filtering</h3>
<div class="paragraph">
<p>Facts describe aspects such as total memory, operating system version, or architecture as reported by the host.
You can find facts in <strong>Monitor</strong> &gt; <strong>Facts</strong> and search hosts through facts or use facts in templates.</p>
</div>
<div class="paragraph">
<p>Satellite collects facts from multiple sources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>subscription manager</code></p>
</li>
<li>
<p><code>ansible</code></p>
</li>
<li>
<p><code>puppet</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Satellite is an inventory system for hosts and network interfaces.
For hypervisors or container hosts, adding thousands of interfaces per host and updating the inventory every few minutes is inadequate.
For each individual NIC reported, Satellite creates a NIC entry and those entries are never removed from the database.
Parsing all the facts and comparing all records in the database makes Satellite extremely slow and unusable.
To optimize the performance of various actions, most importantly fact import, you can use the options available on the <strong>Facts</strong> tab under <strong>Administer</strong> &gt; <strong>Settings</strong>.</p>
</div>
</div>
<div class="sect2">
<h3 id="optimizing-performance-by-removing-nics-from-database_provisioning-installer"><a class="anchor" href="#optimizing-performance-by-removing-nics-from-database_provisioning-installer"></a>5.2. Optimizing performance by removing NICs from database</h3>
<div class="paragraph">
<p>Filter and exclude the connections using the <code>Exclude pattern for facts stored in Satellite</code> and <code>Ignore interfaces with matching identifier</code> option.
By default, these options are set to most common hypervisors.
If you name the virtual interfaces differently, you can update this filter to use it according to your requirements.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Administer</strong> &gt; <strong>Settings</strong> and select the <strong>Facts</strong> tab.</p>
</li>
<li>
<p>To filter out all interfaces starting with specific names, for example, <code>blu</code>, add <code>blu*</code> to the <code>Ignore interfaces with matching identifier</code> option.</p>
</li>
<li>
<p>To prevent databases from storing facts related to interfaces starting with specific names, for example, <code>blu</code>, add <code>blu*</code> to the <code>Exclude pattern for facts stored in Satellite</code> option.</p>
<div class="paragraph">
<p>By default, it contains the same list as the <code>Ignore interfaces with matching identifier</code> option.
You can override it based on the your requirements.
This filters out facts completely without storing them.</p>
</div>
</li>
<li>
<p>To remove facts from the database, enter the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-rake facts:clean</pre>
</div>
</div>
<div class="paragraph">
<p>This command removes all facts matching with the filter added in <strong>Administer</strong> &gt; <strong>Settings</strong> &gt; <strong>Facts</strong> &gt; the <code>Exclude pattern for facts stored in Satellite</code> option.</p>
</div>
</li>
<li>
<p>To remove interfaces from the database, enter the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-rake interfaces:clean</pre>
</div>
</div>
<div class="paragraph">
<p>This command removes all interfaces matching with the filter added in <strong>Administer</strong> &gt; <strong>Settings</strong> &gt; <strong>Facts</strong> &gt; the <code>Ignore interfaces with matching identifier</code> option.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Network_Resources_provisioning-installer"><a class="anchor" href="#Network_Resources_provisioning-installer"></a>5.3. Network resources</h3>
<div class="paragraph">
<p>Satellite contains networking resources that you must set up and configure to create a host.
It includes the following networking resources:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Domain</dt>
<dd>
<p>You must assign every host that is managed by Satellite to a domain.
Using the domain, Satellite can manage A, AAAA, and PTR records.
Even if you do not want Satellite to manage your DNS servers, you still must create and associate at least one domain.
Domains are included in the naming conventions Satellite hosts, for example, a host with the name <code>test123</code> in the <code>example.com</code> domain has the fully qualified domain name <code>test123.example.com</code>.</p>
</dd>
<dt class="hdlist1">Subnet</dt>
<dd>
<p>You must assign every host managed by Satellite to a subnet.
Using subnets, Satellite can then manage IPv4 reservations.
If there are no reservation integrations, you still must create and associate at least one subnet.
When you manage a subnet in Satellite, you cannot create DHCP records for that subnet outside of Satellite.
In Satellite, you can use IP Address Management (IPAM) to manage IP addresses with one of the following options:</p>
<div class="ulist">
<ul>
<li>
<p><strong>DHCP</strong>: DHCP Capsule manages the assignment of IP addresses by finding the next available IP address starting from the first address of the range and skipping all addresses that are reserved.
Before assigning an IP address, Capsule sends an ICMP and TCP pings to check whether the IP address is in use.
Note that if a host is powered off, or has a firewall configured to disable connections, Satellite makes a false assumption that the IP address is available.
This check does not work for hosts that are turned off, therefore, the <strong>DHCP</strong> option can only be used with subnets that Satellite controls and that do not have any hosts created externally.</p>
<div class="paragraph">
<p>The Capsule DHCP module retains the offered IP addresses for a short period of time to prevent collisions during concurrent access, so some IP addresses in the IP range might remain temporarily unused.</p>
</div>
</li>
<li>
<p><strong>Internal DB</strong>: Satellite finds the next available IP address from the Subnet range by excluding all IP addresses from the Satellite database in sequence.
The primary source of data is the database, not DHCP reservations.
This IPAM is not safe when multiple hosts are being created in parallel; in that case, use <strong>DHCP</strong> or <strong>Random DB</strong> IPAM instead.</p>
</li>
<li>
<p><strong>Random DB</strong>: Satellite finds the next available IP address from the Subnet range by excluding all IP addresses from the Satellite database randomly.
The primary source of data is the database, not DHCP reservations.
This IPAM is safe to use with concurrent host creation as IP addresses are returned in random order, minimizing the chance of a conflict.</p>
</li>
<li>
<p><strong>EUI-64</strong>: Extended Unique Identifier (EUI) 64bit IPv6 address generation, as per RFC2373, is obtained through the 48-bit MAC address.</p>
</li>
<li>
<p><strong>External IPAM</strong>: Delegates IPAM to an external system through Capsule feature.
Satellite currently does not ship with any external IPAM implementations, but several plugins are in development.</p>
</li>
<li>
<p><strong>None</strong>: IP address for each host must be entered manually.</p>
<div class="paragraph">
<p>Options DHCP, Internal DB and Random DB can lead to DHCP conflicts on subnets with records created externally.
These subnets must be under exclusive Satellite control.</p>
</div>
<div class="paragraph">
<p>For more information about adding a subnet, see <a href="#Adding_a_Subnet_to_Server_provisioning-installer">Adding a subnet to Satellite&#160;Server</a>.</p>
</div>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">DHCP Ranges</dt>
<dd>
<p>You can define the same DHCP range in Satellite&#160;Server for both discovered and provisioned systems, but use a separate range for each service within the same subnet.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="satellite-and-dhcp-configuration"><a class="anchor" href="#satellite-and-dhcp-configuration"></a>5.4. Satellite and DHCP configuration</h3>
<div class="paragraph">
<p>Satellite manages DHCP reservations through a DHCP Capsule.</p>
</div>
<div class="sect3">
<h4 id="options-in-managed-dhcpv4"><a class="anchor" href="#options-in-managed-dhcpv4"></a>5.4.1. Options in managed DHCPv4</h4>
<div class="paragraph">
<p>When Satellite manages the DHCP service and can update the DHCP configuration, Satellite sets the <code>next-server</code> and <code>filename</code> DHCP options.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>next-server</code></dt>
<dd>
<p>The <code>next-server</code> option provides the IP address of the TFTP server to boot from.
This option is not set by default and must be set for each TFTP Capsule.
You can use the <code>satellite-installer</code> command with the <code>--foreman-proxy-tftp-servername</code> argument to set the TFTP server in the <code>/etc/foreman-proxy/settings.d/tftp.yml</code> file:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-installer --foreman-proxy-tftp-servername <em>1.2.3.4</em></pre>
</div>
</div>
<div class="paragraph">
<p>Each TFTP Capsule then reports this setting through the API and Satellite can retrieve the configuration information when it creates the DHCP record.</p>
</div>
<div class="paragraph">
<p>When the PXE loader is set to <code>none</code>, Satellite does not populate the <code>next-server</code> option into the DHCP record.</p>
</div>
<div class="paragraph">
<p>If the <code>next-server</code> option remains undefined, Satellite calls the Capsule API to retrieve the server name as specified by the <code>--foreman-proxy-tftp-servername</code> argument in a <code>satellite-installer</code> run.
If the Capsule API call does not return a server name, Satellite uses the hostname of the Capsule.</p>
</div>
</dd>
<dt class="hdlist1"><code>filename</code></dt>
<dd>
<p>The <code>filename</code> option contains the full path to the file that downloads and executes during provisioning.
The PXE loader that you select for the host or host group defines which <code>filename</code> option to use.
When the PXE loader is set to <code>none</code>, Satellite does not populate the <code>filename</code> option into the DHCP record.
Depending on the PXE loader option, the <code>filename</code> changes as follows:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">PXE loader option</th>
<th class="tableblock halign-left valign-top">filename entry</th>
<th class="tableblock halign-left valign-top">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PXELinux BIOS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pxelinux.0</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PXELinux UEFI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pxelinux.efi</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">iPXE Chain BIOS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>undionly.kpxe</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PXEGrub2 UEFI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>grub2/grubx64.efi</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x64 can differ depending on architecture</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">iPXE UEFI HTTP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>http://<em>capsule.example.com</em>:8000/httpboot/ipxe-x64.efi</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Requires the <code>httpboot</code> feature and renders the <code>filename</code> as a full URL where <em>capsule.example.com</em> is a known host name of Capsule in Satellite.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Grub2 UEFI HTTP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>http://<em>capsule.example.com</em>:8000/httpboot/grub2/grubx64.efi</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Requires the <code>httpboot</code> feature and renders the <code>filename</code> as a full URL where <em>capsule.example.com</em> is a known host name of Capsule in Satellite.</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="options-in-unmanaged-dhcpv6"><a class="anchor" href="#options-in-unmanaged-dhcpv6"></a>5.4.2. Options in unmanaged DHCPv6</h4>
<div class="paragraph">
<p>To provision hosts over TFTP in an IPv6-only network, configure the DHCP server to respond with the <code>bootfile-url</code> DHCP option.
Satellite cannot manage the DHCPv6 service, therefore, you have to configure your DHCP server manually.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>bootfile-url</code></dt>
<dd>
<p>The URL value of this option has to point to a file on TFTP Capsule that is a first-stage boot loader, such as <code>pxelinux.0</code>.
Example configuration:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">   "option-data": [
      {
         "name": "bootfile-url",
         "data": "tftp://2001:db8:1::1/pxelinux.0"
      }
   ],</pre>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Troubleshooting_DHCP_Problems_provisioning-installer"><a class="anchor" href="#Troubleshooting_DHCP_Problems_provisioning-installer"></a>5.5. Troubleshooting DHCP problems in Satellite</h3>
<div class="paragraph">
<p>Satellite can manage an ISC DHCP server on internal or external DHCP Capsule.
Satellite can list, create, and delete DHCP reservations and leases.
However, there are a number of problems that you might encounter on occasions.</p>
</div>
<div class="paragraph">
<div class="title">Out of sync DHCP records</div>
<p>When an error occurs during DHCP orchestration, DHCP records in the Satellite database and the DHCP server might not match.
To fix this, you must add missing DHCP records from the Satellite database to the DHCP server and then remove unwanted records from the DHCP server as per the following steps:</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>To preview the DHCP records that are going to be added to the DHCP server, enter the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-rake orchestration:dhcp:add_missing subnet_name=NAME</pre>
</div>
</div>
</li>
<li>
<p>If you are satisfied by the preview changes in the previous step, apply them by entering the above command with the <code>perform=1</code> argument:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-rake orchestration:dhcp:add_missing subnet_name=NAME perform=1</pre>
</div>
</div>
</li>
<li>
<p>To keep DHCP records in Satellite and in the DHCP server synchronized, you can remove unwanted DHCP records from the DHCP server.
Note that Satellite assumes that all managed DHCP servers do not contain third-party records, therefore, this step might delete those unexpected records.
To preview what records are going to be removed from the DHCP server, enter the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-rake orchestration:dhcp:remove_offending subnet_name=NAME</pre>
</div>
</div>
</li>
<li>
<p>If you are satisfied by the preview changes in the previous step, apply them by entering the above command with the <code>perform=1</code> argument:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># foreman-rake orchestration:dhcp:remove_offending subnet_name=NAME perform=1</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">PXE loader option change</div>
<p>When the PXE loader option is changed for an existing host, this causes a DHCP conflict.
The only workaround is to overwrite the DHCP entry.</p>
</div>
<div class="paragraph">
<div class="title">Incorrect permissions on DHCP files</div>
<p>An operating system update can update the <code>dhcpd</code> package.
This causes the permissions of important directories and files to reset so that the DHCP Capsule cannot read the required information.</p>
</div>
<div class="paragraph">
<p>For more information, see <a href="https://access.redhat.com/solutions/2952061">DHCP error while provisioning host from Satellite server Error ERF12-6899 ProxyAPI::ProxyException: Unable to set DHCP entry RestClient::ResourceNotFound 404 Resource Not Found</a> on Red&#160;Hat Knowledgebase.</p>
</div>
<div class="paragraph">
<div class="title">Changing the DHCP Capsule entry</div>
<p>Satellite manages DHCP records only for hosts that are assigned to subnets with a DHCP Capsule set.
If you create a host and then clear or change the DHCP Capsule, when you attempt to delete the host, the action fails.</p>
</div>
<div class="paragraph">
<p>If you create a host without setting the DHCP Capsule and then try to set the DHCP Capsule, this causes DHCP conflicts.</p>
</div>
<div class="paragraph">
<div class="title">Deleted hosts entries in the dhcpd.leases file</div>
<p>Any changes to a DHCP lease are appended to the end of the <code>dhcpd.leases</code> file.
Because entries are appended to the file, it is possible that two or more entries of the same lease can exist in the <code>dhcpd.leases</code> file at the same time.
When there are two or more entries of the same lease, the last entry in the file takes precedence.
Group, subgroup and host declarations in the lease file are processed in the same manner.
If a lease is deleted, <code>{ deleted; }</code> is appended to the declaration.</p>
</div>
</div>
<div class="sect2">
<h3 id="Configuring_Network_Services_provisioning-installer"><a class="anchor" href="#Configuring_Network_Services_provisioning-installer"></a>5.6. Configuring network services</h3>
<div class="paragraph">
<p>Some provisioning methods use Capsule&#160;Server services.
For example, a network might require Capsule&#160;Server to act as a DHCP server.
A network can also use PXE boot services to install the operating system on new hosts.
This requires configuring Capsule&#160;Server to use the main PXE boot services: DHCP, DNS, and TFTP.</p>
</div>
<div class="paragraph">
<p>Use the <code>satellite-installer</code> command with the options to configure these services on Satellite&#160;Server.</p>
</div>
<div class="paragraph">
<p>To configure these services on an external Capsule&#160;Server, run <code>satellite-installer</code>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Enter the <code>satellite-installer</code> command to configure the required network services:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-installer --foreman-proxy-dhcp true \
--foreman-proxy-dhcp-gateway "<em>192.168.140.1</em>" \
--foreman-proxy-dhcp-managed true \
--foreman-proxy-dhcp-nameservers "<em>192.168.140.2</em>" \
--foreman-proxy-dhcp-range "<em>192.168.140.10</em> <em>192.168.140.110</em>" \
--foreman-proxy-dhcp-server "<em>192.168.140.2</em>" \
--foreman-proxy-dns true \
--foreman-proxy-dns-forwarders "<em>8.8.8.8</em>" \
--foreman-proxy-dns-forwarders "<em>8.8.4.4</em>" \
--foreman-proxy-dns-managed true \
--foreman-proxy-dns-reverse "<em>140.168.192.in-addr.arpa</em>" \
--foreman-proxy-dns-server "<em>127.0.0.1</em>" \
--foreman-proxy-dns-zone "<em>example.com</em>" \
--foreman-proxy-tftp true \
--foreman-proxy-tftp-managed true</pre>
</div>
</div>
</li>
<li>
<p>Find Capsule&#160;Server that you configure:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># hammer capsule list</pre>
</div>
</div>
</li>
<li>
<p>Refresh features of Capsule&#160;Server to view the changes:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># hammer capsule refresh-features --name "<em>satellite.example.com</em>"</pre>
</div>
</div>
</li>
<li>
<p>Verify the services configured on Capsule&#160;Server:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># hammer capsule info --name "<em>satellite.example.com</em>"</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="Multiple_Subnets_or_Domains_Using_Installer_provisioning-installer"><a class="anchor" href="#Multiple_Subnets_or_Domains_Using_Installer_provisioning-installer"></a>5.6.1. Multiple subnets or domains using installer</h4>
<div class="paragraph">
<p>The <code>satellite-installer</code> options allow only for a single DHCP subnet or DNS domain.
One way to define more than one subnet is by using a custom configuration file.</p>
</div>
<div class="paragraph">
<p>For every additional subnet or domain, create an entry in <code>/etc/foreman-installer/custom-hiera.yaml</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>dhcp::pools:
 isolated.lan:
   network: 192.168.99.0
   mask: 255.255.255.0
   gateway: 192.168.99.1
   range: 192.168.99.5 192.168.99.49

dns::zones:
  # creates @ SOA $::fqdn root.example.com.
  # creates $::fqdn A $::ipaddress
  example.com: {}

  # creates @ SOA test.example.net. hostmaster.example.com.
  # creates test.example.net A 192.0.2.100
  example.net:
    soa: test.example.net
    soaip: 192.0.2.100
    contact: hostmaster.example.com.

  # creates @ SOA $::fqdn root.example.org.
  # does NOT create an A record
  example.org:
    reverse: true

  # creates @ SOA $::fqdn hostmaster.example.com.
  2.0.192.in-addr.arpa:
    reverse: true
    contact: hostmaster.example.com.</pre>
</div>
</div>
<div class="paragraph">
<p>Execute <code>satellite-installer</code> to perform the changes and verify that the <code>/etc/dhcp/dhcpd.conf</code> contains appropriate entries.
Subnets must be then defined in Satellite database.</p>
</div>
</div>
<div class="sect3">
<h4 id="DHCP_Options_For_Network_Configuration_provisioning-installer"><a class="anchor" href="#DHCP_Options_For_Network_Configuration_provisioning-installer"></a>5.6.2. DHCP options for network configuration</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">--foreman-proxy-dhcp</dt>
<dd>
<p>  Enables the DHCP service.
You can set this option to <code>true</code> or <code>false</code>.</p>
</dd>
<dt class="hdlist1">--foreman-proxy-dhcp-managed</dt>
<dd>
<p>  Enables Foreman to manage the DHCP service.
You can set this option to <code>true</code> or <code>false</code>.</p>
</dd>
<dt class="hdlist1">--foreman-proxy-dhcp-gateway</dt>
<dd>
<p>  The DHCP pool gateway.
Set this to the address of the external gateway for hosts on your private network.</p>
</dd>
<dt class="hdlist1">--foreman-proxy-dhcp-interface</dt>
<dd>
<p>  Sets the interface for the DHCP service to listen for requests.
Set this to <code>eth1</code>.</p>
</dd>
<dt class="hdlist1">--foreman-proxy-dhcp-nameservers</dt>
<dd>
<p>  Sets the addresses of the nameservers provided to clients through DHCP.
Set this to the address for Satellite&#160;Server on <code>eth1</code>.</p>
</dd>
<dt class="hdlist1">--foreman-proxy-dhcp-range</dt>
<dd>
<p>A space-separated DHCP pool range for Discovered and Unmanaged services.</p>
</dd>
<dt class="hdlist1">--foreman-proxy-dhcp-server</dt>
<dd>
<p>Sets the address of the DHCP server to manage.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Run <code>satellite-installer --help</code> to view more options related to DHCP and other Capsule services.</p>
</div>
</div>
<div class="sect3">
<h4 id="DNS_Options_For_Network_Configuration_provisioning-installer"><a class="anchor" href="#DNS_Options_For_Network_Configuration_provisioning-installer"></a>5.6.3. DNS options for network configuration</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">--foreman-proxy-dns</dt>
<dd>
<p>  Enables the DNS feature.
You can set this option to <code>true</code> or <code>false</code>.</p>
</dd>
<dt class="hdlist1">--foreman-proxy-dns-provider</dt>
<dd>
<p>Selects the provider to be used.</p>
</dd>
<dt class="hdlist1">--foreman-proxy-dns-managed</dt>
<dd>
<p>  Let the installer manage ISC BIND.
This is only relevant when using the <code>nsupdate</code> and <code>nsupdate_gss</code> providers.
You can set this option to <code>true</code> or <code>false</code>.</p>
</dd>
<dt class="hdlist1">--foreman-proxy-dns-forwarders</dt>
<dd>
<p>  Sets the DNS forwarders.
Only used when ISC BIND is managed by the installer.
Set this to your DNS recursors.</p>
</dd>
<dt class="hdlist1">--foreman-proxy-dns-interface</dt>
<dd>
<p>  Sets the interface to listen for DNS requests.
Only used when ISC BIND is managed by the installer.
Set this to <code>eth1</code>.</p>
</dd>
<dt class="hdlist1">--foreman-proxy-dns-reverse</dt>
<dd>
<p>  The DNS reverse zone name.
Only used when ISC BIND is managed by the installer.</p>
</dd>
<dt class="hdlist1">--foreman-proxy-dns-server</dt>
<dd>
<p>  Sets the address of the DNS server.
Only used by the <code>nsupdate</code>, <code>nsupdate_gss</code>, and <code>infoblox</code> providers.</p>
</dd>
<dt class="hdlist1">--foreman-proxy-dns-zone</dt>
<dd>
<p>  Sets the DNS zone name.
Only used when ISC BIND is managed by the installer.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Run <code>satellite-installer --help</code> to view more options related to DNS and other Capsule services.</p>
</div>
</div>
<div class="sect3">
<h4 id="TFTP_Options_For_Network_Configuration_provisioning-installer"><a class="anchor" href="#TFTP_Options_For_Network_Configuration_provisioning-installer"></a>5.6.4. TFTP options for network configuration</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">--foreman-proxy-tftp</dt>
<dd>
<p>  Enables TFTP service.
You can set this option to <code>true</code> or <code>false</code>.</p>
</dd>
<dt class="hdlist1">--foreman-proxy-tftp-managed</dt>
<dd>
<p>  Enables Foreman to manage the TFTP service.
You can set this option to <code>true</code> or <code>false</code>.</p>
</dd>
<dt class="hdlist1">--foreman-proxy-tftp-servername</dt>
<dd>
<p>  Sets the TFTP server to use.
Ensure that you use Capsule&#8217;s IP address.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Run <code>satellite-installer --help</code> to view more options related to TFTP and other Capsule services.</p>
</div>
</div>
<div class="sect3">
<h4 id="Using_TFTP_Services_Through_NAT_provisioning-installer"><a class="anchor" href="#Using_TFTP_Services_Through_NAT_provisioning-installer"></a>5.6.5. Using TFTP services through NAT</h4>
<div class="paragraph">
<p>You can use Satellite TFTP services through NAT.
To do this, on all NAT routers or firewalls, you must enable a TFTP service on UDP port 69 and enable the TFTP state tracking feature.
For more information, see the documentation for your NAT device.</p>
</div>
<div class="olist arabic">
<div class="title">Using NAT on Red&#160;Hat Enterprise Linux 7:</div>
<ol class="arabic">
<li>
<p>Allow the TFTP service in the firewall configuration:</p>
<div class="listingblock">
<div class="content">
<pre># firewall-cmd --add-service=tftp</pre>
</div>
</div>
</li>
<li>
<p>Make the changes persistent:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># firewall-cmd --runtime-to-permanent</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Using NAT on Red&#160;Hat Enterprise Linux 6:</div>
<ol class="arabic">
<li>
<p>Configure the firewall to allow TFTP service UDP on port 69:</p>
<div class="listingblock">
<div class="content">
<pre># iptables \
--sport 69 \
--state ESTABLISHED \
-A OUTPUT \
-i eth0 \
-j ACCEPT \
-m state \
-p udp
# service iptables save</pre>
</div>
</div>
</li>
<li>
<p>Load the <code>ip_conntrack_tftp</code> kernel TFTP state module.
In the <code>/etc/sysconfig/iptables-config</code> file, locate <code>IPTABLES_MODULES</code> and add <code>ip_conntrack_tftp</code> as follows:</p>
<div class="listingblock">
<div class="content">
<pre>IPTABLES_MODULES="ip_conntrack_tftp"</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Adding_a_Domain_to_Server_provisioning-installer"><a class="anchor" href="#Adding_a_Domain_to_Server_provisioning-installer"></a>5.7. Adding a domain to Satellite&#160;Server</h3>
<div class="paragraph">
<p>Satellite&#160;Server defines domain names for each host on the network.
Satellite&#160;Server must have information about the domain and Capsule&#160;Server responsible for domain name assignment.</p>
</div>
<div class="paragraph">
<div class="title">Checking for existing domains</div>
<p>Satellite&#160;Server might already have the relevant domain created as part of Satellite&#160;Server installation.
Switch the context to <code>Any Organization</code> and <code>Any Location</code> then check the domain list to see if it exists.</p>
</div>
<div class="paragraph">
<div class="title">DNS server configuration considerations</div>
<p>During the DNS record creation, Satellite performs conflict DNS lookups to verify that the host name is not in active use.
This check runs against one of the following DNS servers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The system-wide resolver if <strong>Administer</strong> &gt; <strong>Settings</strong> &gt; <strong>Query local nameservers</strong> is set to <strong>true</strong>.</p>
</li>
<li>
<p>The nameservers that are defined in the subnet associated with the host.</p>
</li>
<li>
<p>The authoritative NS-Records that are queried from the SOA from the domain name associated with the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you experience timeouts during DNS conflict resolution, check the following settings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The subnet nameservers must be reachable from Satellite&#160;Server.</p>
</li>
<li>
<p>The domain name must have a Start of Authority (SOA) record available from Satellite&#160;Server.</p>
</li>
<li>
<p>The system resolver in the <code>/etc/resolv.conf</code> file must have a valid and working configuration.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To use the CLI instead of the Satellite web UI, see the <a href="#cli-adding-a-domain_provisioning-installer">CLI procedure</a>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Infrastructure</strong> &gt; <strong>Domains</strong> and click <strong>Create Domain</strong>.</p>
</li>
<li>
<p>In the <strong>DNS Domain</strong> field, enter the full DNS domain name.</p>
</li>
<li>
<p>In the <strong>Fullname</strong> field, enter the plain text name of the domain.</p>
</li>
<li>
<p>Click the <strong>Parameters</strong> tab and configure any domain level parameters to apply to hosts attached to this domain.
For example, user defined Boolean or string parameters to use in templates.</p>
</li>
<li>
<p>Click <strong>Add Parameter</strong> and fill in the <strong>Name</strong> and <strong>Value</strong> fields.</p>
</li>
<li>
<p>Click the <strong>Locations</strong> tab, and add the location where the domain resides.</p>
</li>
<li>
<p>Click the <strong>Organizations</strong> tab, and add the organization that the domain belongs to.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save the changes.</p>
</li>
</ol>
</div>
<div id="cli-adding-a-domain_provisioning-installer" class="ulist">
<div class="title">CLI procedure</div>
<ul>
<li>
<p>Use the <code>hammer domain create</code> command to create a domain:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer domain create \
--description "<em>My_Domain</em>" \
--dns-id <em>My_DNS_ID</em> \
--locations "<em>My_Location</em>" \
--name "<em>my-domain.tld</em>" \
--organizations "<em>My_Organization</em>"</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this example, the <code>--dns-id</code> option uses <code>1</code>, which is the ID of your integrated Capsule on Satellite&#160;Server.</p>
</div>
</div>
<div class="sect2">
<h3 id="Adding_a_Subnet_to_Server_provisioning-installer"><a class="anchor" href="#Adding_a_Subnet_to_Server_provisioning-installer"></a>5.8. Adding a subnet to Satellite&#160;Server</h3>
<div class="paragraph">
<p>You must add information for each of your subnets to Satellite&#160;Server because Satellite configures interfaces for new hosts.
To configure interfaces, Satellite&#160;Server must have all the information about the network that connects these interfaces.</p>
</div>
<div class="paragraph">
<p>To use the CLI instead of the Satellite web UI, see the <a href="#cli-adding-a-subnet_provisioning-installer">CLI procedure</a>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Infrastructure</strong> &gt; <strong>Subnets</strong>, and in the Subnets window, click <strong>Create Subnet</strong>.</p>
</li>
<li>
<p>In the <strong>Name</strong> field, enter a name for the subnet.</p>
</li>
<li>
<p>In the <strong>Description</strong> field, enter a description for the subnet.</p>
</li>
<li>
<p>In the <strong>Network address</strong> field, enter the network address for the subnet.</p>
</li>
<li>
<p>In the <strong>Network prefix</strong> field, enter the network prefix for the subnet.</p>
</li>
<li>
<p>In the <strong>Network mask</strong> field, enter the network mask for the subnet.</p>
</li>
<li>
<p>In the <strong>Gateway address</strong> field, enter the external gateway for the subnet.</p>
</li>
<li>
<p>In the <strong>Primary DNS server</strong> field, enter a primary DNS for the subnet.</p>
</li>
<li>
<p>In the <strong>Secondary DNS server</strong>, enter a secondary DNS for the subnet.</p>
</li>
<li>
<p>From the <strong>IPAM</strong> list, select the method that you want to use for IP address management (IPAM).
For more information about IPAM, see <a href="#preparing-networking">Preparing networking</a>.</p>
</li>
<li>
<p>Enter the information for the IPAM method that you select.
Click the <strong>Remote Execution</strong> tab and select the Capsule that controls the remote execution.</p>
</li>
<li>
<p>Click the <strong>Domains</strong> tab and select the domains that apply to this subnet.</p>
</li>
<li>
<p>Click the <strong>Capsules</strong> tab and select the Capsule that applies to each service in the subnet, including DHCP, TFTP, and reverse DNS services.</p>
</li>
<li>
<p>Click the <strong>Parameters</strong> tab and configure any subnet level parameters to apply to hosts attached to this subnet.
For example, user defined Boolean or string parameters to use in templates.</p>
</li>
<li>
<p>Click the <strong>Locations</strong> tab and select the locations that use this Capsule.</p>
</li>
<li>
<p>Click the <strong>Organizations</strong> tab and select the organizations that use this Capsule.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save the subnet information.</p>
</li>
</ol>
</div>
<div id="cli-adding-a-subnet_provisioning-installer" class="ulist">
<div class="title">CLI procedure</div>
<ul>
<li>
<p>Create the subnet with the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer subnet create \
--boot-mode "DHCP" \
--description "<em>My_Description</em>" \
--dhcp-id <em>My_DHCP_ID</em> \
--dns-id <em>My_DNS_ID</em> \
--dns-primary "192.168.140.2" \
--dns-secondary "8.8.8.8" \
--domains "<em>my-domain.tld" \
--from "192.168.140.111" \
--gateway "192.168.140.1" \
--ipam "DHCP" \
--locations "_My_Location</em>" \
--mask "255.255.255.0" \
--name "<em>My_Network</em>" \
--network "192.168.140.0" \
--organizations "<em>My_Organization</em>" \
--tftp-id <em>My_TFTP_ID</em> \
--to "192.168.140.250"</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>In this example, the <code>--dhcp-id</code>, <code>--dns-id</code>, and <code>--tftp-id</code> options use 1, which is the ID of the integrated Capsule in Satellite&#160;Server.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="security-settings"><a class="anchor" href="#security-settings"></a>6. Security settings</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can configure global settings for provisioning.</p>
</div>
<div class="paragraph">
<p>This chapter only mentions notable settings.</p>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/administering_red_hat_satellite/index#provisioning_settings_admin">Provisioning settings</a> in <em>Administering Red&#160;Hat Satellite</em></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="configuring-the-security-token-validity-duration"><a class="anchor" href="#configuring-the-security-token-validity-duration"></a>6.1. Configuring the security token validity duration</h3>
<div class="paragraph">
<p>When performing any kind of provisioning, as a security measure, Satellite automatically generates a unique token and adds this token to the kickstart URL in the PXE configuration file (PXELinux, Grub2).
By default, the token is valid for 360 minutes.
When you provision a host, ensure that you reboot the host within this time frame.
If the token expires, it is no longer valid and you receive a 404 error and the operating system installer download fails.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Administer</strong> &gt; <strong>Settings</strong>, and click the <strong>Provisioning</strong> tab.</p>
</li>
<li>
<p>Find the <strong>Token duration</strong> option and click the edit icon and edit the duration, or enter <code>0</code> to disable token generation.
If token generation is disabled, an attacker can spoof client IP address and download kickstart from Satellite&#160;Server, including the encrypted root password.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="setting-a-default-encrypted-root-password_provisioning-installer"><a class="anchor" href="#setting-a-default-encrypted-root-password_provisioning-installer"></a>6.2. Setting a default encrypted root password for hosts</h3>
<div class="paragraph">
<p>If you do not want to set a plain text default root password for the hosts that you provision, you can use a default encrypted password.</p>
</div>
<div class="paragraph">
<p>The default root password can be inherited by a host group and consequentially by hosts in that group.</p>
</div>
<div class="paragraph">
<p>If you change the password and reprovision the hosts in the group that inherits the password, the password will be overwritten on the hosts.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Generate an encrypted password:</p>
<div class="listingblock">
<div class="content">
<pre>$ python3 -c 'import crypt,getpass;pw=getpass.getpass(); print(crypt.crypt(pw)) if (pw==getpass.getpass("Confirm: ")) else exit()'</pre>
</div>
</div>
</li>
<li>
<p>Copy the password for later use.</p>
</li>
<li>
<p>In the Satellite web UI, navigate to <strong>Administer</strong> &gt; <strong>Settings</strong>.</p>
</li>
<li>
<p>On the <strong>Settings</strong> page, select the <strong>Provisioning</strong> tab.</p>
</li>
<li>
<p>In the <strong>Name</strong> column, navigate to <strong>Root password</strong>, and click <strong>Click to edit</strong>.</p>
</li>
<li>
<p>Paste the encrypted password, and click <strong>Save</strong>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Provisioning_FIPS_Compliant_Hosts_provisioning-installer"><a class="anchor" href="#Provisioning_FIPS_Compliant_Hosts_provisioning-installer"></a>6.3. Provisioning FIPS-compliant hosts</h3>
<div class="paragraph">
<p>Satellite supports provisioning hosts that comply with the National Institute of Standards and Technology&#8217;s <a href="https://csrc.nist.gov/publications/detail/fips/140/2/final">Security Requirements for Cryptographic Modules</a> standard, reference number FIPS 140-2, referred to here as FIPS.</p>
</div>
<div class="paragraph">
<p>To enable the provisioning of hosts that are FIPS-compliant, complete the following tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Change the provisioning password hashing algorithm for the operating system</p>
</li>
<li>
<p>Create a host group and set a host group parameter to enable FIPS</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/managing_hosts/index#Creating_a_Host_Group_managing-hosts">Creating a Host Group</a> in <em>Managing hosts</em>.</p>
</div>
<div class="paragraph">
<p>The provisioned hosts have the FIPS-compliant settings applied.
To confirm that these settings are enabled, complete the steps in <a href="#Verifying_FIPS_Mode_Is_Enabled_provisioning-installer">Verifying FIPS mode is enabled</a>.</p>
</div>
<div class="sect3">
<h4 id="Changing_the_Provisioning_Password_Hashing_Algorithm_provisioning-installer"><a class="anchor" href="#Changing_the_Provisioning_Password_Hashing_Algorithm_provisioning-installer"></a>6.3.1. Changing the provisioning password hashing algorithm</h4>
<div class="paragraph">
<p>To provision FIPS-compliant hosts, you must first set the password hashing algorithm that you use in provisioning to SHA256.
This configuration setting must be applied for each operating system you want to deploy as FIPS-compliant.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Identify the Operating System IDs:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer os list</pre>
</div>
</div>
</li>
<li>
<p>Update each operating system&#8217;s password hash value.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer os update \
--password-hash SHA256
--title "<em>My_Operating_System</em>"</pre>
</div>
</div>
<div class="paragraph">
<p>Note that you cannot use a comma-separated list of values.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Setting_the_FIPS_Enabled_Parameter_provisioning-installer"><a class="anchor" href="#Setting_the_FIPS_Enabled_Parameter_provisioning-installer"></a>6.3.2. Setting the FIPS-enabled parameter</h4>
<div class="paragraph">
<p>To provision a FIPS-compliant host, you must create a host group and set the host group parameter <code>fips_enabled</code> to <code>true</code>.
If this is not set to <code>true</code>, or is absent, the FIPS-specific changes do not apply to the system.
You can set this parameter when you provision a host or for a host group.</p>
</div>
<div class="paragraph">
<p>To set this parameter when provisioning a host, append <code>--parameters fips_enabled=true</code> to the Hammer command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer hostgroup set-parameter \
--hostgroup "<em>My_Host_Group</em>" \
--name fips_enabled \
--value "true"</pre>
</div>
</div>
<div class="paragraph">
<p>For more information, see the output of the command <code>hammer hostgroup set-parameter --help</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="Verifying_FIPS_Mode_Is_Enabled_provisioning-installer"><a class="anchor" href="#Verifying_FIPS_Mode_Is_Enabled_provisioning-installer"></a>6.3.3. Verifying FIPS mode is enabled</h4>
<div class="paragraph">
<p>To verify these FIPS compliance changes have been successful, you must provision a host and check its configuration.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Log in to the host as <code>root</code> or with an admin-level account.</p>
</li>
<li>
<p>Enter the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ cat /proc/sys/crypto/fips_enabled</pre>
</div>
</div>
<div class="paragraph">
<p>A value of <code>1</code> confirms that FIPS mode is enabled.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="provisioning-contexts_provisioning-installer"><a class="anchor" href="#provisioning-contexts_provisioning-installer"></a>7. Provisioning contexts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A provisioning context is the combination of an organization and location that you specify for Satellite components.
The organization and location that a component belongs to sets the ownership and access for that component.</p>
</div>
<div class="paragraph">
<p>Organizations divide Red&#160;Hat Satellite components into logical groups based on ownership, purpose, content, security level, and other divisions.
You can create and manage multiple organizations through Red&#160;Hat Satellite and assign components to each individual organization.
This ensures Satellite&#160;Server provisions hosts within a certain organization and only uses components that are assigned to that organization.
For more information about organizations, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/administering_red_hat_satellite/index#Managing_Organizations_admin">Managing Organizations</a> in <em>Administering Red&#160;Hat Satellite</em>.</p>
</div>
<div class="paragraph">
<p>Locations function similar to organizations.
The difference is that locations are based on physical or geographical setting.
Users can nest locations in a hierarchy.
For more information about locations, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/administering_red_hat_satellite/index#Managing_Locations_admin">Managing Locations</a> in <em>Administering Red&#160;Hat Satellite</em>.</p>
</div>
<div class="sect2">
<h3 id="setting-the-provisioning-context_provisioning-installer"><a class="anchor" href="#setting-the-provisioning-context_provisioning-installer"></a>7.1. Setting the provisioning context</h3>
<div class="paragraph">
<p>When you set a provisioning context, you define which organization and location to use for provisioning hosts.</p>
</div>
<div class="paragraph">
<p>The organization and location menus are located in the menu bar, on the upper left of the Satellite web UI.
If you have not selected an organization and location to use, the menu displays: <strong>Any Organization</strong> and <strong>Any Location</strong>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Click <strong>Any Organization</strong> and select the organization.</p>
</li>
<li>
<p>Click <strong>Any Location</strong> and select the location to use.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Each user can set their default provisioning context in their account settings.
Click the user name in the upper right of the Satellite web UI and select <strong>My account</strong> to edit your user account settings.</p>
</div>
<div class="ulist">
<div class="title">CLI procedure</div>
<ul>
<li>
<p>When using the CLI, include either <code>--organization</code> or <code>--organization-label</code> and <code>--location</code> or <code>--location-id</code> as an option.
For example:</p>
<div class="listingblock">
<div class="content">
<pre>$ hammer host list --organization "<em>My_Organization</em>" --location "<em>My_Location</em>"</pre>
</div>
</div>
<div class="paragraph">
<p>This command outputs hosts allocated to <code>My_Organization</code> and <code>My_Location</code>.</p>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-network-boot-to-provision-hosts"><a class="anchor" href="#using-network-boot-to-provision-hosts"></a>8. Using network boot to provision hosts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can provision bare-metal instances with Satellite by using one of the following methods:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Unattended Provisioning</dt>
<dd>
<p>New hosts are identified by a MAC address.
Satellite&#160;Server provisions the host by using a PXE boot process.</p>
</dd>
<dt class="hdlist1">Unattended Provisioning with Discovery</dt>
<dd>
<p>New hosts use PXE boot to load the Satellite Discovery service.
This service identifies hardware information about the host and lists it as an available host to provision.
For more information, see <a href="#discovering-hosts-on-a-network">Discovering hosts on a network</a>.</p>
</dd>
<dt class="hdlist1">PXE-less Provisioning</dt>
<dd>
<p>New hosts are provisioned with a boot disk image that Satellite&#160;Server generates.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<div class="title">BIOS and UEFI support</div>
<p>With Red&#160;Hat Satellite, you can perform both BIOS and UEFI based PXE provisioning.
Both BIOS and UEFI interfaces work as interpreters between the operating system and firmware of a computer, initializing hardware components and starting the operating system at boot time.</p>
</div>
<div class="paragraph">
<div class="title">PXE loaders</div>
<p>In Satellite provisioning, the PXE loader option defines the DHCP <code>filename</code> option to use during provisioning.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For BIOS systems, select the <strong>PXELinux BIOS</strong> option to enable a provisioned host to download the <code>pxelinux.0</code> file over TFTP.</p>
</li>
<li>
<p>For UEFI systems, select the <strong>Grub2 UEFI</strong> option to enable a TFTP client to download <code>grubx64.efi</code> file, or select the <strong>Grub2 UEFI HTTP</strong> option to enable an UEFI HTTP client to download <code>grubx64.efi</code> with the HTTP Boot feature.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By default, you can provision the RHEL version of your Satellite&#160;Server on Secure Boot enabled hosts.
To provision other versions of Red&#160;Hat Enterprise Linux, you have to provide signed shim and GRUB2 binaries of those RHEL versions.
For more information, see <a href="#configuring-capsule-to-provision-rhel-on-Secure-Boot-enabled-hosts">Configuring Capsule to provision Red&#160;Hat Enterprise Linux on Secure Boot enabled hosts</a>.</p>
</div>
<div class="paragraph">
<p>For more information about supported workflows, see <a href="https://access.redhat.com/solutions/2674001">Supported architectures and provisioning scenarios</a>.</p>
</div>
<div class="paragraph">
<div class="title">Bonded network interfaces</div>
<p>You can configure a bonded interface that Satellite will use during the installation process, for example, to download installation content.
After provisioning completes, the provisioned system can also use the bonded interface.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>Satellite cannot PXE boot a bonded interface that requires configuration on a network switch as well as on your host.</p>
</div>
<div class="paragraph">
<p>After your host loads the kernel of an installer or the kernel of an operating system, bonding works as expected.
Therefore, you can use a boot disk to work around PXE boot limitations when your bonded interface requires configuration on both a switch and your host.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="Network_Boot_Provisioning_Workflow_using-netboot"><a class="anchor" href="#Network_Boot_Provisioning_Workflow_using-netboot"></a>8.1. Network boot provisioning workflow</h3>
<div class="paragraph">
<p>The provisioning process follows a basic PXE workflow:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>You create a host and select a domain and subnet.
Satellite requests an available IP address from the DHCP Capsule&#160;Server that is associated with the subnet or from the PostgreSQL database in Satellite.
Satellite loads this IP address into the <strong>IP address</strong> field in the Create Host window.
When you complete all the options for the new host, submit the new host request.</p>
</li>
<li>
<p>Depending on the configuration specifications of the host and its domain and subnet, Satellite creates the following settings:</p>
<div class="ulist">
<ul>
<li>
<p>A DHCP record on Capsule&#160;Server that is associated with the subnet.</p>
</li>
<li>
<p>A forward DNS record on Capsule&#160;Server that is associated with the domain.</p>
</li>
<li>
<p>A reverse DNS record on the DNS Capsule&#160;Server that is associated with the subnet.</p>
</li>
<li>
<p>PXELinux, Grub, Grub2, and iPXE configuration files for the host in the TFTP Capsule&#160;Server that is associated with the subnet.</p>
</li>
<li>
<p>A Puppet certificate on the associated Puppet server.</p>
</li>
<li>
<p>A realm on the associated identity server.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The host is configured to boot from the network as the first device and HDD as the second device.</p>
</li>
<li>
<p>The new host requests a DHCP reservation from the DHCP server.</p>
</li>
<li>
<p>The DHCP server responds to the reservation request and returns TFTP <code>next-server</code> and <code>filename</code> options.</p>
</li>
<li>
<p>The host requests the boot loader and menu from the TFTP server according to the PXELoader setting.</p>
</li>
<li>
<p>A boot loader is returned over TFTP.</p>
</li>
<li>
<p>The boot loader fetches configuration for the host through its provisioning interface MAC address.</p>
</li>
<li>
<p>The boot loader fetches the operating system installer kernel, init RAM disk, and boot parameters.</p>
</li>
<li>
<p>The installer requests the provisioning template from Satellite.</p>
</li>
<li>
<p>Satellite renders the provision template and returns the result to the host.</p>
</li>
<li>
<p>The installer performs installation of the operating system.</p>
<div class="ulist">
<ul>
<li>
<p>The installer registers the host to Satellite by using Subscription Manager.</p>
</li>
<li>
<p>The installer notifies Satellite of a successful build in the <code>postinstall</code> script.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The PXE configuration files revert to a local boot template.</p>
</li>
<li>
<p>The host reboots.</p>
</li>
<li>
<p>The new host requests a DHCP reservation from the DHCP server.</p>
</li>
<li>
<p>The DHCP server responds to the reservation request and returns TFTP <code>next-server</code> and <code>filename</code> options.</p>
</li>
<li>
<p>The host requests the boot loader and menu from the TFTP server according to the PXELoader setting.</p>
</li>
<li>
<p>A boot loader is returned over TFTP.</p>
</li>
<li>
<p>The boot loader fetches the configuration for the host through its provision interface MAC address.</p>
</li>
<li>
<p>The boot loader initiates boot from the local drive.</p>
</li>
<li>
<p>If you configured the host to use Puppet classes, the host uses the modules to configure itself.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The fully provisioned host performs the following workflow:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The host is configured to boot from the network as the first device and HDD as the second device.</p>
</li>
<li>
<p>The new host requests a DHCP reservation from the DHCP server.</p>
</li>
<li>
<p>The DHCP server responds to the reservation request and returns TFTP <code>next-server</code> and <code>filename</code> options.</p>
</li>
<li>
<p>The host requests the boot loader and menu from the TFTP server according to the PXELoader setting.</p>
</li>
<li>
<p>A boot loader is returned over TFTP.</p>
</li>
<li>
<p>The boot loader fetches the configuration settings for the host through its provisioning interface MAC address.</p>
</li>
<li>
<p>For BIOS hosts:</p>
<div class="ulist">
<ul>
<li>
<p>The boot loader returns non-bootable device so BIOS skips to the next device (boot from HDD).</p>
</li>
</ul>
</div>
</li>
<li>
<p>For EFI hosts:</p>
<div class="ulist">
<ul>
<li>
<p>The boot loader finds Grub2 on a ESP partition and chainboots it.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If the host is unknown to Satellite, a default boot loader configuration is provided.
When Discovery service is enabled, it boots into discovery, otherwise it boots from HDD.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This workflow differs depending on custom options.
For example:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Discovery</dt>
<dd>
<p>If you use the discovery service, Satellite automatically detects the MAC address of the new host and restarts the host after you submit a request.
Note that TCP port 8443 must be reachable by the Capsule to which the host is attached for Satellite to restart the host.</p>
</dd>
<dt class="hdlist1">PXE-less Provisioning</dt>
<dd>
<p>After you submit a new host request, you must boot the specific host with the boot disk that you download from Satellite and transfer by using an external storage device.</p>
</dd>
<dt class="hdlist1">Compute Resources</dt>
<dd>
<p>Satellite creates the virtual machine and retrieves the MAC address and stores the MAC address in Satellite.
If you use image-based provisioning, the host does not follow the standard PXE boot and operating system installation.
The compute resource creates a copy of the image for the host to use.
Depending on image settings in Satellite, seed data can be passed in for initial configuration, for example by using <code>cloud-init</code>.
Satellite can connect to the host by using SSH and execute a template to finish the customization.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="prerequisites-for-network-boot-provisioning"><a class="anchor" href="#prerequisites-for-network-boot-provisioning"></a>8.2. Prerequisites for network-boot provisioning</h3>
<div class="paragraph">
<p>The requirements for network-boot provisioning include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Capsule managing the network for the network-booted machines.
For unattended provisioning and discovery-based provisioning, Satellite requires PXE server settings.</p>
<div class="paragraph">
<p>For more information about networking requirements, see <a href="#preparing-networking">Preparing networking</a>.</p>
</div>
<div class="paragraph">
<p>For more information about the Discovery service, see <a href="#discovering-hosts-on-a-network">Discovering hosts on a network</a>.</p>
</div>
</li>
<li>
<p>A bare-metal host or a blank VM.</p>
</li>
<li>
<p>You can use synchronized content repositories for Red&#160;Hat Enterprise Linux.
For more information, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/managing_content/index#Synchronizing_Repositories_content-management">Syncing Repositories</a> in <em>Managing content</em>.</p>
</li>
<li>
<p>Provide an activation key for host registration.
For more information, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/managing_content/index#Creating_an_Activation_Key_content-management">Creating An Activation Key</a> in <em>Managing content</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For information about the security token for unattended and PXE-less provisioning, see <a href="#configuring-the-security-token-validity-duration">Configuring the security token validity duration</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="required-boot-order-for-network-boot_using-netboot"><a class="anchor" href="#required-boot-order-for-network-boot_using-netboot"></a>8.3. Required boot order for network boot</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">For physical or virtual BIOS hosts</dt>
<dd>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Set the first booting device as boot configuration with network.</p>
</li>
<li>
<p>Set the second booting device as boot from hard drive.
Satellite manages TFTP boot configuration files, so hosts can be easily provisioned just by rebooting.</p>
</li>
</ol>
</div>
</dd>
<dt class="hdlist1">For physical or virtual EFI hosts</dt>
<dd>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Set the first booting device as boot configuration with network.</p>
</li>
<li>
<p>Depending on the EFI firmware type and configuration, the operating system installer typically configures the operating system boot loader as the first entry.</p>
</li>
<li>
<p>To reboot into installer again, use the <code>efibootmgr</code> utility to switch back to boot from network.</p>
</li>
</ol>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="configuring-capsule-for-secure-boot"><a class="anchor" href="#configuring-capsule-for-secure-boot"></a>8.4. Configuring Capsule for Secure Boot</h3>
<div class="paragraph">
<p>If you want to provision Secure Boot enabled hosts, configure your Capsule for the provisionable operating system.</p>
</div>
</div>
<div class="sect2">
<h3 id="configuring-capsule-to-provision-rhel-on-Secure-Boot-enabled-hosts"><a class="anchor" href="#configuring-capsule-to-provision-rhel-on-Secure-Boot-enabled-hosts"></a>8.5. Configuring Capsule to provision Red&#160;Hat Enterprise Linux on Secure Boot enabled hosts</h3>
<div class="paragraph">
<p>Secure Boot follows a chain of trust from the start of the host to the loading of Linux kernel modules.
The first shim that is loaded determines which distribution can be booted or loaded by using a <code>kexec</code> system call until the next reboot.</p>
</div>
<div class="paragraph">
<p>To provision Red&#160;Hat Enterprise Linux on Secure Boot enabled hosts with the <strong>Grub2 UEFI SecureBoot</strong> and <strong>Grub2 UEFI HTTPS SecureBoot</strong> PXE loaders, you have to provide signed shim and GRUB2 binaries provided by the vendor of your operating system.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>You have to perform the following configuration steps on each TFTP Capsule for a subnet to provision Secure Boot enabled hosts on that subnet.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Red&#160;Hat Enterprise Linux supports Secure Boot on x86_64 architecture only.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Ensure that the <code>cpio</code> package is installed on your Capsule.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Set the path for the shim and GRUB2 binaries for the operating system of your host:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># BOOTLOADER_PATH="/var/lib/tftpboot/bootloader-universe/pxegrub2/<em>My_Operating_System_In_Lowercase</em>/default/x86_64"</pre>
</div>
</div>
<div class="paragraph">
<p>If you require specific versions of the shim and GRUB2 binaries for the version of the operating system of your host, replace <code>default</code> with the <strong>Major</strong> and <strong>Minor</strong> version of the operating system separated by a dot.
If no <strong>Minor</strong> version is set, replace <code>default</code> with the <strong>Major</strong> version.</p>
</div>
<div class="paragraph">
<p>Red&#160;Hat recommends to not use version-specific shim and GRUB2 binaries unless it is really necessary.</p>
</div>
</li>
<li>
<p>Create the directory to store the shim and GRUB2 binaries for the operating system of your host:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># install -o foreman-proxy -g foreman-proxy -d $BOOTLOADER_PATH</pre>
</div>
</div>
</li>
<li>
<p>Download the shim and GRUB2 packages for the operating system of your host:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># wget -O /tmp/grub2-efi-x64.rpm <em>https://server.example.com/grub2-efi-x64.rpm</em>
# wget -O /tmp/shim-x64.rpm <em>https://server.example.com/shim-x64.rpm</em></pre>
</div>
</div>
<div class="paragraph">
<p>You can download the <code>grub2-efi-x64</code> package from <a href="https://access.redhat.com/downloads/content/package-browser">Package browser</a> on the Red&#160;Hat Customer Portal.
You can download the <code>shim-x64</code> package from <a href="https://access.redhat.com/downloads/content/package-browser">Package browser</a> on the Red&#160;Hat Customer Portal.</p>
</div>
</li>
<li>
<p>Extract the shim and GRUB2 binaries:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># rpm2cpio /tmp/grub2-efi-x64.rpm | cpio -idv --directory /tmp
# rpm2cpio /tmp/shim-x64.rpm | cpio -idv --directory /tmp</pre>
</div>
</div>
</li>
<li>
<p>Make the shim and GRUB2 binaries available for host provisioning:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># cp /tmp/boot/efi/EFI/rhel/grubx64.efi $BOOTLOADER_PATH/grubx64.efi
# cp /tmp/boot/efi/EFI/rhel/shimx64.efi $BOOTLOADER_PATH/shimx64.efi
# ln -sr $BOOTLOADER_PATH/grubx64.efi $BOOTLOADER_PATH/boot.efi
# ln -sr $BOOTLOADER_PATH/shimx64.efi $BOOTLOADER_PATH/boot-sb.efi
# chmod 644 $BOOTLOADER_PATH/grubx64.efi
# chmod 644 $BOOTLOADER_PATH/shimx64.efi</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Verification</div>
<ul>
<li>
<p>Verify the contents of your boot loader directory:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-none" data-lang="none"># tree /var/lib/tftpboot/bootloader-universe
/var/lib/tftpboot/bootloader-universe
└── pxegrub2
    └── <em>My_Operating_System_In_Lowercase</em>
        └── default
            └── x86_64
                ├── boot.efi -&gt; grubx64.efi
                ├── boot-sb.efi -&gt; shimx64.efi
                ├── grubx64.efi
                └── shimx64.efi</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Next steps</div>
<ul>
<li>
<p>You can now provision Secure Boot enabled Red&#160;Hat Enterprise Linux hosts by using the <strong>Grub2 UEFI SecureBoot</strong> and <strong>Grub2 UEFI HTTPS SecureBoot</strong> PXE loaders.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="creating-hosts-with-pxe-boot-provisioning"><a class="anchor" href="#creating-hosts-with-pxe-boot-provisioning"></a>8.6. Creating hosts with PXE boot provisioning</h3>
<div class="paragraph">
<p>Unattended provisioning is the simplest form of host provisioning.
You enter the host details on Satellite&#160;Server and boot your host.
Satellite&#160;Server automatically manages the PXE configuration, organizes networking services, and provides the operating system and configuration for the host.</p>
</div>
<div class="paragraph">
<p>This method of provisioning hosts uses minimal interaction during the process.</p>
</div>
<div class="paragraph">
<p>To use the CLI instead of the Satellite web UI, see the <a href="#cli-creating-hosts-with-pxe-boot-provisioning">CLI procedure</a>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Create Host</strong>.</p>
</li>
<li>
<p>In the <strong>Name</strong> field, enter a name for the host.</p>
</li>
<li>
<p>Optional: Click the <strong>Organization</strong> tab and change the organization context to match your requirement.</p>
</li>
<li>
<p>Optional: Click the <strong>Location</strong> tab and change the location context to match your requirement.</p>
</li>
<li>
<p>From the <strong>Host Group</strong> list, select a host group that you want to assign your host to.
That host group will populate the form.</p>
</li>
<li>
<p>Click the <strong>Interfaces</strong> tab, and on the interface of the host, click <strong>Edit</strong>.</p>
</li>
<li>
<p>Verify that the fields are populated with values.
Note in particular:</p>
<div class="ulist">
<ul>
<li>
<p>Satellite automatically assigns an IP address for the new host.</p>
</li>
<li>
<p>In the <strong>MAC address</strong> field, enter a MAC address of the provisioning interface of the host.
This ensures the identification of the host during the PXE boot process.</p>
</li>
<li>
<p>The <strong>Name</strong> from the <strong>Host</strong> tab becomes the <strong>DNS name</strong>.</p>
</li>
<li>
<p>Ensure that Satellite automatically selects the <strong>Managed</strong>, <strong>Primary</strong>, and <strong>Provision</strong> options for the first interface on the host.
If not, select them.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>OK</strong> to save.
To add another interface, click <strong>Add Interface</strong>.
You can select only one interface for <strong>Provision</strong> and <strong>Primary</strong>.</p>
</li>
<li>
<p>Click the <strong>Operating System</strong> tab, and verify that all fields contain values.
Confirm each aspect of the operating system.</p>
</li>
<li>
<p>Optional: Click <strong>Resolve</strong> in <strong>Provisioning template</strong> to check the new host can identify the right provisioning templates to use.</p>
<div class="paragraph">
<p>For more information about associating provisioning templates, see <a href="#provisioning-templates">Provisioning templates</a>.</p>
</div>
</li>
<li>
<p>Click the <strong>Parameters</strong> tab, and ensure that a parameter exists that provides an activation key.
If not, add an activation key.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save the host details.</p>
<div class="paragraph">
<p>For more information about network interfaces, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/managing_hosts/index#configuring-network-interfaces">Configuring network interfaces</a> in <em>Managing hosts</em>.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>This creates the host entry and the relevant provisioning settings.
This also includes creating the necessary directories and files for PXE booting the bare-metal host.
If you start the physical host and set its boot mode to PXE, the host detects the DHCP service of Satellite&#160;Server&#8217;s integrated Capsule, receives HTTP endpoint of the Kickstart tree and installs the operating system.</p>
</div>
<div class="paragraph">
<p>When the installation completes, the host also registers to Satellite&#160;Server using the activation key and installs the necessary configuration and management tools from the Red Hat Satellite Client 6 repository.</p>
</div>
<div id="cli-creating-hosts-with-pxe-boot-provisioning" class="olist arabic">
<div class="title">CLI procedure</div>
<ol class="arabic">
<li>
<p>Create the host with the <code>hammer host create</code> command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer host create \
--build true \
--enabled true \
--hostgroup "<em>My_Host_Group</em>" \
--location "<em>My_Location</em>" \
--mac "<em>My_MAC_Address</em>" \
--managed true \
--name "<em>My_Host_Name</em>" \
--organization "<em>My_Organization</em>"</pre>
</div>
</div>
</li>
<li>
<p>Configure the network interface:</p>
<div class="listingblock">
<div class="content">
<pre>$ hammer host interface update \
--host "_My_Host_Name_" \
--managed true \
--primary true \
--provision true</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="creating-hosts-with-uefi-http-boot-provisioning"><a class="anchor" href="#creating-hosts-with-uefi-http-boot-provisioning"></a>8.7. Creating hosts with UEFI HTTP boot provisioning</h3>
<div class="paragraph">
<p>You can provision hosts from Satellite using the UEFI HTTP Boot.</p>
</div>
<div class="paragraph">
<p>To use the CLI instead of the Satellite web UI, see the <a href="#cli-creating-hosts-with-uefi-http-boot-provisioning_using-netboot">CLI procedure</a>.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Ensure that you meet the requirements for HTTP booting.
For more information, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/overview_concepts_and_deployment_considerations/index#http-booting-requirements">HTTP Booting Requirements</a> in <em>Overview, concepts, and deployment considerations</em>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Enable <code>foreman-proxy-http</code>, <code>foreman-proxy-httpboot</code>, and <code>foreman-proxy-tftp</code> features.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-installer \
--foreman-proxy-http true \
--foreman-proxy-httpboot true \
--foreman-proxy-tftp true</pre>
</div>
</div>
</li>
<li>
<p>Ensure that the Capsule has TFTP and HTTPBoot features recognized.
In the Satellite web UI, navigate to <strong>Infrastructure</strong> &gt; <strong>Capsules</strong> and click on Capsule to see the list of recognized features.
Click <strong>Refresh Features</strong> if any of the features are missing.</p>
</li>
<li>
<p>Ensure that Capsule is associated with the provisioning subnet.
In the Satellite web UI, navigate to <strong>Infrastructure</strong> &gt; <strong>Subnets</strong> &gt; <strong>Edit Subnet</strong> &gt; <strong>Capsules</strong> and select the Capsule for both <strong>TFTP</strong> and <strong>HTTPBoot</strong> options.</p>
</li>
<li>
<p>Click <strong>OK</strong> to save.</p>
</li>
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Create Host</strong>.</p>
</li>
<li>
<p>In the <strong>Name</strong> field, enter a name for the host.</p>
</li>
<li>
<p>Optional: Click the <strong>Organization</strong> tab and change the organization context to match your requirement.</p>
</li>
<li>
<p>Optional: Click the <strong>Location</strong> tab and change the location context to match your requirement.</p>
</li>
<li>
<p>From the <strong>Host Group</strong> list, select a host group that you want to assign your host to.
That host group will populate the form.</p>
</li>
<li>
<p>Click the <strong>Interfaces</strong> tab, and on the interface of the host, click <strong>Edit</strong>.</p>
</li>
<li>
<p>Verify that the fields are populated with values.
Note in particular:</p>
<div class="ulist">
<ul>
<li>
<p>Satellite automatically assigns an IP address for the new host.</p>
</li>
<li>
<p>In the <strong>MAC address</strong> field, enter a MAC address of the provisioning interface of the host.
This ensures the identification of the host during the PXE boot process.</p>
</li>
<li>
<p>The <strong>Name</strong> from the <strong>Host</strong> tab becomes the <strong>DNS name</strong>.</p>
</li>
<li>
<p>Ensure that Satellite automatically selects the <strong>Managed</strong>, <strong>Primary</strong>, and <strong>Provision</strong> options for the first interface on the host.
If not, select them.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>OK</strong> to save.
To add another interface, click <strong>Add Interface</strong>.
You can select only one interface for <strong>Provision</strong> and <strong>Primary</strong>.</p>
</li>
<li>
<p>Click the <strong>Operating System</strong> tab, and verify that all fields contain values.
Confirm each aspect of the operating system.</p>
</li>
<li>
<p>From the <strong>PXE Loader</strong> list, select <strong>Grub2 UEFI HTTP</strong>.</p>
</li>
<li>
<p>Optional: Click <strong>Resolve</strong> in <strong>Provisioning template</strong> to check the new host can identify the right provisioning templates to use.</p>
<div class="paragraph">
<p>For more information about associating provisioning templates, see <a href="#creating-provisioning-templates">Creating provisioning templates</a>.</p>
</div>
</li>
<li>
<p>Click the <strong>Parameters</strong> tab, and ensure that a parameter exists that provides an activation key.
If not, add an activation key.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save the host details.</p>
<div class="paragraph">
<p>For more information about network interfaces, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/managing_hosts/index#configuring-network-interfaces">Configuring network interfaces</a> in <em>Managing hosts</em>.</p>
</div>
</li>
<li>
<p>Set the host to boot in UEFI mode from network.</p>
</li>
<li>
<p>Start the host.</p>
</li>
<li>
<p>From the boot menu, select <strong>Kickstart default PXEGrub2</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This creates the host entry and the relevant provisioning settings.
This also includes creating the necessary directories and files for UEFI booting the bare-metal host.
When you start the physical host and set its boot mode to UEFI HTTP, the host detects the defined DHCP service, receives HTTP endpoint of Capsule with the Kickstart tree and installs the operating system.</p>
</div>
<div class="paragraph">
<p>When the installation completes, the host also registers to Satellite&#160;Server using the activation key and installs the necessary configuration and management tools from the Red Hat Satellite Client 6 repository.</p>
</div>
<div id="cli-creating-hosts-with-uefi-http-boot-provisioning_using-netboot" class="olist arabic">
<div class="title">CLI procedure</div>
<ol class="arabic">
<li>
<p>Enable <code>foreman-proxy-http</code>, <code>foreman-proxy-httpboot</code>, and <code>foreman-proxy-tftp true</code> features:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-installer \
--foreman-proxy-http true \
--foreman-proxy-httpboot true \
--foreman-proxy-tftp true</pre>
</div>
</div>
</li>
<li>
<p>Create the host with the <code>hammer host create</code> command.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer host create \
--build true \
--enabled true \
--hostgroup "<em>My_Host_Group</em>" \
--location "<em>My_Location</em>" \
--mac "<em>My_MAC_Address</em>" \
--managed true \
--name "<em>My_Host_Name</em>" \
--organization "<em>My_Organization</em>" \
--pxe-loader "Grub2 UEFI HTTP"</pre>
</div>
</div>
</li>
<li>
<p>Ensure the network interface options are set using the <code>hammer host interface update</code> command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer host interface update \
--host "<em>My_Host_Name</em>" \
--managed true \
--primary true \
--provision true</pre>
</div>
</div>
</li>
<li>
<p>Set the host to boot in UEFI mode from network.</p>
</li>
<li>
<p>Start the host.</p>
</li>
<li>
<p>From the boot menu, select <strong>Kickstart default PXEGrub2</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This creates the host entry and the relevant provisioning settings.
This also includes creating the necessary directories and files for UEFI booting the bare-metal host.
When you start the physical host and set its boot mode to UEFI HTTP, the host detects the defined DHCP service, receives HTTP endpoint of Capsule with the Kickstart tree and installs the operating system.</p>
</div>
<div class="paragraph">
<p>When the installation completes, the host also registers to Satellite&#160;Server using the activation key and installs the necessary configuration and management tools from the Red Hat Satellite Client 6 repository.</p>
</div>
</div>
<div class="sect2">
<h3 id="Deploying_SSH_Keys_During_Provisioning_using-netboot"><a class="anchor" href="#Deploying_SSH_Keys_During_Provisioning_using-netboot"></a>8.8. Deploying SSH keys during provisioning</h3>
<div class="paragraph">
<p>Use this procedure to deploy SSH keys added to a user during provisioning.
For information on adding SSH keys to a user, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/administering_red_hat_satellite/index#Managing_SSH_Keys_for_a_User_admin">Managing SSH Keys for a User</a> in <em>Administering Red&#160;Hat Satellite</em>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Provisioning Templates</strong>.</p>
</li>
<li>
<p>Create a provisioning template, or clone and edit an existing template.
For more information, see <a href="#creating-provisioning-templates">Creating provisioning templates</a>.</p>
</li>
<li>
<p>In the template, click the <strong>Template</strong> tab.</p>
</li>
<li>
<p>In the <strong>Template editor</strong> field, add the <code>create_users</code> snippet to the <code>%post</code> section:</p>
<div class="listingblock">
<div class="content">
<pre>&lt;%= snippet('create_users') %&gt;</pre>
</div>
</div>
</li>
<li>
<p>Select the <strong>Default</strong> checkbox.</p>
</li>
<li>
<p>Click the <strong>Association</strong> tab.</p>
</li>
<li>
<p>From the <strong>Application Operating Systems</strong> list, select an operating system.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save the provisioning template.</p>
</li>
<li>
<p>Create a host that is associated with the provisioning template or rebuild a host using the operating system associated with the modified template.
For more information, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/managing_hosts/index#Creating_a_Host_managing-hosts">Creating a Host</a> in <em>Managing hosts</em>.</p>
<div class="paragraph">
<p>The SSH keys of the <strong>Owned by</strong> user are added automatically when the <code>create_users</code> snippet is executed during the provisioning process.
You can set <strong>Owned by</strong> to an individual user or a user group.
If you set <strong>Owned by</strong> to a user group, the SSH keys of all users in the user group are added automatically.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="using-ipxe-to-reduce-provisioning-times_using-netboot"><a class="anchor" href="#using-ipxe-to-reduce-provisioning-times_using-netboot"></a>8.9. Using iPXE to reduce provisioning times</h3>
<div class="paragraph">
<p>iPXE is an open-source network-boot firmware.
It provides a full PXE implementation enhanced with additional features, such as booting from an HTTP server.
For more information about iPXE, see <a href="https://ipxe.org">iPXE website</a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>The iPXE network boot is <strong>deprecated</strong> and will be removed in a future release.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can use iPXE if the following restrictions prevent you from using PXE:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A network with unmanaged DHCP servers.</p>
</li>
<li>
<p>A PXE service that is unreachable because of, for example, a firewall restriction.</p>
</li>
<li>
<p>A TFTP UDP-based protocol that is unreliable because of, for example, a low-bandwidth network.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="prerequisites-for-using-ipxe_using-netboot"><a class="anchor" href="#prerequisites-for-using-ipxe_using-netboot"></a>8.9.1. Prerequisites for using iPXE</h4>
<div class="paragraph">
<p>You can use iPXE to boot virtual machines in the following cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Your virtual machines run on a hypervisor that uses iPXE as primary firmware.</p>
</li>
<li>
<p>Your virtual machines are in BIOS mode.
In this case, you can configure PXELinux to chainboot iPXE and boot by using the HTTP protocol.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For booting virtual machines in UEFI mode by using HTTP, you can follow <a href="#creating-hosts-with-uefi-http-boot-provisioning">Creating hosts with UEFI HTTP boot provisioning</a> instead.</p>
</div>
<div class="paragraph">
<div class="title">Supportability</div>
<p>Red&#160;Hat does not officially support iPXE in Red&#160;Hat Satellite.
For more information, see <a href="https://access.redhat.com/solutions/2674001">Supported architectures and kickstart scenarios in Satellite 6</a> in the <em>Red&#160;Hat Knowledgebase</em>.</p>
</div>
<div class="ulist">
<div class="title">Host requirements</div>
<ul>
<li>
<p>The MAC address of the provisioning interface matches the host configuration.</p>
</li>
<li>
<p>The provisioning interface of the host has a valid DHCP reservation.</p>
</li>
<li>
<p>The NIC is capable of PXE booting.
For more information, see <a href="https://ipxe.org/appnote/hardware_drivers">supported hardware on ipxe.org</a> for a list of hardware drivers expected to work with an iPXE-based boot disk.</p>
</li>
<li>
<p>The NIC is compatible with iPXE.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="Configuring_iPXE_Environment_using-netboot"><a class="anchor" href="#Configuring_iPXE_Environment_using-netboot"></a>8.9.2. Configuring iPXE environment</h4>
<div class="paragraph">
<p>Configure an iPXE environment on all Capsules that you want to use for iPXE provisioning.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>In Red&#160;Hat Enterprise Linux, security-related features of iPXE are not supported and the iPXE binary is built without security features.
For this reason, you can only use HTTP but not HTTPS.
For more information, see <a href="https://access.redhat.com/solutions/3483601">Red&#160;Hat Enterprise Linux HTTPS support in iPXE</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>If you want to use Capsule&#160;Servers instead of your Satellite&#160;Server, ensure that you have configured your Capsule&#160;Servers accordingly.
For more information, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/installing_capsule_server/index#configuring-capsule-for-host-registration-and-provisioning_capsule">Configuring Capsule for Host Registration and Provisioning</a> in <em>Installing Capsule Server</em>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Enable the <strong>TFTP</strong> and <strong>HTTPboot</strong> services on your Capsule:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-installer \
--foreman-proxy-httpboot true \
--foreman-proxy-tftp true</pre>
</div>
</div>
</li>
<li>
<p>Install the <code>ipxe-bootimgs</code> package on your Capsule:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain packages install ipxe-bootimgs</pre>
</div>
</div>
</li>
<li>
<p>Copy iPXE firmware to the TFTP directory.</p>
<div class="ulist">
<ul>
<li>
<p>Copy the iPXE firmware with the Linux kernel header:</p>
<div class="listingblock">
<div class="content">
<pre># cp /usr/share/ipxe/ipxe.lkrn /var/lib/tftpboot/</pre>
</div>
</div>
</li>
<li>
<p>Copy the UNDI iPXE firmware:</p>
<div class="listingblock">
<div class="content">
<pre># cp /usr/share/ipxe/undionly.kpxe /var/lib/tftpboot/undionly-ipxe.0</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Correct the SELinux file contexts:</p>
<div class="listingblock">
<div class="content">
<pre># restorecon -RvF /var/lib/tftpboot/</pre>
</div>
</div>
</li>
<li>
<p>Set the HTTP URL.</p>
<div class="ulist">
<ul>
<li>
<p>If you want to use Satellite&#160;Server for booting, run the following command on Satellite&#160;Server:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-installer \
--foreman-proxy-dhcp-ipxefilename "http://<em>satellite.example.com</em>/unattended/iPXE?bootstrap=1"</pre>
</div>
</div>
</li>
<li>
<p>If you want to use Capsule&#160;Server for booting, run the following command on Capsule&#160;Server:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-installer --foreman-proxy-dhcp-ipxe-bootstrap true</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Booting_Virtual_Machines_using-netboot"><a class="anchor" href="#Booting_Virtual_Machines_using-netboot"></a>8.9.3. Booting virtual machines</h4>
<div class="paragraph">
<p>Some virtualization hypervisors use iPXE as primary firmware for PXE booting.
If you use such a hypervisor, you can boot virtual machines without TFTP and PXELinux.</p>
</div>
<div class="paragraph">
<p>Booting a virtual machine has the following workflow:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Virtual machine starts.</p>
</li>
<li>
<p>iPXE retrieves the network credentials, including an HTTP URL, by using DHCP.</p>
</li>
<li>
<p>iPXE loads the iPXE bootstrap template from Capsule.</p>
</li>
<li>
<p>iPXE loads the iPXE template with MAC as a URL parameter from Capsule.</p>
</li>
<li>
<p>iPXE loads the kernel and initial RAM disk of the installer.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Your hypervisor must support iPXE.
The following virtualization hypervisors support iPXE:</p>
<div class="ulist">
<ul>
<li>
<p>libvirt</p>
</li>
<li>
<p>Red&#160;Hat&#160;Virtualization (deprecated)</p>
</li>
</ul>
</div>
</li>
<li>
<p>You have configured your iPXE environment.
For more information, see <a href="#Configuring_iPXE_Environment_using-netboot">Configuring iPXE environment</a>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>You can use the original templates shipped in Satellite as described below.
If you require modification to an original template, clone the template, edit the clone, and associate the clone instead of the original template.
For more information, see <a href="#cloning-provisioning-templates">Cloning provisioning templates</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Provisioning Templates</strong>.</p>
</li>
<li>
<p>Search for the <code>Kickstart default iPXE</code> template.</p>
</li>
<li>
<p>Click the name of the template.</p>
</li>
<li>
<p>Click the <strong>Association</strong> tab and select the operating systems that your host uses.</p>
</li>
<li>
<p>Click the <strong>Locations</strong> tab and add the location where the host resides.</p>
</li>
<li>
<p>Click the <strong>Organizations</strong> tab and add the organization that the host belongs to.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save the changes.</p>
</li>
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Operating systems</strong> and select the operating system of your host.</p>
</li>
<li>
<p>Click the <strong>Templates</strong> tab.</p>
</li>
<li>
<p>From the <strong>iPXE template</strong> list, select the <code>Kickstart default iPXE</code> template.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save the changes.</p>
</li>
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>All Hosts</strong>.</p>
</li>
<li>
<p>In the <strong>Hosts</strong> page, select the host that you want to use.</p>
</li>
<li>
<p>Select the <strong>Operating System</strong> tab.</p>
</li>
<li>
<p>Set <strong>PXE Loader</strong> to <code>iPXE Embedded</code>.</p>
</li>
<li>
<p>Select the <strong>Templates</strong> tab.</p>
</li>
<li>
<p>In <strong>Provisioning Templates</strong>, click <strong>Resolve</strong> and verify that the <strong>iPXE template</strong> resolves to the required template.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save host settings.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Chainbooting_iPXE_from_PXELinux_using-netboot"><a class="anchor" href="#Chainbooting_iPXE_from_PXELinux_using-netboot"></a>8.9.4. Chainbooting iPXE from PXELinux</h4>
<div class="paragraph">
<p>You can set up iPXE to use a built-in driver for network communication (<code>ipxe.lkrn</code>) or Universal Network Device Interface (UNDI) (<code>undionly-ipxe.0</code>).
You can choose to load either file depending on the networking hardware capabilities and iPXE driver availability.</p>
</div>
<div class="paragraph">
<p>UNDI is a minimalistic UDP/IP stack that implements TFTP client.
However, UNDI cannot support other protocols like HTTP.
To use HTTP with iPXE, use the iPXE build with built-in drivers (<code>ipxe.lkrn</code>).</p>
</div>
<div class="paragraph">
<p>Chainbooting iPXE has the following workflow:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Host powers on.</p>
</li>
<li>
<p>PXE driver retrieves the network credentials by using DHCP.</p>
</li>
<li>
<p>PXE driver retrieves the PXELinux firmware <code>pxelinux.0</code> by using TFTP.</p>
</li>
<li>
<p>PXELinux searches for the configuration file on the TFTP server.</p>
</li>
<li>
<p>PXELinux chainloads iPXE <code>ipxe.lkrn</code> or <code>undionly-ipxe.0</code>.</p>
</li>
<li>
<p>iPXE retrieves the network credentials, including an HTTP URL, by using DHCP again.</p>
</li>
<li>
<p>iPXE chainloads the iPXE template from your Templates Capsule.</p>
</li>
<li>
<p>iPXE loads the kernel and initial RAM disk of the installer.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have configured your iPXE environment.
For more information, see <a href="#Configuring_iPXE_Environment_using-netboot">Configuring iPXE environment</a>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>You can use the original templates shipped in Satellite as described below.
If you require modification to an original template, clone the template, edit the clone, and associate the clone instead of the original template.
For more information, see <a href="#cloning-provisioning-templates">Cloning provisioning templates</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Provisioning Templates</strong>.</p>
</li>
<li>
<p>Search for the required PXELinux template:</p>
<div class="ulist">
<ul>
<li>
<p><code>PXELinux chain iPXE</code> to use <code>ipxe.lkrn</code></p>
</li>
<li>
<p><code>PXELinux chain iPXE UNDI</code> to use <code>undionly-ipxe.0</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Click the name of the template you want to use.</p>
</li>
<li>
<p>Click the <strong>Association</strong> tab and select the operating systems that your host uses.</p>
</li>
<li>
<p>Click the <strong>Locations</strong> tab and add the location where the host resides.</p>
</li>
<li>
<p>Click the <strong>Organizations</strong> tab and add the organization that the host belongs to.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save the changes.</p>
</li>
<li>
<p>On the <strong>Provisioning Templates</strong> page, search for the <code>Kickstart default iPXE</code> template.</p>
</li>
<li>
<p>Click the name of the template.</p>
</li>
<li>
<p>Click the <strong>Association</strong> tab and associate the template with the operating system that your host uses.</p>
</li>
<li>
<p>Click the <strong>Locations</strong> tab and add the location where the host resides.</p>
</li>
<li>
<p>Click the <strong>Organizations</strong> tab and add the organization that the host belongs to.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save the changes.</p>
</li>
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Operating systems</strong> and select the operating system of your host.</p>
</li>
<li>
<p>Click the <strong>Templates</strong> tab.</p>
</li>
<li>
<p>From the <strong>PXELinux template</strong> list, select the template you want to use.</p>
</li>
<li>
<p>From the <strong>iPXE template</strong> list, select the <code>Kickstart default iPXE</code> template.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save the changes.</p>
</li>
<li>
<p>In the Satellite web UI, navigate to <strong>Configure</strong> &gt; <strong>Host Groups</strong>, and select the host group you want to configure.</p>
</li>
<li>
<p>Select the <strong>Operating System</strong> tab.</p>
</li>
<li>
<p>Select the <strong>Architecture</strong> and <strong>Operating system</strong>.</p>
</li>
<li>
<p>Set the <strong>PXE Loader</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Select <code>PXELinux BIOS</code> to chainboot iPXE (<code>ipxe.lkrn</code>) from PXELinux.</p>
</li>
<li>
<p>Select <code>iPXE Chain BIOS</code> to load <code>undionly-ipxe.0</code> directly.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-boot-disks-to-provision-hosts"><a class="anchor" href="#using-boot-disks-to-provision-hosts"></a>9. Using boot disks to provision hosts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can use boot disks to boot hosts without PXE firmware.</p>
</div>
<div class="sect2">
<h3 id="Creating_Hosts_with_PXE_less_Provisioning_using-bootdisks"><a class="anchor" href="#Creating_Hosts_with_PXE_less_Provisioning_using-bootdisks"></a>9.1. Creating hosts with PXE-less provisioning</h3>
<div class="paragraph">
<p>Some hardware does not provide a PXE boot interface.
In Satellite, you can provision a host without PXE boot.
This is also known as PXE-less provisioning and involves generating a boot ISO that hosts can use.
Using this ISO, the host can connect to Satellite&#160;Server, boot the installation media, and install the operating system.</p>
</div>
<div class="paragraph">
<p>Satellite also provides a PXE-less discovery service that operates without PXE-based services, such as DHCP and TFTP.
For more information, see <a href="#discovery-in-pxeless-mode">Discovery in PXE-less mode</a>.</p>
</div>
<div class="paragraph">
<div class="title">Boot ISO types</div>
<p>There are the following types of boot ISOs:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Full host image</dt>
<dd>
<p>A boot ISO that contains the kernel and initial RAM disk image for the specific host.
This image is useful if the host fails to chainload correctly.
The provisioning template still downloads from Satellite&#160;Server.</p>
</dd>
<dt class="hdlist1">Subnet image</dt>
<dd>
<p>A boot ISO that is not associated with a specific host.
The ISO sends the host&#8217;s MAC address to Capsule&#160;Server, which matches it against the host entry.
The image does not store IP address details and requires access to a DHCP server on the network to bootstrap.
This image is generic to all hosts with a provisioning NIC on the same subnet.
The image is based on iPXE boot firmware, only a limited number of network cards is supported.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The <strong>Full host image</strong> is based on SYSLINUX and Grub and works with most network cards.
When using a <strong>Subnet image</strong>,
see <a href="https://ipxe.org/appnote/hardware_drivers">supported hardware on ipxe.org</a> for a list of network card drivers expected to work with an iPXE-based boot disk.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Full host image</strong> contains a provisioning token, therefore the generated image has limited lifespan.
For more information about configuring security tokens, read <a href="#configuring-the-security-token-validity-duration">Configuring the security token validity duration</a>.</p>
</div>
<div class="paragraph">
<p>To use the CLI instead of the Satellite web UI, see the <a href="#cli-creating-hosts-with-pxe-less-provisioning_using-bootdisks">CLI procedure</a>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Create Host</strong>.</p>
</li>
<li>
<p>In the <strong>Name</strong> field, enter a name for the host.</p>
</li>
<li>
<p>Optional: Click the <strong>Organization</strong> tab and change the organization context to match your requirement.</p>
</li>
<li>
<p>Optional: Click the <strong>Location</strong> tab and change the location context to match your requirement.</p>
</li>
<li>
<p>From the <strong>Host Group</strong> list, select a host group that you want to assign your host to.
That host group will populate the form.</p>
</li>
<li>
<p>Click the <strong>Interfaces</strong> tab, and on the interface of the host, click <strong>Edit</strong>.</p>
</li>
<li>
<p>Verify that the fields are populated with values.
Note in particular:</p>
<div class="ulist">
<ul>
<li>
<p>Satellite automatically assigns an IP address for the new host.</p>
</li>
<li>
<p>The <strong>Name</strong> from the <strong>Host</strong> tab becomes the <strong>DNS name</strong>.</p>
</li>
<li>
<p>Ensure that Satellite automatically selects the <strong>Managed</strong>, <strong>Primary</strong>, and <strong>Provision</strong> options for the first interface on the host.
If not, select them.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>OK</strong> to save.
To add another interface, click <strong>Add Interface</strong>.
You can select only one interface for <strong>Provision</strong> and <strong>Primary</strong>.</p>
</li>
<li>
<p>Click the <strong>Operating System</strong> tab, and verify that all fields contain values.
Confirm each aspect of the operating system.</p>
</li>
<li>
<p>Click <strong>Resolve</strong> in <strong>Provisioning Templates</strong> to check the new host can identify the right provisioning templates to use.</p>
<div class="paragraph">
<p>For more information about associating provisioning templates, see <a href="#provisioning-templates">Provisioning templates</a>.</p>
</div>
</li>
<li>
<p>Click the <strong>Parameters</strong> tab, and ensure that a parameter exists that provides an activation key.
If not, add an activation key.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save the host details.
This creates a host entry and the host details page appears.</p>
</li>
<li>
<p>Download the boot disk from Satellite&#160;Server.</p>
<div class="ulist">
<ul>
<li>
<p>For <strong>Full host image</strong>, on the host details page, click the vertical ellipsis and select <strong>Full host '<em>My_Host_Name</em>' image</strong>.</p>
</li>
<li>
<p>For <strong>Subnet image</strong>, navigate to <strong>Infrastructure</strong> &gt; <strong>Subnets</strong>, click the dropdown menu in the <strong>Actions</strong> column of the required subnet and select <strong>Subnet generic image</strong>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Write the ISO to a USB storage device using the <code>dd</code> utility or <code>livecd-tools</code> if required.</p>
</li>
<li>
<p>When you start the host and boot from the ISO or the USB storage device, the host connects to Satellite&#160;Server and starts installing operating system from its Kickstart tree.</p>
<div class="paragraph">
<p>When the installation completes, the host also registers to Satellite&#160;Server using the activation key and installs the necessary configuration and management tools from the <strong>Red Hat Satellite Client 6</strong> repository.</p>
</div>
</li>
</ol>
</div>
<div id="cli-creating-hosts-with-pxe-less-provisioning_using-bootdisks" class="olist arabic">
<div class="title">CLI procedure</div>
<ol class="arabic">
<li>
<p>Create the host using the <code>hammer host create</code> command.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer host create \
--build true \
--enabled true \
--hostgroup "<em>My_Host_Group</em>" \
--location "<em>My_Location</em>" \
--mac "<em>My_MAC_Address</em>" \
--managed true \
--name "<em>My_Host_Name</em>" \
--organization "<em>My_Organization</em>"</pre>
</div>
</div>
</li>
<li>
<p>Ensure that your network interface options are set using the <code>hammer host interface update</code> command.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer host interface update \
--host "<em>My_Host_Name</em>" \
--managed true \
--primary true \
--provision true</pre>
</div>
</div>
</li>
<li>
<p>Download the boot disk from Satellite&#160;Server using the <code>hammer bootdisk</code> command:</p>
<div class="ulist">
<ul>
<li>
<p>For <strong>Full host image</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer bootdisk host \
--full true \
--host <em>My_Host_Name</em></pre>
</div>
</div>
</li>
<li>
<p>For <strong>Subnet image</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer bootdisk subnet --subnet <em>My_Subnet_Name</em></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This creates a boot ISO for your host to use.</p>
</div>
</li>
<li>
<p>Write the ISO to a USB storage device using the <code>dd</code> utility or <code>livecd-tools</code> if required.</p>
</li>
<li>
<p>When you start the physical host and boot from the ISO or the USB storage device, the host connects to Satellite&#160;Server and starts installing operating system from its Kickstart tree.</p>
<div class="paragraph">
<p>When the installation completes, the host also registers to Satellite&#160;Server using the activation key and installs the necessary configuration and management tools from the <strong>Red Hat Satellite Client 6</strong> repository.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Deploying_SSH_Keys_During_Provisioning_using-bootdisks"><a class="anchor" href="#Deploying_SSH_Keys_During_Provisioning_using-bootdisks"></a>9.2. Deploying SSH keys during provisioning</h3>
<div class="paragraph">
<p>Use this procedure to deploy SSH keys added to a user during provisioning.
For information on adding SSH keys to a user, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/administering_red_hat_satellite/index#Managing_SSH_Keys_for_a_User_admin">Managing SSH Keys for a User</a> in <em>Administering Red&#160;Hat Satellite</em>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Provisioning Templates</strong>.</p>
</li>
<li>
<p>Create a provisioning template, or clone and edit an existing template.
For more information, see <a href="#creating-provisioning-templates">Creating provisioning templates</a>.</p>
</li>
<li>
<p>In the template, click the <strong>Template</strong> tab.</p>
</li>
<li>
<p>In the <strong>Template editor</strong> field, add the <code>create_users</code> snippet to the <code>%post</code> section:</p>
<div class="listingblock">
<div class="content">
<pre>&lt;%= snippet('create_users') %&gt;</pre>
</div>
</div>
</li>
<li>
<p>Select the <strong>Default</strong> checkbox.</p>
</li>
<li>
<p>Click the <strong>Association</strong> tab.</p>
</li>
<li>
<p>From the <strong>Application Operating Systems</strong> list, select an operating system.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save the provisioning template.</p>
</li>
<li>
<p>Create a host that is associated with the provisioning template or rebuild a host using the operating system associated with the modified template.
For more information, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/managing_hosts/index#Creating_a_Host_managing-hosts">Creating a Host</a> in <em>Managing hosts</em>.</p>
<div class="paragraph">
<p>The SSH keys of the <strong>Owned by</strong> user are added automatically when the <code>create_users</code> snippet is executed during the provisioning process.
You can set <strong>Owned by</strong> to an individual user or a user group.
If you set <strong>Owned by</strong> to a user group, the SSH keys of all users in the user group are added automatically.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="discovering-hosts-on-a-network"><a class="anchor" href="#discovering-hosts-on-a-network"></a>10. Discovering hosts on a network</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a id="Configuring_the_Discovery_Service_provisioning-installer"></a></p>
</div>
<div class="paragraph">
<p>Red&#160;Hat Satellite can detect hosts on a network that are not in your Satellite inventory.
These hosts boot the Discovery image that performs hardware detection and relays this information back to Satellite&#160;Server.
This method creates a list of ready-to-provision hosts in Satellite&#160;Server without needing to enter the MAC address of each host.</p>
</div>
<div class="sect2">
<h3 id="prerequisites-for-using-discovery_provisioning-installer"><a class="anchor" href="#prerequisites-for-using-discovery_provisioning-installer"></a>10.1. Prerequisites for using Discovery</h3>
<div class="ulist">
<ul>
<li>
<p>Ensure that the DHCP range of all subnets that you plan to use for Discovery does not overlap with the DHCP lease pool configured for the managed DHCP service.
The DHCP range is set in the Satellite web UI, whereas the lease pool range is set by using the <code>satellite-installer</code> command.</p>
<div class="paragraph">
<p>For example, in the 10.1.0.0/16 network range, you can allocate the following IP address blocks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>10.1.0.0 to 10.1.127.255 for leases.</p>
</li>
<li>
<p>10.1.128.0 to 10.1.255.254 for reservations.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Ensure the host or virtual machine being discovered has at least 1200 MB of memory.
Insufficient memory can cause various random kernel panic errors because the Discovery image is extracted in memory.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Installing_the_Discovery_Service_provisioning-installer"><a class="anchor" href="#Installing_the_Discovery_Service_provisioning-installer"></a>10.2. Installing the Discovery service</h3>
<div class="paragraph">
<p>The Discovery service is enabled by default on Satellite&#160;Server.
Additionally, you can enable the Discovery service on any Capsule&#160;Servers that provide the TFTP service.</p>
</div>
<div class="paragraph">
<p>The Discovery service requires a Discovery image, which is provided with Red&#160;Hat Satellite.
The Discovery image uses a minimal operating system that is booted on hosts to acquire initial hardware information and check in with Satellite.</p>
</div>
<div class="paragraph">
<p>The Foreman Discovery image provided with Satellite is based on Red&#160;Hat Enterprise Linux 9.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Install <code>foreman-discovery-image</code> on Satellite&#160;Server:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain packages install foreman-discovery-image</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>foreman-discovery-image</code> package installs the Discovery ISO to the <code>/usr/share/foreman-discovery-image/</code> directory.
The package also extracts the PXE boot image to the <code>/var/lib/tftpboot/boot/fdi-image</code> directory.</p>
</div>
</li>
<li>
<p>If you want to use Capsule&#160;Server, install the Discovery plugin on Capsule&#160;Server:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-installer \
--enable-foreman-proxy-plugin-discovery</pre>
</div>
</div>
</li>
<li>
<p>If you want to use Capsule&#160;Server, install <code>foreman-discovery-image</code> on Capsule&#160;Server:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># satellite-maintain packages install foreman-discovery-image</pre>
</div>
</div>
<div class="paragraph">
<p>The package also extracts the PXE boot image to the <code>/var/lib/tftpboot/boot/fdi-image</code> directory.</p>
</div>
</li>
<li>
<p>Configure the Discovery Capsule for the subnet with discoverable hosts:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In the Satellite web UI, navigate to <strong>Infrastructure</strong> &gt; <strong>Subnets</strong>.</p>
</li>
<li>
<p>Select a subnet.</p>
</li>
<li>
<p>On the <strong>Capsules</strong> tab, select the Discovery Capsule that you want to use.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Perform this for each subnet that you want to use.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="discovery-in-pxe-mode"><a class="anchor" href="#discovery-in-pxe-mode"></a>10.3. Discovery in PXE mode</h3>
<div class="paragraph">
<p>Satellite provides a PXE-based Discovery service that uses DHCP and TFTP services.
You discover unknown nodes by booting them into the Discovery kernel and initial RAM disk images from Satellite&#160;Server or Capsule&#160;Server.
When a discovered node is scheduled for installation, it reboots and continues with the configured PXE-based host provisioning.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/common/discovery-pxe-mode-satellite.png" alt="Discovery workflow in PXE mode">
</div>
<div class="title">Figure 1. Discovery workflow in PXE mode</div>
</div>
<div class="sect3">
<h4 id="setting-discovery-as-the-default-PXE-boot-option_provisioning-installer"><a class="anchor" href="#setting-discovery-as-the-default-PXE-boot-option_provisioning-installer"></a>10.3.1. Setting Discovery as the default PXE boot option</h4>
<div class="paragraph">
<p>Set the Discovery service as the default service that boots for hosts that are not present in your current Satellite inventory.</p>
</div>
<div class="paragraph">
<p>When you start an unknown host in PXE mode, Satellite&#160;Server or Capsule&#160;Server provides a boot menu with a default boot option.
The boot menu has two basic options: <code>local</code> and <code>discovery</code>.
The default setting of the global PXE templates is to select <code>local</code> to boot the host from the local hard drive.
Change the setting to select <code>discovery</code> to boot from the Discovery image.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Your Satellite account has the <code>view_settings</code>, <code>edit_settings</code>, and <code>view_provisioning_templates</code> permissions.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Administer</strong> &gt; <strong>Settings</strong>.</p>
</li>
<li>
<p>On the <strong>Provisioning</strong> tab, enter <code>discovery</code> in the <strong>Default PXE global template entry</strong> field.</p>
</li>
<li>
<p>Navigate to <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Provisioning Templates</strong>.</p>
</li>
<li>
<p>Click <strong>Build PXE Default</strong>.</p>
<div class="paragraph">
<p>The boot menus are built as the following files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>/var/lib/tftpboot/pxelinux.cfg/default</code></p>
</li>
<li>
<p><code>/var/lib/tftpboot/grub2/grub.cfg</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Satellite propagates the default boot menus to all TFTP Capsules.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="performing-discovery-in-pxe-mode_provisioning-installer"><a class="anchor" href="#performing-discovery-in-pxe-mode_provisioning-installer"></a>10.3.2. Performing Discovery in PXE mode</h4>
<div class="paragraph">
<p>Discovery in PXE mode uses the Discovery PXE boot images and runs unattended.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have installed the Discovery service and image.
For more information, see <a href="#Installing_the_Discovery_Service_provisioning-installer">Installing the Discovery service</a>.</p>
</li>
<li>
<p>You have set Discovery as the default booting option.
For more information, see <a href="#setting-discovery-as-the-default-PXE-boot-option_provisioning-installer">Setting Discovery as the default PXE boot option</a>.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Power on or reboot your host.
After a few minutes, the Discovery image completes booting and the host displays a status screen.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Verification</div>
<ul>
<li>
<p>Satellite web UI displays a notification about a new discovered host.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Next steps</div>
<ul>
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Discovered Hosts</strong> and view the newly discovered host.
For more information about provisioning discovered hosts, see <a href="#Creating_Hosts_from_Discovered_Hosts_provisioning-installer">Creating hosts from discovered hosts</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="Customizing_the_Discovery_PXE_Boot_provisioning-installer"><a class="anchor" href="#Customizing_the_Discovery_PXE_Boot_provisioning-installer"></a>10.3.3. Customizing the Discovery PXE boot</h4>
<div class="paragraph">
<p><a id="Discovery_Templates_and_Snippets_Settings_provisioning-installer"></a>
<a id="Provisioning_Template_PXELinux_Discovery_Snippet_provisioning-installer"></a></p>
</div>
<div class="paragraph">
<p>Satellite builds PXE boot menus from the following global provisioning templates:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>PXELinux global default</code> for BIOS provisioning.</p>
</li>
<li>
<p><code>PXEGrub global default</code> and <code>PXEGrub2 global default</code> for UEFI provisioning.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The PXE boot menus are available on Satellite&#160;Server and Capsules that have TFTP enabled.</p>
</div>
<div class="paragraph">
<p>The Discovery menu item uses a Linux kernel for the operating system and passes kernel parameters to configure the Discovery service.
You can customize the passed kernel parameters by changing the following snippets:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pxelinux_discovery</code>: This snippet is included in the <code>PXELinux global default</code> template.</p>
<div class="paragraph">
<p>This snippet renders the Discovery boot menu option.
The <code>KERNEL</code> and <code>APPEND</code> options boot the Discovery kernel and initial RAM disk.
The <code>APPEND</code> option contains kernel parameters.</p>
</div>
</li>
<li>
<p><code>pxegrub_discovery</code>: This snippet is included in the <code>PXEGrub global default</code> template.
However, Discovery is <a href="http://projects.theforeman.org/issues/15997">not implemented for GRUB 1.x</a>.</p>
</li>
<li>
<p><code>pxegrub2_discovery</code>: This snippet is included in the <code>PXEGrub2 global default</code> template.</p>
<div class="paragraph">
<p>This snippet renders the Discovery GRUB2 menu entry.
The <code>common</code> variable contains kernel parameters.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>For information about the kernel parameters, see <a href="#kernel-parameters-for-discovery-customization_provisioning-installer">Kernel parameters for Discovery customization</a>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Provisioning Templates</strong>.</p>
</li>
<li>
<p>Clone and edit the snippet you want to customize.
For more information, see <a href="#cloning-provisioning-templates">Cloning provisioning templates</a>.</p>
</li>
<li>
<p>Clone and edit the template that contains the original snippet.
Include your custom snippet instead of the original snippet.
For more information, see <a href="#cloning-provisioning-templates">Cloning provisioning templates</a>.</p>
</li>
<li>
<p>Navigate to <strong>Administer</strong> &gt; <strong>Settings</strong>.</p>
</li>
<li>
<p>Click the <strong>Provisioning</strong> tab.</p>
</li>
<li>
<p>In the appropriate <strong>Global default PXE\</strong> template* setting, select your custom template.</p>
</li>
<li>
<p>Navigate to <strong>Hosts</strong> &gt; <strong>Templates</strong> &gt; <strong>Provisioning Templates</strong>.</p>
</li>
<li>
<p>Click <strong>Build PXE Default</strong>.
This refreshes the default PXE boot menus on Satellite&#160;Server and any TFTP Capsules.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="discovering-hosts-from-multiple-capsule-servers_provisioning-installer"><a class="anchor" href="#discovering-hosts-from-multiple-capsule-servers_provisioning-installer"></a>10.3.4. Discovering hosts from multiple Capsule&#160;Servers</h4>
<div class="paragraph">
<p>Satellite deploys the same template to all TFTP Capsules and there is no variable or macro available to render the host name of Capsule.
The hard-coded <code>proxy.url</code> does not work with two or more TFTP Capsules.</p>
</div>
<div class="paragraph">
<p>As a workaround, every time you click <strong>Build PXE Defaults</strong>, edit the configuration file in the TFTP directory on all Capsule&#160;Servers by using SSH, or use a common DNS alias for appropriate subnets.
To use Capsule&#160;Server to proxy the Discovery steps, edit <code>/var/lib/tftpboot/pxelinux.cfg/default</code> or <code>/var/lib/tftpboot/grub2/grub.cfg</code>, and change the URL to the Capsule&#160;Server FQDN you want to use.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="discovery-in-pxeless-mode"><a class="anchor" href="#discovery-in-pxeless-mode"></a>10.4. Discovery in PXE-less mode</h3>
<div class="paragraph">
<p>Satellite provides a PXE-less Discovery service for environments without DHCP and TFTP services.
You discover unknown nodes by using the Discovery ISO from Satellite&#160;Server.
When a discovered node is scheduled for installation, the <code>kexec</code> command reloads a Linux kernel with an operating system installer without rebooting the node.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>Discovery <code>kexec</code> is a Technology Preview feature only.</p>
</div>
<div class="paragraph">
<p>Technology Preview features are not supported with Red Hat production service level agreements (SLAs) and might not be functionally complete.
Red Hat does not recommend using them in production.
These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.
For more information, see <a href="https://access.redhat.com/support/offerings/techpreview/">Technology Preview Features &#8211; Scope of Support</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Known issues</div>
<ul>
<li>
<p>The console might freeze during the process.</p>
</li>
<li>
<p>On some hardware, you might experience graphical hardware problems.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/common/discovery-pxeless-mode-satellite.png" alt="Discovery workflow in PXE-less mode">
</div>
<div class="title">Figure 2. Discovery workflow in PXE-less mode</div>
</div>
<div class="sect3">
<h4 id="performing-discovery-in-pxeless-mode_provisioning-installer"><a class="anchor" href="#performing-discovery-in-pxeless-mode_provisioning-installer"></a>10.4.1. Performing Discovery in PXE-less mode</h4>
<div class="paragraph">
<p><a id="Implementing_PXE_less_Discovery_provisioning-installer"></a></p>
</div>
<div class="paragraph">
<p>Discovery in PXE-less mode uses the Discovery ISO and requires you to attend to the process.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have installed the Foreman Discovery image.
For more information, see <a href="#Installing_the_Discovery_Service_provisioning-installer">Installing the Discovery service</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Copy the Discovery ISO to a CD, DVD, or a USB flash drive.
For example, to copy to a USB drive at <code>/dev/sdb</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># dd bs=4M \
if=/usr/share/foreman-discovery-image/foreman-discovery-image-<em>version</em>.iso \
of=/dev/sdb</pre>
</div>
</div>
</li>
<li>
<p>Insert the Discovery boot media into a host, start the host, and boot from the media.</p>
</li>
<li>
<p>The Discovery image displays options for either <strong>Manual network setup</strong> or <strong>Discovery with DHCP</strong>:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Manual network setup</strong>:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>On the <strong>Primary interface</strong> screen, select the primary network interface that connects to Satellite&#160;Server or Capsule&#160;Server.
Optionally, enter a <strong>VLAN ID</strong>.
Hit <strong>Select</strong> to continue.</p>
</li>
<li>
<p>On the <strong>Network configuration</strong> screen, enter the <strong>Address</strong>, <strong>Gateway</strong>, and <strong>DNS</strong>.
Hit <strong>Next</strong> to continue.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Discovery with DHCP</strong>:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>On the <strong>Primary interface</strong> screen, select the primary network interface that connects to Satellite&#160;Server or Capsule&#160;Server.
Optionally, enter a <strong>VLAN ID</strong>.
Hit <strong>Select</strong> to continue.</p>
</li>
<li>
<p>The Discovery image attempts to automatically configure the network interface by using a DHCP server, such as one that a Capsule&#160;Server provides.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>On the <strong>Credentials</strong> screen, enter the following options:</p>
<div class="ulist">
<ul>
<li>
<p>In the <strong>Server URL</strong> field, enter the URL of Satellite&#160;Server or Discovery Capsule&#160;Server.
If you refer to a Capsule&#160;Server, include the Capsule port number.</p>
</li>
<li>
<p>In the <strong>Connection type</strong> field, select the connection type: <code>Server</code> for Satellite&#160;Server or <code>Foreman Proxy</code> for Capsule&#160;Server.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Hit <strong>Next</strong> to continue.</p>
</div>
</li>
<li>
<p>Optional: On the <strong>Custom facts</strong> screen, enter custom facts for the Facter tool to relay back to Satellite&#160;Server.
Enter a name and value for each custom fact you need.</p>
</li>
<li>
<p>Hit <strong>Confirm</strong> to proceed.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Verification</div>
<ul>
<li>
<p>Satellite web UI displays a notification about a new discovered host.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Next steps</div>
<ul>
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Discovered Hosts</strong> and view the newly discovered host.
For more information about provisioning discovered hosts, see <a href="#Creating_Hosts_from_Discovered_Hosts_provisioning-installer">Creating hosts from discovered hosts</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="customizing-the-discovery-iso_provisioning-installer"><a class="anchor" href="#customizing-the-discovery-iso_provisioning-installer"></a>10.4.2. Customizing the Discovery ISO</h4>
<div class="paragraph">
<p>You can create a customized Discovery ISO to automate the image configuration process after booting.
The Discovery image uses a Linux kernel for the operating system, which passes kernel parameters to configure the Discovery service.</p>
</div>
<div class="paragraph">
<p>Satellite&#160;Server provides the <code>discovery-remaster</code> tool in the <code>foreman-discovery-image</code> package.
By using this tool, remaster the image to include custom kernel parameters.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Run the <code>discovery-remaster</code> tool.
Enter the kernel parameters as a single string.
For example:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># discovery-remaster ~/iso/foreman-discovery-image-<em>version</em>.iso \
"fdi.pxip=192.168.140.20/24 \
fdi.pxgw=192.168.140.1 \
fdi.pxdns=192.168.140.2 \
proxy.url=https://<em>satellite.example.com</em>:9090 \
proxy.type=proxy \
fdi.pxfactname1=<em>My_Custom_Hostname</em> \
fdi.pxfactvalue1=<em>My_Host</em> \
fdi.pxmac=52:54:00:be:8e:8c fdi.pxauto=1"</pre>
</div>
</div>
<div class="paragraph">
<p>For more information about kernel parameters, see <a href="#kernel-parameters-for-discovery-customization_provisioning-installer">Kernel parameters for Discovery customization</a>.</p>
</div>
</li>
<li>
<p>Copy the new ISO to either a CD, DVD, or a USB stick.
For example, to copy to a USB stick at <code>/dev/sdb</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># dd bs=4M \
if=/usr/share/foreman-discovery-image/foreman-discovery-image-<em>version</em>.iso \
of=/dev/sdb</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Next steps</div>
<ul>
<li>
<p>Insert the Discovery boot medium into a bare metal host, start the host, and boot from the medium.</p>
<div class="paragraph">
<p>For more information about provisioning discovered hosts, see <a href="#Creating_Hosts_from_Discovered_Hosts_provisioning-installer">Creating hosts from discovered hosts</a>.</p>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Automatic_Contexts_for_Discovered_Hosts_provisioning-installer"><a class="anchor" href="#Automatic_Contexts_for_Discovered_Hosts_provisioning-installer"></a>10.5. Automatic contexts for discovered hosts</h3>
<div class="paragraph">
<p>Satellite&#160;Server assigns an organization and location to discovered hosts automatically according to the following sequence of rules:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If a discovered host uses a subnet defined in Satellite, the host uses the first organization and location associated with the subnet.</p>
</li>
<li>
<p>If the default location and organization is configured in global settings, the discovered hosts are placed in this organization and location.
To configure these settings, navigate to <strong>Administer</strong> &gt; <strong>Settings</strong> &gt; <strong>Discovery</strong> and select values for the <strong>Discovery organization</strong> and <strong>Discovery location</strong> settings.
Ensure that the subnet of discovered host also belongs to the selected organization and location, otherwise Satellite refuses to set it for security reasons.</p>
</li>
<li>
<p>If none of the previous conditions is met, Satellite assigns the first organization and location ordered by name.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can change the organization or location manually by using the bulk actions on the <strong>Discovered Hosts</strong> page.
Select the discovered hosts to modify and, from the <strong>Select Action</strong> menu, select <strong>Assign Organization</strong> or <strong>Assign Location</strong>.</p>
</div>
</div>
<div class="sect2">
<h3 id="Creating_Hosts_from_Discovered_Hosts_provisioning-installer"><a class="anchor" href="#Creating_Hosts_from_Discovered_Hosts_provisioning-installer"></a>10.6. Creating hosts from discovered hosts</h3>
<div class="paragraph">
<p>Provisioning discovered hosts follows a provisioning process that is similar to PXE provisioning.
The main difference is that instead of manually entering the host&#8217;s MAC address, you can select the host to provision from the list of discovered hosts.</p>
</div>
<div class="paragraph">
<p>To use the CLI instead of the Satellite web UI, see the <a href="#cli-creating-hosts-from-discovered-hosts_provisioning-installer">CLI procedure</a>.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Configure a domain and subnet on Satellite.
For more information about networking requirements, see <a href="#preparing-networking">Preparing networking</a>.</p>
</li>
<li>
<p>You have one or more discovered hosts in your Satellite inventory.</p>
</li>
<li>
<p>You can use synchronized content repositories for Red&#160;Hat Enterprise Linux.
For more information, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/managing_content/index#Synchronizing_Repositories_content-management">Syncing Repositories</a> in <em>Managing content</em>.</p>
</li>
<li>
<p>Provide an activation key for host registration.
For more information, see <a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/managing_content/index#Creating_an_Activation_Key_content-management">Creating An Activation Key</a> in <em>Managing content</em>.</p>
</li>
<li>
<p>You have associated a <code>Discovery kexec</code>-kind template and <code>provisioning</code>-kind template with the operating system.
For more information, see <a href="#Associating_Templates_with_Operating_Systems_provisioning-installer">Associating templates with operating systems</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For information about the security tokens, see <a href="#configuring-the-security-token-validity-duration">Configuring the security token validity duration</a>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Discovered hosts</strong>.</p>
</li>
<li>
<p>Select the host you want to provision and click <strong>Provision</strong> to the right of the list.</p>
</li>
<li>
<p>Select one of the following options:</p>
<div class="ulist">
<ul>
<li>
<p>To provision a host from a host group, select a host group, organization, and location, and then click <strong>Create Host</strong>.</p>
</li>
<li>
<p>To provision a host with further customization, click <strong>Customize Host</strong> and enter the additional details you want to specify for the new host.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Verify that the fields are populated with values.
Note in particular:</p>
<div class="ulist">
<ul>
<li>
<p>The <strong>Name</strong> from the <strong>Host</strong> tab becomes the <strong>DNS name</strong>.</p>
</li>
<li>
<p>Satellite&#160;Server automatically assigns an IP address for the new host.</p>
</li>
<li>
<p>Satellite&#160;Server automatically populates the MAC address from the Discovery results.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Ensure that Satellite&#160;Server automatically selects the <strong>Managed</strong>, <strong>Primary</strong>, and <strong>Provision</strong> options for the first interface on the host.
If not, select them.</p>
</li>
<li>
<p>Click the <strong>Operating System</strong> tab, and verify that all fields contain values.
Confirm each aspect of the operating system.</p>
</li>
<li>
<p>In <strong>Provisioning templates</strong>, click <strong>Resolve</strong> to check if the new host can identify the correct provisioning templates.
The host must resolve to the following provisioning templates:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Discovery kexec</strong>: <code>Discovery Red Hat kexec</code></p>
</li>
<li>
<p><strong>Provisioning template</strong>: <code>Kickstart default</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>Submit</strong> to save the host details.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When the host provisioning is complete, the discovered host moves to <strong>Hosts</strong> &gt; <strong>All Hosts</strong>.</p>
</div>
<div id="cli-creating-hosts-from-discovered-hosts_provisioning-installer" class="olist arabic">
<div class="title">CLI procedure</div>
<ol class="arabic">
<li>
<p>Identify the discovered host to provision:</p>
<div class="listingblock">
<div class="content">
<pre>$ hammer discovery list</pre>
</div>
</div>
</li>
<li>
<p>Select the host and provision it by using a host group.
Set a new host name with the <code>--new-name</code> option:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer discovery provision \
--build true \
--enabled true \
--hostgroup "<em>My_Host_Group</em>" \
--location "<em>My_Location</em>" \
--managed true \
--name "<em>My_Host_Name</em>" \
--new-name "<em>My_New_Host_Name</em>" \
--organization "<em>My_Organization</em>"</pre>
</div>
</div>
<div class="paragraph">
<p>This removes the host from the discovered host listing and creates a host entry with the provisioning settings.
The Discovery image automatically reboots the host to PXE or initiates kernel execution.
The host detects the DHCP service and starts installing the operating system.
The rest of the process is identical to the normal PXE workflow.
For more information, see <a href="#creating-hosts-with-pxe-boot-provisioning">Creating hosts with PXE boot provisioning</a>.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Creating_Discovery_Rules_provisioning-installer"><a class="anchor" href="#Creating_Discovery_Rules_provisioning-installer"></a>10.7. Creating Discovery rules</h3>
<div class="paragraph">
<p>As a method of automating the provisioning process for discovered hosts, Satellite provides a feature to create Discovery rules.
These rules define how discovered hosts automatically provision themselves, based on the assigned host group.
For example, you can automatically provision hosts with a high CPU count as hypervisors.
Likewise, you can provision hosts with large hard disks as storage servers.</p>
</div>
<div class="paragraph">
<p>To use the CLI instead of the Satellite web UI, see the <a href="#cli-creating-discovery-rules_provisioning-installer">CLI procedure</a>.</p>
</div>
<div class="paragraph">
<div class="title">NIC considerations</div>
<p>Auto provisioning does not currently allow configuring network interface cards (NICs).
All systems are being provisioned with the NIC configuration that was detected during discovery.
However, you can set the NIC in the <code>kickstart</code> scriptlet, by using a script, or by using configuration management at a later stage.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Satellite web UI, navigate to <strong>Configure</strong> &gt; <strong>Discovery rules</strong>, and select <strong>Create Rule</strong>.</p>
</li>
<li>
<p>In the <strong>Name</strong> field, enter a name for the rule.</p>
</li>
<li>
<p>In the <strong>Search</strong> field, enter the rules to determine whether to provision a host.
This field provides suggestions for values you enter and allows operators for multiple rules.
For example: <code>cpu_count  &gt; 8</code>.</p>
</li>
<li>
<p>From the <strong>Host Group</strong> list, select the host group to use as a template for this host.</p>
</li>
<li>
<p>In the <strong>Hostname</strong> field, enter the pattern to determine host names for multiple hosts.
This uses the same ERB syntax that provisioning templates use.
The host name can use the <code>@host</code> attribute for host-specific values and the <code>rand</code> macro for a random number or the <code>sequence_hostgroup_param_next</code> macro for incrementing the value.
For more information about provisioning templates, see <a href="#provisioning-templates">Provisioning templates</a> and the API documentation.</p>
<div class="ulist">
<ul>
<li>
<p><code>myhost-&lt;%= sequence_hostgroup_param_next("EL7/MyHostgroup", 10, "discovery_host") %&gt;</code></p>
</li>
<li>
<p><code>myhost-&lt;%= rand(99999) %&gt;</code></p>
</li>
<li>
<p><code>abc-&lt;%= @host.facts['bios_vendor'] %&gt;-&lt;%= rand(99999) %&gt;</code></p>
</li>
<li>
<p><code>xyz-&lt;%= @host.hostgroup.name %&gt;</code></p>
</li>
<li>
<p><code>srv-&lt;%= @host.discovery_rule.name %&gt;</code></p>
</li>
<li>
<p><code>server-&lt;%= @host.ip.gsub('.','-') +  '-' + @host.hostgroup.subnet.name %&gt;</code></p>
<div class="paragraph">
<p>When creating host name patterns, ensure that the resulting host names are unique, do not start with numbers, and do not contain underscores or dots.
A good approach is to use unique information provided by Facter, such as the MAC address, BIOS, or serial ID.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>In the <strong>Hosts limit</strong> field, enter the maximum number of hosts that you can provision with the rule.
Enter <code>0</code> for unlimited.</p>
</li>
<li>
<p>In the <strong>Priority</strong> field, enter a number to set the precedence the rule has over other rules.
Rules with lower values have a higher priority.</p>
</li>
<li>
<p>From the <strong>Enabled</strong> list, select whether you want to enable the rule.</p>
</li>
<li>
<p>To set a different provisioning context for the rule, click the <strong>Organizations</strong> and <strong>Locations</strong> tabs and select the contexts you want to use.</p>
</li>
<li>
<p>Click <strong>Submit</strong> to save your rule.</p>
</li>
<li>
<p>In the Satellite web UI, navigate to <strong>Hosts</strong> &gt; <strong>Discovered Host</strong> and select one of the following two options:</p>
<div class="ulist">
<ul>
<li>
<p>From the <strong>Discovered hosts</strong> list on the right, select <strong>Auto-Provision</strong> to automatically provisions a single host.</p>
</li>
<li>
<p>On the upper right of the window, click <strong>Auto-Provision All</strong> to automatically provisions all hosts.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div id="cli-creating-discovery-rules_provisioning-installer" class="olist arabic">
<div class="title">CLI procedure</div>
<ol class="arabic">
<li>
<p>Create the rule by using Hammer:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ hammer discovery-rule create \
--enabled true \
--hostgroup "<em>My_Host_Group</em>" \
--hostname "hypervisor-&lt;%= rand(99999) %&gt;" \
--hosts-limit 5 \
--name "<em>My_Hypervisor</em>" \
--priority 5 \
--search "cpu_count  &gt; 8"</pre>
</div>
</div>
</li>
<li>
<p>Automatically provision a host with the <code>hammer discovery auto-provision</code> command:</p>
<div class="listingblock">
<div class="content">
<pre>$ hammer discovery auto-provision --name "macabcdef123456"</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Extending_the_Discovery_Image_provisioning-installer"><a class="anchor" href="#Extending_the_Discovery_Image_provisioning-installer"></a>10.8. Extending the Discovery image</h3>
<div class="paragraph">
<p>You can extend the Satellite Discovery image with custom facts, software, or device drivers.
You can also provide a compressed archive file containing extra code for the image to use.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create the following directory structure:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">.
├── autostart.d
│   └── 01_zip.sh
├── bin
│   └── ntpdate
├── facts
│   └── test.rb
└── lib
    ├── libcrypto.so.1.0.0
    └── ruby
        └── test.rb</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>autostart.d</code> directory contains scripts that are executed in POSIX order by the Discovery kernel when it starts but before the host is registered to Satellite.</p>
</li>
<li>
<p>The <code>bin</code> directory is added to the <code>$PATH</code> variable; you can place binary files in this directory and use them in the <code>autostart</code> scripts.</p>
</li>
<li>
<p>The <code>facts</code> directory is added to the <code>FACTERLIB</code> variable so that custom facts can be configured and sent to Satellite.</p>
</li>
<li>
<p>The <code>lib</code> directory is added to the <code>LD_LIBRARY_PATH</code> variable and <code>lib/ruby</code> is added to the <code>RUBYLIB</code> variable, so that binary files in <code>/bin</code> can be executed correctly.</p>
</li>
</ul>
</div>
</li>
<li>
<p>After creating the directory structure, create a <code>.zip</code> file archive with the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># zip -r my_extension.zip .</pre>
</div>
</div>
</li>
<li>
<p>Inform the Discovery kernel of the extensions it must use.
Place your zip files on your TFTP server with the Discovery image and customize the Discovery PXE boot with the <code>fdi.zips</code> parameter where the paths are relative to the TFTP root.</p>
<div class="paragraph">
<p>For example, if you have two archives at <code>$TFTP/zip1.zip</code> and <code>$TFTP/boot/zip2.zip</code>, use the following syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">fdi.zips=zip1.zip,boot/zip2.zip</pre>
</div>
</div>
<div class="paragraph">
<p>For more information, see <a href="#Customizing_the_Discovery_PXE_Boot_provisioning-installer">Customizing the Discovery PXE boot</a>.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can append new directives and options to the existing environment variables (<code>PATH</code>, <code>LD_LIBRARY_PATH</code>, <code>RUBYLIB</code> and <code>FACTERLIB</code>).
If you want to specify the path explicitly in your scripts, the <code>.zip</code> file contents are extracted to the <code>/opt/extension</code> directory on the image.</p>
</div>
<div class="paragraph">
<p>You can create multiple <code>.zip</code> files but be aware that they are extracted to the same location on the Discovery image.
Files extracted from in later <code>.zip</code> files overwrite earlier versions if they contain the same file name.</p>
</div>
</div>
<div class="sect2">
<h3 id="kernel-parameters-for-discovery-customization_provisioning-installer"><a class="anchor" href="#kernel-parameters-for-discovery-customization_provisioning-installer"></a>10.9. Kernel parameters for Discovery customization</h3>
<div class="paragraph">
<p>Discovery uses a Linux kernel for the operating system and passes kernel parameters to configure the Discovery service.
These kernel parameters include the following entries:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">fdi.cachefacts</dt>
<dd>
<p>Number of fact uploads without caching.
By default, Satellite does not cache any uploaded facts.</p>
</dd>
<dt class="hdlist1">fdi.countdown</dt>
<dd>
<p>Number of seconds to wait until the text-user interface is refreshed after the initial discovery attempt.
This value defaults to 45 seconds.
Increase this value if the status page reports the IP address as <code>N/A</code>.</p>
</dd>
<dt class="hdlist1">fdi.dhcp_timeout</dt>
<dd>
<p>NetworkManager DHCP timeout.
The default value is 300 seconds.</p>
</dd>
<dt class="hdlist1">fdi.dns_nameserver</dt>
<dd>
<p>Nameserver to use for DNS SRV record.</p>
</dd>
<dt class="hdlist1">fdi.dns_ndots</dt>
<dd>
<p><code>ndots</code> option to use for DNS SRV record.</p>
</dd>
<dt class="hdlist1">fdi.dns_search</dt>
<dd>
<p>Search domain to use for DNS SRV record.</p>
</dd>
<dt class="hdlist1">fdi.initnet</dt>
<dd>
<p>By default, the image initializes all network interfaces (value <code>all</code>).
When this setting is set to <code>bootif</code>, only the network interface it was network-booted from will be initialized.</p>
</dd>
<dt class="hdlist1">fdi.ipv4.method</dt>
<dd>
<p>By default, NetworkManager IPv4 method setting is set to <code>auto</code>.
This option overrides it, set it to <code>ignore</code> to disable the IPv4 stack.
This option works only in DHCP mode.</p>
</dd>
<dt class="hdlist1">fdi.ipv6.method</dt>
<dd>
<p>By default, NetworkManager IPv6 method setting is set to <code>auto</code>.
This option overrides it, set it to <code>ignore</code> to disable the IPv6 stack.
This option only works in DHCP mode.</p>
</dd>
<dt class="hdlist1">fdi.ipwait</dt>
<dd>
<p>Duration in seconds to wait for IP to be available in HTTP proxy SSL cert start.
By default, Satellite waits for 120 seconds.</p>
</dd>
<dt class="hdlist1">fdi.nmwait</dt>
<dd>
<p><code>nmcli -wait</code> option for NetworkManager.
By default, <code>nmcli</code> waits for 120 seconds.</p>
</dd>
<dt class="hdlist1">fdi.proxy_cert_days</dt>
<dd>
<p>Number of days the self-signed HTTPS cert is valid for.
By default, the certificate is valid for 999 days.</p>
</dd>
<dt class="hdlist1">fdi.pxauto</dt>
<dd>
<p>To set automatic or semi-automatic mode.
If set to 0, the image uses semi-automatic mode, which allows you to confirm your choices through a set of dialog options.
If set to 1, the image uses automatic mode and proceeds without any confirmation.</p>
</dd>
<dt class="hdlist1">fdi.pxfactname1, fdi.pxfactname2 &#8230;&#8203; fdi.pxfactnameN</dt>
<dd>
<p>Use to specify custom fact names.</p>
</dd>
<dt class="hdlist1">fdi.pxfactvalue1, fdi.pxfactvalue2 &#8230;&#8203; fdi.pxfactvalueN</dt>
<dd>
<p>The values for each custom fact.
Each value corresponds to a fact name.
For example, <code>fdi.pxfactvalue1</code> sets the value for the fact named with <code>fdi.pxfactname1</code>.</p>
</dd>
<dt class="hdlist1">fdi.pxip, fdi.pxgw, fdi.pxdns</dt>
<dd>
<p>Manually configures IP address (<code>fdi.pxip</code>), the gateway (<code>fdi.pxgw</code>), and the DNS (<code>fdi.pxdns</code>) for the primary network interface.
If you omit these parameters, the image uses DHCP to configure the network interface.
You can add multiple DNS entries in a comma-separated
<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup>
list, for example <code>fdi.pxdns=192.168.1.1,192.168.200.1</code>.</p>
</dd>
<dt class="hdlist1">fdi.pxmac</dt>
<dd>
<p>The MAC address of the primary interface in the format of <code>AA:BB:CC:DD:EE:FF</code>.
This is the interface you aim to use for communicating with Capsule&#160;Server.
In automated mode, the first NIC (using network identifiers in alphabetical order) with a link is used.
In semi-automated mode, a screen appears and requests you to select the correct interface.</p>
</dd>
<dt class="hdlist1">fdi.rootpw</dt>
<dd>
<p>By default, the <code>root</code> account is locked.
Use this option to set a root password.
You can enter both clear and encrypted passwords.</p>
</dd>
<dt class="hdlist1">fdi.ssh</dt>
<dd>
<p>By default, the SSH service is disabled.
Set this to <code>1</code> or <code>true</code> to enable SSH access.</p>
</dd>
<dt class="hdlist1">fdi.uploadsleep</dt>
<dd>
<p>Duration in seconds between facter runs.
By default, facter runs every 30 seconds.</p>
</dd>
<dt class="hdlist1">fdi.vlan.primary</dt>
<dd>
<p>VLAN tagging ID to set for the primary interface.
If you want to use tagged VLAN provisioning and you want the Discovery service to send a discovery request, add the following parameter to the Discovery snippet:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">fdi.vlan.primary=<em>My_VLAN_ID</em></pre>
</div>
</div>
</dd>
<dt class="hdlist1">fdi.zips</dt>
<dd>
<p>Filenames with extensions to be downloaded and started during boot.
For more information, see <a href="#Extending_the_Discovery_Image_provisioning-installer">Extending the Discovery image</a>.</p>
</dd>
<dt class="hdlist1">fdi.zipserver</dt>
<dd>
<p>TFTP server to use to download extensions from.
For more information, see <a href="#Extending_the_Discovery_Image_provisioning-installer">Extending the Discovery image</a>.</p>
</dd>
<dt class="hdlist1">net.ifnames and biosdevname</dt>
<dd>
<p>Because network interface names are not expected to always be the same <a href="https://access.redhat.com/solutions/5984311">between major versions</a> of Red&#160;Hat Enterprise Linux,
hosts can be created with incorrect network configurations.
You can disable the new naming scheme by a kernel command line parameter:</p>
<div class="ulist">
<ul>
<li>
<p>For Dell servers, use the <code>biosdevname=1</code> parameter.</p>
</li>
<li>
<p>For other hardware or virtual machines, use the <code>net.ifnames=1</code> parameter.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">proxy.type</dt>
<dd>
<p>The proxy type.
By default, this parameter is set to <code>foreman</code>, where communication goes directly to Satellite&#160;Server.
Set this parameter to <code>proxy</code> if you point to Capsule in <code>proxy.url</code>.</p>
</dd>
<dt class="hdlist1">proxy.url</dt>
<dd>
<p>The URL of the server providing the Discovery service.
By default, this parameter contains the <code>foreman_server_url</code> macro as its argument.
This macro resolves to the full URL of Satellite&#160;Server.
There is no macro for a Capsule URL.
You have to set a Capsule explicitly.
For example:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">proxy.url=https://<em>capsule.example.com</em>:9090 proxy.type=proxy</pre>
</div>
</div>
<div class="paragraph">
<p>You can use an IP address or FQDN in this parameter.
Add a SSL port number if you point to Capsule.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="Troubleshooting_Discovery_provisioning-installer"><a class="anchor" href="#Troubleshooting_Discovery_provisioning-installer"></a>10.10. Troubleshooting Discovery</h3>
<div class="paragraph">
<p>If a machine is not listed in the Satellite web UI in <strong>Hosts</strong> &gt; <strong>Discovered Hosts</strong>, it means that Discovery has failed.
Inspect the following configuration areas to help isolate the problem:</p>
</div>
<div class="ulist">
<div class="title">Inspecting prerequisites</div>
<ul>
<li>
<p>Ensure that your Satellite and hosts meet the requirements.
For more information, see <a href="#prerequisites-for-using-discovery_provisioning-installer">Prerequisites for using Discovery</a>.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Inspecting problems on Satellite</div>
<ul>
<li>
<p>Ensure you have set Discovery for booting and built the PXE boot configuration files.
For more information, see <a href="#setting-discovery-as-the-default-PXE-boot-option_provisioning-installer">Setting Discovery as the default PXE boot option</a>.</p>
</li>
<li>
<p>Verify that these configuration files are present on your TFTP Capsule and have <code>discovery</code> set as the default boot option:</p>
<div class="ulist">
<ul>
<li>
<p><code>/var/lib/tftpboot/pxelinux.cfg/default</code></p>
</li>
<li>
<p><code>/var/lib/tftpboot/grub2/grub.cfg</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Verify that the values of the <code>proxy.url</code> and <code>proxy.type</code> options in the PXE Discovery snippet you are using.
The default snippets are named <code>pxelinux_discovery</code>, <code>pxegrub_discovery</code>, or <code>pxegrub2_discovery</code>.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Inspecting problems with networking</div>
<ul>
<li>
<p>Ensure adequate network connectivity between hosts, Capsule&#160;Server, and Satellite&#160;Server.</p>
</li>
<li>
<p>Ensure that the DHCP server provides IP addresses to the booted Discovery image correctly.</p>
</li>
<li>
<p>Ensure that DNS is working correctly for the discovered hosts or use an IP address in the <code>proxy.url</code> option in the PXE Discovery snippet included in the PXE template you are using.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Inspecting problems on the host</div>
<ul>
<li>
<p>If the host boots into the Discovery image but Discovery is not successful, enable the root account and SSH access on the Discovery image.
You can enable SSH and set the root password by using the following Discovery kernel options:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">fdi.ssh=1 fdi.rootpw=<em>My_Password</em></pre>
</div>
</div>
</li>
<li>
<p>Using TTY2 or higher, log in to a Discovery-booted host to review system logs.
For example, these logs are useful for troubleshooting:</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>discover-host</code></dt>
<dd>
<p>Initial facts upload</p>
</dd>
<dt class="hdlist1"><code>foreman-discovery</code></dt>
<dd>
<p>Facts refresh, reboot remote commands</p>
</dd>
<dt class="hdlist1"><code>nm-prepare</code></dt>
<dd>
<p>Boot script which pre-configures NetworkManager</p>
</dd>
<dt class="hdlist1"><code>NetworkManager</code></dt>
<dd>
<p>Networking information</p>
</dd>
</dl>
</div>
</li>
<li>
<p>For gathering important system facts, use the <code>discovery-debug</code> command on the Discovery-booted host.
It prints out system logs, network configuration, list of facts, and other information on the standard output.
You can redirect this output to a file and copy it with the <code>scp</code> command for further investigation.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p>For more information about changing the Discovery kernel options, see the following resources:</p>
<div class="ulist">
<ul>
<li>
<p><a href="#Customizing_the_Discovery_PXE_Boot_provisioning-installer">Customizing the Discovery PXE boot</a></p>
</li>
<li>
<p><a href="#customizing-the-discovery-iso_provisioning-installer">Customizing the Discovery ISO</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Host_Parameter_Hierarchy_provisioning-installer"><a class="anchor" href="#Host_Parameter_Hierarchy_provisioning-installer"></a>Appendix A: Host parameter hierarchy</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can access host parameters when provisioning hosts.
Hosts inherit their parameters from the following locations, in order of increasing precedence:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter Level</th>
<th class="tableblock halign-left valign-top">Set in Satellite web UI</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Globally defined parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Configure</strong> &gt; <strong>Global parameters</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Organization-level parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Administer</strong> &gt; <strong>Organizations</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Location-level parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Administer</strong> &gt; <strong>Locations</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Domain-level parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Infrastructure</strong> &gt; <strong>Domains</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Subnet-level parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Infrastructure</strong> &gt; <strong>Subnets</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operating system-level parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Hosts</strong> &gt; <strong>Provisioning Setup</strong> &gt; <strong>Operating Systems</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Host group-level parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Configure</strong> &gt; <strong>Host Groups</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Host parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Hosts</strong> &gt; <strong>All Hosts</strong></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="permissions-required-to-provision-hosts_provisioning-installer"><a class="anchor" href="#permissions-required-to-provision-hosts_provisioning-installer"></a>Appendix B: Permissions required to provision hosts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following list provides an overview of the permissions a non-admin user requires to provision hosts.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Resource name</th>
<th class="tableblock halign-left valign-top">Permissions</th>
<th class="tableblock halign-left valign-top">Additional details</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Activation Keys</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_activation_keys</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ansible role</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_ansible_roles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required if Ansible is used.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Architecture</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_architectures</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute profile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_compute_profiles</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Compute resource</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_compute_resources, create_compute_resources, destroy_compute_resources, power_compute_resources</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required to provision bare-metal hosts.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_compute_resources_vms, create_compute_resources_vms, destroy_compute_resources_vms, power_compute_resources_vms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required to provision virtual machines.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Content Views</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_content_views</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Domain</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_domains</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Environment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_environments</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_hosts, create_hosts, edit_hosts, destroy_hosts, build_hosts, power_hosts, play_roles_on_host</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_discovered_hosts, submit_discovered_hosts, auto_provision_discovered_hosts, provision_discovered_hosts, edit_discovered_hosts, destroy_discovered_hosts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required if the Discovery service is enabled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hostgroup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_hostgroups, create_hostgroups, edit_hostgroups, play_roles_on_hostgroup</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Image</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_images</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Lifecycle environment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_lifecycle_environments</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Location</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_locations</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Medium</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_media</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operatingsystem</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_operatingsystems</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Organization</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_organizations</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parameter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_params, create_params, edit_params, destroy_params</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Product and Repositories</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_products</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provisioning template</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_provisioning_templates</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ptable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_ptables</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Capsule</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_smart_proxies, view_smart_proxies_puppetca</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_openscap_proxies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required if the OpenSCAP plugin is enabled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Subnet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">view_subnets</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/administering_red_hat_satellite/index#Creating_a_Role_admin">Creating a Role</a> in <em>Administering Red&#160;Hat Satellite</em></p>
</li>
<li>
<p><a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/administering_red_hat_satellite/index#Adding_Permissions_to_a_Role_admin">Adding Permissions to a Role</a> in <em>Administering Red&#160;Hat Satellite</em></p>
</li>
<li>
<p><a href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.17/html-single/administering_red_hat_satellite/index#Assigning_Roles_to_a_User_admin">Assigning Roles to a User</a> in <em>Administering Red&#160;Hat Satellite</em></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. NetworkManager expects <code>;</code> as a list separator but currently also accepts <code>,</code>. For more information, see <code>man nm-settings-keyfile</code> and <a href="https://www.gnu.org/software/grub/manual/grub/grub.html#Shell_002dlike-scripting">Shell-like scripting in GRUB</a>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated Jan 2025
</div>
</div>
<script>
;(function () { /*! Asciidoctor Tabs | Copyright (c) 2018-present Dan Allen | MIT License */
  'use strict'

  var config = (document.currentScript || {}).dataset || {}
  var forEach = Array.prototype.forEach

  init(document.querySelectorAll('.tabs'))

  function init (tabsBlocks) {
    if (!tabsBlocks.length) return
    forEach.call(tabsBlocks, function (tabs) {
      var syncIds = tabs.classList.contains('is-sync') ? {} : undefined
      var tablist = tabs.querySelector('.tablist ul')
      tablist.setAttribute('role', 'tablist')
      var start
      forEach.call(tablist.querySelectorAll('li'), function (tab, idx) {
        tab.tabIndex = -1
        tab.setAttribute('role', tab.classList.add('tab') || 'tab')
        var id, anchor, syncId
        if (!(id = tab.id) && (anchor = tab.querySelector('a[id]'))) {
          id = tab.id = anchor.parentNode.removeChild(anchor).id
        }
        var panel = id && tabs.querySelector('.tabpanel[aria-labelledby~="' + id + '"]')
        if (!panel) return idx ? undefined : toggleSelected(tab, true) // invalid state
        syncIds && (((syncId = tab.textContent.trim()) in syncIds) ? (syncId = undefined) : true) &&
          (syncIds[(tab.dataset.syncId = syncId)] = tab)
        idx || (syncIds && (start = { tab: tab, panel: panel })) ? toggleHidden(panel, true) : toggleSelected(tab, true)
        tab.setAttribute('aria-controls', panel.id)
        panel.setAttribute('role', 'tabpanel')
        var onClick = syncId === undefined ? activateTab : activateTabSync
        tab.addEventListener('click', onClick.bind({ tabs: tabs, tab: tab, panel: panel }))
      })
      if (!tabs.closest('.tabpanel')) {
        forEach.call(tabs.querySelectorAll('.tabpanel table.tableblock'), function (table) {
          var container = Object.assign(document.createElement('div'), { className: 'tablecontainer' })
          table.parentNode.insertBefore(container, table).appendChild(table)
        })
      }
      if (start) {
        var syncGroupId
        for (var i = 0, lst = tabs.classList, len = lst.length, className; i !== len; i++) {
          if (!(className = lst.item(i)).startsWith('data-sync-group-id=')) continue
          tabs.dataset.syncGroupId = syncGroupId = lst.remove(className) || className.slice(19).replace(/\u00a0/g, ' ')
          break
        }
        if (syncGroupId === undefined) tabs.dataset.syncGroupId = syncGroupId = Object.keys(syncIds).sort().join('|')
        var preferredSyncId = 'syncStorageKey' in config &&
          window[(config.syncStorageScope || 'local') + 'Storage'].getItem(config.syncStorageKey + '-' + syncGroupId)
        var tab = preferredSyncId && syncIds[preferredSyncId]
        tab && Object.assign(start, { tab: tab, panel: document.getElementById(tab.getAttribute('aria-controls')) })
        toggleSelected(start.tab, true) || toggleHidden(start.panel, false)
      }
    })
    onHashChange()
    toggleClassOnEach(tabsBlocks, 'is-loading', 'remove')
    window.setTimeout(toggleClassOnEach.bind(null, tabsBlocks, 'is-loaded', 'add'), 0)
    window.addEventListener('hashchange', onHashChange)
  }

  function activateTab (e) {
    var tab = this.tab
    var tabs = this.tabs || (this.tabs = tab.closest('.tabs'))
    var panel = this.panel || (this.panel = document.getElementById(tab.getAttribute('aria-controls')))
    querySelectorWithSiblings(tabs, '.tablist .tab', 'tab').forEach(function (el) {
      toggleSelected(el, el === tab)
    })
    querySelectorWithSiblings(tabs, '.tabpanel', 'tabpanel').forEach(function (el) {
      toggleHidden(el, el !== panel)
    })
    if (!this.isSync && 'syncStorageKey' in config && 'syncGroupId' in tabs.dataset) {
      var storageKey = config.syncStorageKey + '-' + tabs.dataset.syncGroupId
      window[(config.syncStorageScope || 'local') + 'Storage'].setItem(storageKey, tab.dataset.syncId)
    }
    if (!e) return
    var loc = window.location
    var hashIdx = loc.hash ? loc.href.indexOf('#') : -1
    if (~hashIdx) window.history.replaceState(null, '', loc.href.slice(0, hashIdx))
    e.preventDefault()
  }

  function activateTabSync (e) {
    activateTab.call(this, e)
    var thisTabs = this.tabs
    var thisTab = this.tab
    var initialY = thisTabs.getBoundingClientRect().y
    forEach.call(document.querySelectorAll('.tabs'), function (tabs) {
      if (tabs === thisTabs || tabs.dataset.syncGroupId !== thisTabs.dataset.syncGroupId) return
      querySelectorWithSiblings(tabs, '.tablist .tab', 'tab').forEach(function (tab) {
        if (tab.dataset.syncId === thisTab.dataset.syncId) activateTab.call({ tabs: tabs, tab: tab, isSync: true })
      })
    })
    var shiftedBy = thisTabs.getBoundingClientRect().y - initialY
    if (shiftedBy && (shiftedBy = Math.round(shiftedBy))) window.scrollBy({ top: shiftedBy, behavior: 'instant' })
  }

  function querySelectorWithSiblings (scope, selector, siblingClass) {
    var el = scope.querySelector(selector)
    if (!el) return []
    var result = [el]
    while ((el = el.nextElementSibling) && el.classList.contains(siblingClass)) result.push(el)
    return result
  }

  function toggleClassOnEach (elements, className, method) {
    forEach.call(elements, function (el) {
      el.classList[method](className)
    })
  }

  function toggleHidden (el, state) {
    el.classList[(el.hidden = state) ? 'add' : 'remove']('is-hidden')
  }

  function toggleSelected (el, state) {
    el.setAttribute('aria-selected', '' + state)
    el.classList[state ? 'add' : 'remove']('is-selected')
    el.tabIndex = state ? 0 : -1
  }

  function onHashChange () {
    var id = window.location.hash.slice(1)
    if (!id) return
    var tab = document.getElementById(~id.indexOf('%') ? decodeURIComponent(id) : id)
    if (!(tab && tab.classList.contains('tab'))) return
    'syncId' in tab.dataset ? activateTabSync.call({ tab: tab }) : activateTab.call({ tab: tab })
  }
})()
</script>
</body>
</html>